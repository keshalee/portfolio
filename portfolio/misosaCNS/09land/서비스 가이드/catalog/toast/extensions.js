define("toast/extensions/defaults/Thumbnail",["require","exports","module"],function(a,b,c){"use strict";function d(){var a=[],b=0;_.each(Toast.project.models,function(c){var d,e=$.extend(!0,{},c.get("thumbnail"));d=e.url?Toast.StringUtils.replaceTemplate(e.url):e.src,e.url=d,e.width=e.width,e.height=e.height,e.displayPageNumber=Toast.Book.toLogicalPageNumber(b+1),a.push(e),b++});var c=Mustache.render(h,{thumbs:a});return i=$(c),$(".toast").append(i),j=i.find(".carousel").lightSlider({autoWidth:!0,pager:!1,slideMargin:5,slideMove:5,thumbMargin:50,onSliderLoad:function(){j.css("marginTop",(i.height()-j.height())/2+"px"),i.find(".xclose").on("click",e),i.animate({bottom:0},200),f()}}),Toast.Book.$getBook().turn("disabled",!0),i}function e(){i.animate({bottom:-i.height()+"px"},200,function(){j.destroy(),i.remove(),i=null,Toast.Book.$getBook().turn("disabled",!1)})}function f(){var a=-1,b=-1;j.children("li").on(k.start,function(b){var c=j.children(".item.active");a=c.index()}).on(k.end,function(c){b=$(c.currentTarget).index(),TT.lazy(function(){var c=j.children(".item.active"),d=c.index();a===d&&Toast.Book.move(b+1)},1)})}function g(a){_.isUndefined(h)&&(h=Toast.ThemeLoader.getHTMLTemplates().Thumbnail),i||d()}var h,i,j,k="ontouchstart"in window?{start:"touchstart",move:"touchmove",end:"touchend"}:{start:"mousedown",move:"mousemove",end:"mouseup"};Toast.CommandManager.registerInternal(Toast.Commands.THUMBNAIL,g)}),define("toast/extensions/defaults/TOC",["require","exports","module"],function(a,b,c){"use strict";function d(){return m=$(l),$(".toast").append(m),n=m.find(".container"),f().done(function(a){m.find("#sample-tree").remove(),n.append(a),n.jstree({core:{animation:0,themes:{icons:r.icons}},plugins:["wholerow","wholerowex","pageno"]})}).fail(function(a){m.find("#sample-tree").css("display",""),n.jstree({plugins:["wholerow","wholerowex","pageno"]})}),m.animate({left:0},250),n.css("height",$(window).height()-n.offset().top+"px"),$(window).on("resize",e),Toast.Book.enableAction(!1),m}function e(){n.css("height",$(window).height()-n.offset().top+"px")}function f(){function a(b,c){b.children("toc").each(function(b,d){var e=$(d),f=$("<li />");if(f.html(e.children("subject").text()),e.attr("pageNo")&&f.attr("data-page",e.attr("pageNo")),c.append(f),e.children("toc").length>0){var g=$("<ul />");f.append(g),a(e,g)}else f.attr("data-jstree",'{"icon": "jstree-file"}')})}function b(b){var c=$(b).find(":root");c.children().each(function(b,c){var f=$(c),g=$('<li data-jstree={"opened":true} />');if(g.html(f.children("subject").text()),f.attr("pageNo")&&g.attr("data-page",f.attr("pageNo")),d.append(g),f.children("toc").length>0){e!==!0&&(n.addClass("has-folder"),e=!0);var h=$("<ul />");g.append(h),a(f,h)}else g.attr("data-jstree",'{"icon": "jstree-file"}')})}var c=new $.Deferred,d=$("<ul />"),e=!1;return o?(b(o),c.resolve(d)):q!==!0?$.ajax({type:"GET",url:p,dataType:"xml",success:function(a){b(a),c.resolve(d)},error:function(a,b,d){c.reject("code: "+a.status+"\nmessage: "+a.responseText+"\nerror: "+d)}}):c.resolve(d),c.promise()}function g(){m.animate({left:-m.width()},250,function(){$(window).off("resize",e),m.remove(),m=null}),Toast.Book.enableAction(!0)}function h(a){if(!(Toast.isMobileDevice&&"A"!==a.target.tagName||$(a.target).hasClass("jstree-ocl"))){var b;b="LI"==a.target.tagName?$(a.target):$(a.target).parents("li");var c=b.attr("data-page");_.isUndefined(c)||(Toast.Book.move(Number(c),{isLogical:!0}),Toast.isMobileDevice&&!Toast.isLandscape()&&g())}}function i(){return p||(p=Toast.paths.data+"toclist.xml"),q=null===o&&Toast.project.config.toclist!==!0,!_.isNumber(TT.project.config.tocPageNumber)||Toast.isMobileDevice&&!q?(_.isUndefined(l)&&(l=Toast.ThemeLoader.getHTMLTemplates().TOC),void(m||(d().children(".panel-heading").find(".close").on("click",g),n.on("click.jstree",h)))):void Toast.Book.move(Number(TT.project.config.tocPageNumber),{isLogical:!0})}function j(a){a||(a={}),r=_.extend(r,a)}function k(a){o=a}var l,m,n,o,p,q,r=(Toast.Strings,{icons:!0}),s=document.createElement("DIV");s.className="jstree-pageno",s.innerHTML="&#160;",$.jstree.plugins.pageno=function(a,b){this.teardown=function(){this.element.find(".jstree-pageno").remove(),b.teardown.call(this)},this.redraw_node=function(a,c,d,e){if(a=b.redraw_node.apply(this,arguments)){var f=s.cloneNode(!0);if(!_.isEmpty($(a).attr("data-page"))){var g=Toast.Book.toLogicalPageNumber(Number($(a).attr("data-page")));$(f).text(g)}a.insertBefore(f,a.childNodes[0])}return a}};var t=document.createElement("DIV");t.className="jstree-wholerowex",$.jstree.plugins.wholerowex=function(a,b){this.teardown=function(){this.element.find(".jstree-wholerowex").remove(),b.teardown.call(this)},this.redraw_node=function(a,c,d,e){if(a=b.redraw_node.apply(this,arguments)){var f=$(t.cloneNode(!1)),g=$("<div />",{"class":"wholerowex-inner"});f.append(g);var h=$(a).children(".jstree-anchor");h.prepend(f)}return a}},Toast.CommandManager.registerInternal(Toast.Commands.TOC,i),b.configure=j,b.setXMLData=k,Toast.extensions.TOC=b}),define("toast/extensions/defaults/Bookmark",["exports"],function(a){"use strict";function b(){p=Toast.LocalStorage.getItem(q),_.isUndefined(p)||_.isEmpty(p)?p=[]:(p=JSON.parse(p),p=_.sortBy(p,"page"))}function c(a,b){var c=_.findWhere(p,{page:a});_.isUndefined(c)||(c.text=b,Toast.LocalStorage.setItem(q,JSON.stringify(p)))}function d(a){var b=_.findWhere(p,{page:a});return _.isUndefined(b)?"":b.text}function e(){}function f(){var a=Toast.Book.getCurrentPageNumber(),b=_.findWhere(p,{page:a[0]});return _.isUndefined(b)&&(1==a.length||(b=_.findWhere(p,{page:a[1]}),_.isUndefined(b)))?!1:!0}function g(){var a=Toast.Book.getCurrentPageNumber(),b=_.findWhere(p,{page:a[0]});return _.isUndefined(b)?!1:!0}function h(){var a=Toast.Book.getCurrentPageNumber();if(1!=a.length){var b=_.findWhere(p,{page:a[1]});if(!_.isUndefined(b))return!0}return!1}function i(a,b){var c={page:a,text:b};p.push(c),p=_.sortBy(p,"page"),Toast.LocalStorage.setItem(q,JSON.stringify(p)),TT.send(Toast.Events.BOOKMARK_DID_CHANGE,p)}function j(a){var b=_.findWhere(p,{page:a});_.isUndefined(b)||(p.splice(p.indexOf(b),1),Toast.LocalStorage.setItem(q,JSON.stringify(p)),TT.send(Toast.Events.BOOKMARK_DID_CHANGE,p))}function k(){p=[],Toast.LocalStorage.setItem(q,JSON.stringify(p)),TT.send(Toast.Events.BOOKMARK_DID_CHANGE,p)}function l(){return p}function m(a){var b=Toast.Book.getCurrentPageNumber(),e=1!=b.length?!0:!1;b=b[0];var k,l=$('<textarea class="form-control" placeholder="'+o.ENTER_TEXT+'"></textarea>');l.val(d(b));var m=[];f()&&m.push({cssClass:"btn-danger pull-left",icon:"glyphicon glyphicon-trash",label:o.DELETE,action:function(){j(b),Toast.send(Toast.Events.BOOKMARK_DID_CHANGE,p),k.close()}}),m.push({label:o.CANCEL,action:function(){k.close()}}),m.push({label:o.OK,cssClass:"btn-primary",action:function(){var a=_.findWhere(p,{page:b});_.isObject(a)?c(b,k.$modalBody.find("textarea").val()):(i(b,k.$modalBody.find("textarea").val()),Toast.send(Toast.Events.BOOKMARK_DID_CHANGE,p)),k.close()}});var n;n=e&&(g()||h())?o.MODIFY_BOOKMARK_TITILE:o.ADD_BOOKMARK_TITILE,k=BootstrapDialog.show({draggable:!0,title:n,message:function(a){if(e){var c=$('<form class="form-horizontal"><div class="form-group"><label class="col-sm-3 control-label">'+o.SELECT_PAGE_TITLE+'</label><div class="col-sm-8"><div class="input-group"><span class="input-group-addon"><input id="left-page" type="radio" checked>'+o.LEFT_PAGE_TITLE+'</input></span><span class="input-group-addon"><input id="right-page" type="radio">'+o.RIGHT_PAGE_TITLE+"</input></span></div></div></div></div><hr>");return c.append(l),c.find("input").click(function(a){"left-page"==$(this).attr("id")?(b=Toast.Book.getCurrentPageNumber()[0],c.find("#right-page").removeAttr("checked")):(b=Toast.Book.getCurrentPageNumber()[1],c.find("#left-page").removeAttr("checked")),c.find("textarea").val(d(b));var e=k.$modalFooter.find(".btn-danger"),f=_.findWhere(p,{page:b});_.isObject(f)?e.show():e.hide()}),c}return l},buttons:m,onshow:function(a){var c=a.$modalFooter.find(".btn-danger");if(!_.isUndefined(c[0])){var d=_.findWhere(p,{page:b});_.isObject(d)?c.show():c.hide()}}})}function n(a){f()?a.find('[command="toggleBookmark"]').children("a").html('<span class="glyphicon glyphicon-bookmark" />'+o.REMOVE_BOOKMARK_TITILE):a.find('[command="toggleBookmark"]').children("a").html('<span class="glyphicon glyphicon-bookmark" />'+o.ADD_BOOKMARK_TITILE)}var o=Toast.Strings,p=[],q=Toast.project.config.publishUniqueId+"-bookmarks";Toast.on(Toast.Events.BOOK_READY,function(a){b(),e(),TT.on(Toast.Events.BEFORE_SHOW_DROPDOWN_MENU,n)}),Toast.on(Toast.Events.PAGE_DID_CHANGE,function(a,b){e()}),Toast.CommandManager.registerInternal(Toast.Commands.TOGGLE_BOOKMARK,function(){m()}),a.addItem=i,a.removeItem=j,a.removeAll=k,a.getBookmarks=l,a.has=f,Toast.Bookmark=a}),define("toast/extensions/defaults/Search",["exports"],function(a){"use strict";function b(a,b){var c,d,e,f=a,g=b||"EM",h=new RegExp("^(?:"+g+"|SCRIPT|FORM)$"),i=["#ff6","#a0ffff","#9f9","#f99","#f6f"],j=[],k=0,l="";this.setRegex=function(a){l=new RegExp("("+a+")","i"),c=a},this.getRegex=function(){return l.toString().replace(/^\/\\b\(|\)\\b\/i$/g,"").replace(/\|/g," ")},this.hiliteWords=function(a){if(void 0!=a&&a&&l&&!h.test(a.nodeName)){if(a.hasChildNodes())for(var b=0;b<a.childNodes.length;b++)this.hiliteWords(a.childNodes[b]);if(3==a.nodeType&&(d=a.nodeValue)&&(e=l.exec(d))){j[e[0].toLowerCase()]||(j[e[0].toLowerCase()]=i[k++%i.length]);var c=document.createElement(g);c.appendChild(document.createTextNode(e[0])),c.style.backgroundColor=j[e[0].toLowerCase()],c.style.fontStyle="inherit",c.style.color="#000";var f=a.splitText(e.index);f.nodeValue=f.nodeValue.substring(e[0].length),a.parentNode&&a.parentNode.insertBefore(c,f)}}},this.remove=function(){for(var a,b=document.getElementsByTagName(g);b.length&&(a=b[0]);)a.parentNode.replaceChild(a.firstChild,a)},this.apply=function(a){if(void 0!=a&&a){this.remove();var b=a.split(" ");_.each(b,function(a){this.setRegex(a),_.isArray(f)?_.each(f,function(a){this.hiliteWords(a[0])},this):this.hiliteWords(f[0])},this)}}}function c(){var a,b;$("<ul />");this.apply=function(c){var d,e,f,g,h,i=[],j=0,k=c.toLowerCase().split(" ");_.each(A,function(a){_.any(k,function(b){if(d=new RegExp("("+b+")","i"),e=a.get("text"),f=d.exec(e)){g=Math.max(0,f.index-50),h=Math.min(e.length-g,100),e=e.substr(g,h)+" ...";var c=document.createTextNode(e),k=$("<span />");k.append(c);var l={};l.index=j;var m,n=Toast.project.models[a.get("index")].get("thumbnail");return m=n.url?Toast.StringUtils.replaceTemplate(n.url):n.src,l.thumbUrl=m,l.thumbWidth=n.width,l.thumbHeight=n.height,l.html=k.html(),l.displayPageNumber=Toast.Book.toLogicalPageNumber(a.get("index")+1),i.push(l),j++,!0}})});var l=Mustache.render(q,{searchResults:i});a=$(l),$(".toast").append(a),b=a.find(".container"),_.each(k,function(b){a.find(".panel-body > .container").tt_highlight(b)}),a.find(".panel-heading .btn.close").on("click",this.hide),a.find(".panel-body > .container > .row").on("click",this.click),b.css("height",$(window).height()-b.offset().top+"px"),$(window).on("resize",this.windowRsize)},this.click=function(a){var b=$(a.currentTarget);w=Number(b.attr("data-index"));var c=A[w].get("index");Toast.Book.move(c+1),h(c),l()},this.show=function(){a.animate({left:0},250)},this.hide=function(){a.animate({left:-a.width()},250)},this.remove=function(){$(window).off("resize",this.windowRsize),a.remove()},this.windowRsize=function(){b.css("height",$(window).height()-b.offset().top+"px")}}function d(){m(function(){if(D=r.find(".searchinput").val(),!_.isEmpty(D)){w=0,j(),v&&(v.remove(),v=null),A=[];var a=D.toLowerCase().split(" ");if(_.each(z.models,function(b){var c=b.get("text").toLowerCase();_.any(a,function(a){return _.contains(c,a)===!0?(A.push(b),!0):void 0})}),_.isEmpty(A)){var b=BootstrapDialog.show({type:BootstrapDialog.TYPE_INFO,title:x.ALERT_TITLE,message:x.ALERT_NO_SEARCH_RESULT,buttons:[{label:x.OK,cssClass:"btn-default",action:function(){b.close()}}]});r.removeClass("has-search-result")}else v=new c,v.apply(D),f(),h(),r.addClass("has-search-result");l()}})}function e(a){switch(a.keyCode){case Toast.KeyEvent.DOM_VK_RETURN:a.preventDefault(),d();break;case Toast.KeyEvent.DOM_VK_ESCAPE:k()}}function f(){v.show()}function g(){Toast.Book.enableAction(!1);var a=$(".toast");_.isUndefined(r)||_.isUndefined(r[0])||(r.remove(),r=null),q=Toast.ThemeLoader.getHTMLTemplates().Searchlist;var b=Toast.ThemeLoader.getHTMLTemplates().Searchbar;r=$(b),r.find(".searchinput").attr("placeholder",x.ENTER_SEARCH_WORDS_PLACEHOLDER),r.find(".btn-search").on("click",d),r.find(".searchinput").on("keydown",e),r.find(".btn.close").on("click",k),a.append(r),s=r.find(".btn-list"),t=r.find(".badge"),s.on("click",f),TT.lazy(function(){r.css("top",0),r.css("opacity",1)},0),Toast.send(Toast.Events.BEGIN_SEARCH_MODE),y=!0}function h(a){if(a||(a=o(Toast.Book.getCurrentPageNumber())),-1!=a)if(Toast.Book.isDoublePage()!==!0){var b=Toast.project.viewControllers[a];b.ready(function(){i()})}else{var b=Toast.project.viewControllers[a],c=Math.min(Toast.project.models.length-1,a+1);if(c!==a){var d=Toast.project.viewControllers[c];d.ready(function(){b.ready(function(){i()})})}else b.ready(function(){i()})}}function i(){var a=Toast.Book.getCurrentPage();if(a.length>0&&y)if(a.length>1){if(_.isUndefined(a[0].html())||_.isUndefined(a[1].html()))return void TT.lazy(i,10)}else if(_.isUndefined(a[0].html()))return void TT.lazy(i,10);u=new b(a),u.apply(D)}function j(){u&&(u.remove(),u=null),_.isUndefined(C)||_.isNull(C)||(clearInterval(C),C=null)}function k(){Toast.Book.enableAction(!0),j(),v&&(v.remove(),v=null),A=[],r.find(".searchinput").val(""),r.css("top",-(r.height()+5)+"px"),r.css("opacity",0),Toast.send(Toast.Events.END_SEARCH_MODE),y=!1}function l(){_.isEmpty(A)?(s.hide(),t.text("0")):(s.show(),t.text(A.length))}function m(a){if(B.promise().done(a),B._success_)return void B.resolve();var b=[],c=new $.Deferred,d=new $.Deferred;z.reset();var e=0;_.each(Toast.project.models,function(a){z.add({index:e,text:""}),e++});var f=new Backbone.Collection;b.push(c.promise()),_.each(Toast.project.models,function(a){f.add({text:""})});var g=new Backbone.Collection;g.fetch({url:Toast.paths.data+"searchwords.json",success:function(a,b){f.reset(a.models),c.resolve()},error:function(a,b){c.reject()}});var h=new Backbone.Collection;b.push(d.promise()),_.each(Toast.project.models,function(a){h.add({text:""})});var i=new Backbone.Collection;i.fetch({url:Toast.paths.data+"searchwords-extra.json",success:function(a,b){h.reset(a.models),d.resolve()},error:function(a,b){d.reject()}}),TT.Async.waitForAll(b).always(function(){n(f,h),B._success_=!0,B.resolve()})}function n(a,b){for(var c,d,e=Toast.project.models.length,f=0;e>f;f++)d="",c=z.at(f),_.isUndefined(a.at(f))||(d=a.at(f).get("text")),_.isUndefined(b.at(f))||_.isEmpty(b.at(f).get("text"))||(d+=" "+b.at(f).get("text")),c.set("text",d);c=z.at(0)}function o(a){var b=-1;return _.any(A,function(c){return c.get("index")===a[0]-1?(b=c.get("index"),!0):a.length>1&&c.get("index")===a[1]-1?(b=c.get("index"),!0):void 0}),b}function p(){Toast.CommandManager.execute(Toast.Commands.STOP_AUTO_SLIDE),y?k():g()}var q,r,s,t,u,v,w,x=Toast.Strings,y=!1,z=new Backbone.Collection,A=[],B=new $.Deferred,C=null,D="";Toast.on(Toast.Events.THEME_DID_LOAD,function(){y&&Toast.send(Toast.Events.END_SEARCH_MODE)}),Toast.on(Toast.Events.PAGE_DID_LOAD,function(a){y&&!_.isEmpty(A)&&_.each(A,function(b){b.get("index")===a-1&&h()})}),Toast.on(Toast.Events.PAGE_DID_CHANGE,function(a,b){y&&!_.isEmpty(A)&&_.any(A,function(b){return b.get("index")===a[0]-1?(h(),!0):a.length>1&&b.get("index")===a[1]-1?(h(),!0):void 0})}),Toast.appReady(function(){m()}),Toast.CommandManager.registerInternal(Toast.Commands.SEARCH,p)}),function(a,b){"function"==typeof define&&define.amd?define("toast/core",["exports","strings"],function(c,d){b(a,c,d,Backbone,_,$)}):b(a,{},{},a.Backbone,a._,a.jQuery||a.$)}(this,function(a,b,c,d,e,f){if(b.version="5.8.422",window.__app__=window.Toast=window.TOAST=window.TT=window.tt=window._tt=window._t=b,b.Strings=c,b.extensions={},b.metadata={},b.debug=e.isUndefined(window.debug)?!1:window.debug,"MacIntel"===window.navigator.platform||"MacPPC"===window.navigator.platform?b.platform="mac":window.navigator.platform.indexOf("Linux")>=0?b.platform="linux":b.platform="win",e.isUndefined(window.isMobileDevice)&&e.isUndefined(window.isMobile)?b.isMobile=b.isMobileDevice=window.navigator.userAgent.match(/mobile|ip(ad|hone|od)|android/i):b.isMobile=b.isMobileDevice=window.isMobileDevice,b.isMobileDevice&&(e.isUndefined(window.isTablet)?b.isTablet=window.navigator.userAgent.match(/tablet|ipad/i):b.isTablet=window.isTablet),b.isMobileDevice&&(b.isMobileDevice=!0),e.isUndefined(window.isAndroid)?b.isAndroid=window.navigator.userAgent.match(/android/i):b.isAndroid=window.isAndroid,b.isAndroid&&(b.isAndroid=!0),/msie|trident/i.test(navigator.userAgent)){var g=navigator.userAgent.toString().toLowerCase(),h=/(msie) ([\w.]+)/.exec(g)||/(trident)(?:.*rv:([\w.]+))?/.exec(g)||["",null,-1];b._msieVersion=h[2],e.isEmpty(b._msieVersion)||(b._msieVersion=Number(b._msieVersion))}b.UUID=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"==a?b:3&b|8;return c.toString(16)})},b.UUID16=function(){return"xxxxxxxx-xxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"==a?b:3&b|8;return c.toString(16)})},b.UUID8=function(){return"xxxx-xxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"==a?b:3&b|8;return c.toString(16)})},b.UUID6=function(){return"xxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"==a?b:3&b|8;return c.toString(16)})},b.UUID4=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)},b.dateUUID=function(){var a=new Date,c=a.getFullYear();return c=c.toString().substr(2,2),c+(a.getMonth()+1)+a.getDate()+a.getHours()+a.getMinutes()+"-"+b.UUID4()},e.extend(b,d.Events,{}),b.dispatch=b.send=b.trigger.bind(b);b.extend=function(a,b){var c,d=this;c=a&&e.has(a,"constructor")?a.constructor:function(){return d.apply(this,arguments)},e.extend(c,d,b);var f=function(){this.constructor=c};return f.prototype=d.prototype,c.prototype=new f,a&&e.extend(c.prototype,a),c.__super__=d.prototype,c};b.debug===!0&&window.console&&window.console.log?b._msieVersion&&b._msieVersion<10?b.log=Function.prototype.bind.call(console.log,console):b.log=void 0:b.log=function(){},ttlog=b.log}),define("toast/core/book/BookCommon",["require","exports","module"],function(a,b,c){"use strict";var d={has3d:null,vendor:"",PI:Math.PI,A90:Math.PI/2,isTouch:"ontouchstart"in window,events:"ontouchstart"in window?{start:"touchstart",move:"touchmove",end:"touchend"}:{start:"mousedown",move:"mousemove",end:"mouseup"},corners:{backward:["bl","tl"],forward:["br","tr"],all:["tl","bl","tr","br"]},displays:["single","double"],turnOptions:{page:1,cover:!0,gradients:!0,duration:600,acceleration:!0,display:"double",when:null},flipOptions:{folding:null,corners:"forward",cornerSize:100,gradients:!0,duration:600,acceleration:!0},pagesInDOM:6,pagePosition:{0:{top:0,left:0,right:"auto",bottom:"auto"},1:{top:0,right:0,left:"auto",bottom:"auto"}},divAtt:function(a,b,c,d){return{css:{position:"absolute",top:a,left:b,overflow:d||"hidden","z-index":c||"auto"}}},bezier:function(a,b,c,e,f){var g=1-f,h=g*g*g,i=f*f*f;return d.point2D(Math.round(h*a.x+3*f*g*g*b.x+3*f*f*g*c.x+i*e.x),Math.round(h*a.y+3*f*g*g*b.y+3*f*f*g*c.y+i*e.y))},rad:function(a){return a/180*d.PI},deg:function(a){return a/d.PI*180},point2D:function(a,b){return{x:a,y:b}},translate:function(a,b,c){return d.has3d&&c?" translate3d("+a+"px,"+b+"px, 0px) ":" translate("+a+"px, "+b+"px) "},rotate:function(a){return" rotate("+a+"deg) "},has:function(a,b){return Object.prototype.hasOwnProperty.call(b,a)},getPrefix:function(){var a=["Moz","Webkit","Khtml","O","ms"],b=a.length;for(d.vendor="";b--;)a[b]+"Transform"in document.body.style&&(d.vendor="-"+a[b].toLowerCase()+"-");return d.vendor},gradient:function(a,b,c,e,f){var g,h=[];if(a.addClass("gradient"),"-webkit-"==this.vendor){for(g=0;f>g;g++)h.push("color-stop("+e[g][0]+", "+e[g][1]+")");a.css({"background-image":"-webkit-gradient(linear, "+b.x+"% "+b.y+"%,  "+c.x+"% "+c.y+"%, "+h.join(",")+" )"})}else{b={x:b.x/100*a.width(),y:b.y/100*a.height()},c={x:c.x/100*a.width(),y:c.y/100*a.height()};var i=c.x-b.x,j=c.y-b.y,k=Math.atan2(j,i),l=k-Math.PI/2,m=Math.abs(a.width()*Math.sin(l))+Math.abs(a.height()*Math.cos(l)),n=Math.sqrt(j*j+i*i),o=d.point2D(c.x<b.x?a.width():0,c.y<b.y?a.height():0),p=Math.tan(k),q=-1/p,r=(q*o.x-o.y-p*b.x+b.y)/(q-p),s={x:r,y:q*r-q*o.x+o.y},t=Math.sqrt(Math.pow(s.x-b.x,2)+Math.pow(s.y-b.y,2));for(g=0;f>g;g++)h.push(" "+e[g][1]+" "+100*(t+n*e[g][0])/m+"%");a.css({"background-image":this.vendor+"linear-gradient("+-k+"rad,"+h.join(",")+")"})}},distanceBetween:function(a,b){var c=a.x-b.x,d=a.y-b.y;return Math.sqrt(c*c+d*d)}};return $.isTouch=d.isTouch,d}),function(a,b,c,d){"use strict";function e(a,b,c){return setTimeout(k(a,c),b)}function f(a,b,c){return Array.isArray(a)?(g(a,c[b],c),!0):!1}function g(a,b,c){var e;if(a)if(a.forEach)a.forEach(b,c);else if(a.length!==d)for(e=0;e<a.length;)b.call(c,a[e],e,a),e++;else for(e in a)a.hasOwnProperty(e)&&b.call(c,a[e],e,a)}function h(a,b,c){for(var e=Object.keys(b),f=0;f<e.length;)(!c||c&&a[e[f]]===d)&&(a[e[f]]=b[e[f]]),f++;return a}function i(a,b){return h(a,b,!0)}function j(a,b,c){var d,e=b.prototype;d=a.prototype=Object.create(e),d.constructor=a,d._super=e,c&&h(d,c)}function k(a,b){return function(){return a.apply(b,arguments)}}function l(a,b){return typeof a==ka?a.apply(b?b[0]||d:d,b):a}function m(a,b){return a===d?b:a}function n(a,b,c){g(r(b),function(b){a.addEventListener(b,c,!1)})}function o(a,b,c){g(r(b),function(b){a.removeEventListener(b,c,!1)})}function p(a,b){for(;a;){if(a==b)return!0;a=a.parentNode}return!1}function q(a,b){return a.indexOf(b)>-1}function r(a){return a.trim().split(/\s+/g)}function s(a,b,c){if(a.indexOf&&!c)return a.indexOf(b);for(var d=0;d<a.length;){if(c&&a[d][c]==b||!c&&a[d]===b)return d;d++}return-1}function t(a){return Array.prototype.slice.call(a,0)}function u(a,b,c){for(var d=[],e=[],f=0;f<a.length;){var g=b?a[f][b]:a[f];s(e,g)<0&&d.push(a[f]),e[f]=g,f++}return c&&(d=b?d.sort(function(a,c){return a[b]>c[b]}):d.sort()),d}function v(a,b){for(var c,e,f=b[0].toUpperCase()+b.slice(1),g=0;g<ia.length;){if(c=ia[g],e=c?c+f:b,e in a)return e;g++}return d}function w(){return oa++}function x(a){var b=a.ownerDocument;return b.defaultView||b.parentWindow}function y(a,b){var c=this;this.manager=a,this.callback=b,this.element=a.element,this.target=a.options.inputTarget,this.domHandler=function(b){l(a.options.enable,[a])&&c.handler(b)},this.init()}function z(a){var b,c=a.options.inputClass;return new(b=c?c:ra?N:sa?Q:qa?S:M)(a,A)}function A(a,b,c){var d=c.pointers.length,e=c.changedPointers.length,f=b&ya&&d-e===0,g=b&(Aa|Ba)&&d-e===0;c.isFirst=!!f,c.isFinal=!!g,f&&(a.session={}),c.eventType=b,B(a,c),a.emit("hammer.input",c),a.recognize(c),a.session.prevInput=c}function B(a,b){var c=a.session,d=b.pointers,e=d.length;c.firstInput||(c.firstInput=E(b)),e>1&&!c.firstMultiple?c.firstMultiple=E(b):1===e&&(c.firstMultiple=!1);var f=c.firstInput,g=c.firstMultiple,h=g?g.center:f.center,i=b.center=F(d);b.timeStamp=na(),b.deltaTime=b.timeStamp-f.timeStamp,b.angle=J(h,i),b.distance=I(h,i),C(c,b),b.offsetDirection=H(b.deltaX,b.deltaY),b.scale=g?L(g.pointers,d):1,b.rotation=g?K(g.pointers,d):0,D(c,b);var j=a.element;p(b.srcEvent.target,j)&&(j=b.srcEvent.target),b.target=j}function C(a,b){var c=b.center,d=a.offsetDelta||{},e=a.prevDelta||{},f=a.prevInput||{};(b.eventType===ya||f.eventType===Aa)&&(e=a.prevDelta={x:f.deltaX||0,y:f.deltaY||0},d=a.offsetDelta={x:c.x,y:c.y}),b.deltaX=e.x+(c.x-d.x),b.deltaY=e.y+(c.y-d.y)}function D(a,b){var c,e,f,g,h=a.lastInterval||b,i=b.timeStamp-h.timeStamp;if(b.eventType!=Ba&&(i>xa||h.velocity===d)){var j=h.deltaX-b.deltaX,k=h.deltaY-b.deltaY,l=G(i,j,k);e=l.x,f=l.y,c=ma(l.x)>ma(l.y)?l.x:l.y,g=H(j,k),a.lastInterval=b}else c=h.velocity,e=h.velocityX,f=h.velocityY,g=h.direction;b.velocity=c,b.velocityX=e,b.velocityY=f,b.direction=g}function E(a){for(var b=[],c=0;c<a.pointers.length;)b[c]={clientX:la(a.pointers[c].clientX),clientY:la(a.pointers[c].clientY)},c++;return{timeStamp:na(),pointers:b,center:F(b),deltaX:a.deltaX,deltaY:a.deltaY}}function F(a){var b=a.length;if(1===b)return{x:la(a[0].clientX),y:la(a[0].clientY)};for(var c=0,d=0,e=0;b>e;)c+=a[e].clientX,d+=a[e].clientY,e++;return{x:la(c/b),y:la(d/b)}}function G(a,b,c){return{x:b/a||0,y:c/a||0}}function H(a,b){return a===b?Ca:ma(a)>=ma(b)?a>0?Da:Ea:b>0?Fa:Ga}function I(a,b,c){c||(c=Ka);var d=b[c[0]]-a[c[0]],e=b[c[1]]-a[c[1]];return Math.sqrt(d*d+e*e)}function J(a,b,c){c||(c=Ka);var d=b[c[0]]-a[c[0]],e=b[c[1]]-a[c[1]];return 180*Math.atan2(e,d)/Math.PI}function K(a,b){return J(b[1],b[0],La)-J(a[1],a[0],La)}function L(a,b){return I(b[0],b[1],La)/I(a[0],a[1],La)}function M(){this.evEl=Na,this.evWin=Oa,this.allow=!0,this.pressed=!1,y.apply(this,arguments)}function N(){this.evEl=Ra,this.evWin=Sa,y.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function O(){this.evTarget=Ua,this.evWin=Va,this.started=!1,y.apply(this,arguments)}function P(a,b){var c=t(a.touches),d=t(a.changedTouches);return b&(Aa|Ba)&&(c=u(c.concat(d),"identifier",!0)),[c,d]}function Q(){this.evTarget=Xa,this.targetIds={},y.apply(this,arguments)}function R(a,b){var c=t(a.touches),d=this.targetIds;if(b&(ya|za)&&1===c.length)return d[c[0].identifier]=!0,[c,c];var e,f,g=t(a.changedTouches),h=[],i=this.target;if(f=c.filter(function(a){return p(a.target,i)}),b===ya)for(e=0;e<f.length;)d[f[e].identifier]=!0,e++;for(e=0;e<g.length;)d[g[e].identifier]&&h.push(g[e]),b&(Aa|Ba)&&delete d[g[e].identifier],e++;return h.length?[u(f.concat(h),"identifier",!0),h]:void 0}function S(){y.apply(this,arguments);var a=k(this.handler,this);this.touch=new Q(this.manager,a),this.mouse=new M(this.manager,a)}function T(a,b){this.manager=a,this.set(b)}function U(a){if(q(a,bb))return bb;var b=q(a,cb),c=q(a,db);return b&&c?cb+" "+db:b||c?b?cb:db:q(a,ab)?ab:_a}function V(a){this.id=w(),this.manager=null,this.options=i(a||{},this.defaults),this.options.enable=m(this.options.enable,!0),this.state=eb,this.simultaneous={},this.requireFail=[]}function W(a){return a&jb?"cancel":a&hb?"end":a&gb?"move":a&fb?"start":""}function X(a){return a==Ga?"down":a==Fa?"up":a==Da?"left":a==Ea?"right":""}function Y(a,b){var c=b.manager;return c?c.get(a):a}function Z(){V.apply(this,arguments)}function $(){Z.apply(this,arguments),this.pX=null,this.pY=null}function _(){Z.apply(this,arguments)}function aa(){V.apply(this,arguments),this._timer=null,this._input=null}function ba(){Z.apply(this,arguments)}function ca(){Z.apply(this,arguments)}function da(){V.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function ea(a,b){return b=b||{},b.recognizers=m(b.recognizers,ea.defaults.preset),new fa(a,b)}function fa(a,b){b=b||{},this.options=i(b,ea.defaults),this.options.inputTarget=this.options.inputTarget||a,this.handlers={},this.session={},this.recognizers=[],this.element=a,this.input=z(this),this.touchAction=new T(this,this.options.touchAction),ga(this,!0),g(b.recognizers,function(a){var b=this.add(new a[0](a[1]));a[2]&&b.recognizeWith(a[2]),a[3]&&b.requireFailure(a[3])},this)}function ga(a,b){var c=a.element;g(a.options.cssProps,function(a,d){c.style[v(c.style,d)]=b?a:""})}function ha(a,c){var d=b.createEvent("Event");d.initEvent(a,!0,!0),d.gesture=c,c.target.dispatchEvent(d)}var ia=["","webkit","moz","MS","ms","o"],ja=b.createElement("div"),ka="function",la=Math.round,ma=Math.abs,na=Date.now,oa=1,pa=/mobile|tablet|ip(ad|hone|od)|android/i,qa="ontouchstart"in a,ra=v(a,"PointerEvent")!==d,sa=qa&&pa.test(navigator.userAgent),ta="touch",ua="pen",va="mouse",wa="kinect",xa=25,ya=1,za=2,Aa=4,Ba=8,Ca=1,Da=2,Ea=4,Fa=8,Ga=16,Ha=Da|Ea,Ia=Fa|Ga,Ja=Ha|Ia,Ka=["x","y"],La=["clientX","clientY"];y.prototype={handler:function(){},init:function(){this.evEl&&n(this.element,this.evEl,this.domHandler),this.evTarget&&n(this.target,this.evTarget,this.domHandler),this.evWin&&n(x(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&o(this.element,this.evEl,this.domHandler),this.evTarget&&o(this.target,this.evTarget,this.domHandler),this.evWin&&o(x(this.element),this.evWin,this.domHandler)}};var Ma={mousedown:ya,mousemove:za,mouseup:Aa},Na="mousedown",Oa="mousemove mouseup";j(M,y,{handler:function(a){var b=Ma[a.type];b&ya&&0===a.button&&(this.pressed=!0),b&za&&1!==a.which&&(b=Aa),this.pressed&&this.allow&&(b&Aa&&(this.pressed=!1),this.callback(this.manager,b,{pointers:[a],changedPointers:[a],pointerType:va,srcEvent:a}))}});var Pa={pointerdown:ya,pointermove:za,pointerup:Aa,pointercancel:Ba,pointerout:Ba},Qa={2:ta,3:ua,4:va,5:wa},Ra="pointerdown",Sa="pointermove pointerup pointercancel";a.MSPointerEvent&&(Ra="MSPointerDown",Sa="MSPointerMove MSPointerUp MSPointerCancel"),j(N,y,{handler:function(a){var b=this.store,c=!1,d=a.type.toLowerCase().replace("ms",""),e=Pa[d],f=Qa[a.pointerType]||a.pointerType,g=f==ta,h=s(b,a.pointerId,"pointerId");e&ya&&(0===a.button||g)?0>h&&(b.push(a),h=b.length-1):e&(Aa|Ba)&&(c=!0),0>h||(b[h]=a,this.callback(this.manager,e,{pointers:b,changedPointers:[a],pointerType:f,srcEvent:a}),c&&b.splice(h,1))}});var Ta={touchstart:ya,touchmove:za,touchend:Aa,touchcancel:Ba},Ua="touchstart",Va="touchstart touchmove touchend touchcancel";j(O,y,{handler:function(a){var b=Ta[a.type];if(b===ya&&(this.started=!0),this.started){var c=P.call(this,a,b);b&(Aa|Ba)&&c[0].length-c[1].length===0&&(this.started=!1),this.callback(this.manager,b,{pointers:c[0],changedPointers:c[1],pointerType:ta,srcEvent:a})}}});var Wa={touchstart:ya,touchmove:za,touchend:Aa,touchcancel:Ba},Xa="touchstart touchmove touchend touchcancel";j(Q,y,{handler:function(a){var b=Wa[a.type],c=R.call(this,a,b);c&&this.callback(this.manager,b,{pointers:c[0],changedPointers:c[1],pointerType:ta,srcEvent:a})}}),j(S,y,{handler:function(a,b,c){var d=c.pointerType==ta,e=c.pointerType==va;if(d)this.mouse.allow=!1;else if(e&&!this.mouse.allow)return;b&(Aa|Ba)&&(this.mouse.allow=!0),this.callback(a,b,c)},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var Ya=v(ja.style,"touchAction"),Za=Ya!==d,$a="compute",_a="auto",ab="manipulation",bb="none",cb="pan-x",db="pan-y";T.prototype={set:function(a){a==$a&&(a=this.compute()),Za&&(this.manager.element.style[Ya]=a),this.actions=a.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var a=[];return g(this.manager.recognizers,function(b){l(b.options.enable,[b])&&(a=a.concat(b.getTouchAction()))}),U(a.join(" "))},preventDefaults:function(a){return},preventSrc:function(a){this.manager.session.prevented=!0,a.preventDefault()}};var eb=1,fb=2,gb=4,hb=8,ib=hb,jb=16,kb=32;V.prototype={defaults:{},set:function(a){return h(this.options,a),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(a){if(f(a,"recognizeWith",this))return this;var b=this.simultaneous;return a=Y(a,this),b[a.id]||(b[a.id]=a,a.recognizeWith(this)),this},dropRecognizeWith:function(a){return f(a,"dropRecognizeWith",this)?this:(a=Y(a,this),delete this.simultaneous[a.id],this)},requireFailure:function(a){if(f(a,"requireFailure",this))return this;var b=this.requireFail;return a=Y(a,this),-1===s(b,a)&&(b.push(a),a.requireFailure(this)),this},dropRequireFailure:function(a){if(f(a,"dropRequireFailure",this))return this;a=Y(a,this);var b=s(this.requireFail,a);return b>-1&&this.requireFail.splice(b,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(a){return!!this.simultaneous[a.id]},emit:function(a){function b(b){c.manager.emit(c.options.event+(b?W(d):""),a)}var c=this,d=this.state;hb>d&&b(!0),b(),d>=hb&&b(!0)},tryEmit:function(a){
return this.canEmit()?this.emit(a):void(this.state=kb)},canEmit:function(){for(var a=0;a<this.requireFail.length;){if(!(this.requireFail[a].state&(kb|eb)))return!1;a++}return!0},recognize:function(a){var b=h({},a);return l(this.options.enable,[this,b])?(this.state&(ib|jb|kb)&&(this.state=eb),this.state=this.process(b),void(this.state&(fb|gb|hb|jb)&&this.tryEmit(b))):(this.reset(),void(this.state=kb))},process:function(a){},getTouchAction:function(){},reset:function(){}},j(Z,V,{defaults:{pointers:1},attrTest:function(a){var b=this.options.pointers;return 0===b||a.pointers.length===b},process:function(a){var b=this.state,c=a.eventType,d=b&(fb|gb),e=this.attrTest(a);return d&&(c&Ba||!e)?b|jb:d||e?c&Aa?b|hb:b&fb?b|gb:fb:kb}}),j($,Z,{defaults:{event:"pan",threshold:10,pointers:1,direction:Ja},getTouchAction:function(){var a=this.options.direction,b=[];return a&Ha&&b.push(db),a&Ia&&b.push(cb),b},directionTest:function(a){var b=this.options,c=!0,d=a.distance,e=a.direction,f=a.deltaX,g=a.deltaY;return e&b.direction||(b.direction&Ha?(e=0===f?Ca:0>f?Da:Ea,c=f!=this.pX,d=Math.abs(a.deltaX)):(e=0===g?Ca:0>g?Fa:Ga,c=g!=this.pY,d=Math.abs(a.deltaY))),a.direction=e,c&&d>b.threshold&&e&b.direction},attrTest:function(a){return Z.prototype.attrTest.call(this,a)&&(this.state&fb||!(this.state&fb)&&this.directionTest(a))},emit:function(a){this.pX=a.deltaX,this.pY=a.deltaY;var b=X(a.direction);b&&this.manager.emit(this.options.event+b,a),this._super.emit.call(this,a)}}),j(_,Z,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[bb]},attrTest:function(a){return this._super.attrTest.call(this,a)&&(Math.abs(a.scale-1)>this.options.threshold||this.state&fb)},emit:function(a){if(this._super.emit.call(this,a),1!==a.scale){var b=a.scale<1?"in":"out";this.manager.emit(this.options.event+b,a)}}}),j(aa,V,{defaults:{event:"press",pointers:1,time:500,threshold:5},getTouchAction:function(){return[_a]},process:function(a){var b=this.options,c=a.pointers.length===b.pointers,d=a.distance<b.threshold,f=a.deltaTime>b.time;if(this._input=a,!d||!c||a.eventType&(Aa|Ba)&&!f)this.reset();else if(a.eventType&ya)this.reset(),this._timer=e(function(){this.state=ib,this.tryEmit()},b.time,this);else if(a.eventType&Aa)return ib;return kb},reset:function(){clearTimeout(this._timer)},emit:function(a){this.state===ib&&(a&&a.eventType&Aa?this.manager.emit(this.options.event+"up",a):(this._input.timeStamp=na(),this.manager.emit(this.options.event,this._input)))}}),j(ba,Z,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[bb]},attrTest:function(a){return this._super.attrTest.call(this,a)&&(Math.abs(a.rotation)>this.options.threshold||this.state&fb)}}),j(ca,Z,{defaults:{event:"swipe",threshold:10,velocity:.65,direction:Ha|Ia,pointers:1},getTouchAction:function(){return $.prototype.getTouchAction.call(this)},attrTest:function(a){var b,c=this.options.direction;return c&(Ha|Ia)?b=a.velocity:c&Ha?b=a.velocityX:c&Ia&&(b=a.velocityY),this._super.attrTest.call(this,a)&&c&a.direction&&a.distance>this.options.threshold&&ma(b)>this.options.velocity&&a.eventType&Aa},emit:function(a){var b=X(a.direction);b&&this.manager.emit(this.options.event+b,a),this.manager.emit(this.options.event,a)}}),j(da,V,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:2,posThreshold:10},getTouchAction:function(){return[ab]},process:function(a){var b=this.options,c=a.pointers.length===b.pointers,d=a.distance<b.threshold,f=a.deltaTime<b.time;if(this.reset(),a.eventType&ya&&0===this.count)return this.failTimeout();if(d&&f&&c){if(a.eventType!=Aa)return this.failTimeout();var g=this.pTime?a.timeStamp-this.pTime<b.interval:!0,h=!this.pCenter||I(this.pCenter,a.center)<b.posThreshold;this.pTime=a.timeStamp,this.pCenter=a.center,h&&g?this.count+=1:this.count=1,this._input=a;var i=this.count%b.taps;if(0===i)return this.hasRequireFailures()?(this._timer=e(function(){this.state=ib,this.tryEmit()},b.interval,this),fb):ib}return kb},failTimeout:function(){return this._timer=e(function(){this.state=kb},this.options.interval,this),kb},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==ib&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),ea.VERSION="2.0.4",ea.defaults={domEvents:!1,touchAction:$a,enable:!0,inputTarget:null,inputClass:null,preset:[[ba,{enable:!1}],[_,{enable:!1},["rotate"]],[ca,{direction:Ha}],[$,{direction:Ha},["swipe"]],[da],[da,{event:"doubletap",taps:2},["tap"]],[aa]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var lb=1,mb=2;fa.prototype={set:function(a){return h(this.options,a),a.touchAction&&this.touchAction.update(),a.inputTarget&&(this.input.destroy(),this.input.target=a.inputTarget,this.input.init()),this},stop:function(a){this.session.stopped=a?mb:lb},recognize:function(a){var b=this.session;if(!b.stopped){this.touchAction.preventDefaults(a);var c,d=this.recognizers,e=b.curRecognizer;(!e||e&&e.state&ib)&&(e=b.curRecognizer=null);for(var f=0;f<d.length;)c=d[f],b.stopped===mb||e&&c!=e&&!c.canRecognizeWith(e)?c.reset():c.recognize(a),!e&&c.state&(fb|gb|hb)&&(e=b.curRecognizer=c),f++}},get:function(a){if(a instanceof V)return a;for(var b=this.recognizers,c=0;c<b.length;c++)if(b[c].options.event==a)return b[c];return null},add:function(a){if(f(a,"add",this))return this;var b=this.get(a.options.event);return b&&this.remove(b),this.recognizers.push(a),a.manager=this,this.touchAction.update(),a},remove:function(a){if(f(a,"remove",this))return this;var b=this.recognizers;return a=this.get(a),b.splice(s(b,a),1),this.touchAction.update(),this},on:function(a,b){var c=this.handlers;return g(r(a),function(a){c[a]=c[a]||[],c[a].push(b)}),this},off:function(a,b){var c=this.handlers;return g(r(a),function(a){b?c[a].splice(s(c[a],b),1):delete c[a]}),this},emit:function(a,b){this.options.domEvents&&ha(a,b);var c=this.handlers[a]&&this.handlers[a].slice();if(c&&c.length){b.type=a,b.preventDefault=function(){b.srcEvent.preventDefault()};for(var d=0;d<c.length;)c[d](b),d++}},destroy:function(){this.element&&ga(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},h(ea,{INPUT_START:ya,INPUT_MOVE:za,INPUT_END:Aa,INPUT_CANCEL:Ba,STATE_POSSIBLE:eb,STATE_BEGAN:fb,STATE_CHANGED:gb,STATE_ENDED:hb,STATE_RECOGNIZED:ib,STATE_CANCELLED:jb,STATE_FAILED:kb,DIRECTION_NONE:Ca,DIRECTION_LEFT:Da,DIRECTION_RIGHT:Ea,DIRECTION_UP:Fa,DIRECTION_DOWN:Ga,DIRECTION_HORIZONTAL:Ha,DIRECTION_VERTICAL:Ia,DIRECTION_ALL:Ja,Manager:fa,Input:y,TouchAction:T,TouchInput:Q,MouseInput:M,PointerEventInput:N,TouchMouseInput:S,SingleTouchInput:O,Recognizer:V,AttrRecognizer:Z,Tap:da,Pan:$,Swipe:ca,Pinch:_,Rotate:ba,Press:aa,on:n,off:o,each:g,merge:i,extend:h,inherit:j,bindFn:k,prefixed:v}),typeof define==ka&&define.amd?define("toast/libs/hammer",[],function(){return ea}):"undefined"!=typeof module&&module.exports?module.exports=ea:a[c]=ea}(window,document,"Hammer"),function(a,b){"object"==typeof exports?module.exports=b():"function"==typeof define&&define.amd?define("toast/libs/Spinner",b):a.Spinner=b()}(this,function(){"use strict";function a(a,b){var c,d=document.createElement(a||"div");for(c in b)d[c]=b[c];return d}function b(a){for(var b=1,c=arguments.length;c>b;b++)a.appendChild(arguments[b]);return a}function c(a,b,c,d){var e=["opacity",b,~~(100*a),c,d].join("-"),f=.01+c/d*100,g=Math.max(1-(1-a)/b*(100-f),a),h=j.substring(0,j.indexOf("Animation")).toLowerCase(),i=h&&"-"+h+"-"||"";return l[e]||(m.insertRule("@"+i+"keyframes "+e+"{0%{opacity:"+g+"}"+f+"%{opacity:"+a+"}"+(f+.01)+"%{opacity:1}"+(f+b)%100+"%{opacity:"+a+"}100%{opacity:"+g+"}}",m.cssRules.length),l[e]=1),e}function d(a,b){var c,d,e=a.style;for(b=b.charAt(0).toUpperCase()+b.slice(1),d=0;d<k.length;d++)if(c=k[d]+b,void 0!==e[c])return c;return void 0!==e[b]?b:void 0}function e(a,b){for(var c in b)a.style[d(a,c)||c]=b[c];return a}function f(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)void 0===a[d]&&(a[d]=c[d])}return a}function g(a,b){return"string"==typeof a?a:a[b%a.length]}function h(a){this.opts=f(a||{},h.defaults,n)}function i(){function c(b,c){return a("<"+b+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',c)}m.addRule(".spin-vml","behavior:url(#default#VML)"),h.prototype.lines=function(a,d){function f(){return e(c("group",{coordsize:k+" "+k,coordorigin:-j+" "+-j}),{width:k,height:k})}function h(a,h,i){b(m,b(e(f(),{rotation:360/d.lines*a+"deg",left:~~h}),b(e(c("roundrect",{arcsize:d.corners}),{width:j,height:d.width,left:d.radius,top:-d.width>>1,filter:i}),c("fill",{color:g(d.color,a),opacity:d.opacity}),c("stroke",{opacity:0}))))}var i,j=d.length+d.width,k=2*j,l=2*-(d.width+d.length)+"px",m=e(f(),{position:"absolute",top:l,left:l});if(d.shadow)for(i=1;i<=d.lines;i++)h(i,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(i=1;i<=d.lines;i++)h(i);return b(a,m)},h.prototype.opacity=function(a,b,c,d){var e=a.firstChild;d=d.shadow&&d.lines||0,e&&b+d<e.childNodes.length&&(e=e.childNodes[b+d],e=e&&e.firstChild,e=e&&e.firstChild,e&&(e.opacity=c))}}var j,k=["webkit","Moz","ms","O"],l={},m=function(){var c=a("style",{type:"text/css"});return b(document.getElementsByTagName("head")[0],c),c.sheet||c.styleSheet}(),n={lines:12,length:7,width:5,radius:10,rotate:0,corners:1,color:"#000",direction:1,speed:1,trail:100,opacity:.25,fps:20,zIndex:2e9,className:"spinner",top:"50%",left:"50%",position:"absolute"};h.defaults={},f(h.prototype,{spin:function(b){this.stop();var c=this,d=c.opts,f=c.el=e(a(0,{className:d.className}),{position:d.position,width:0,zIndex:d.zIndex});d.radius+d.length+d.width;if(e(f,{left:d.left,top:d.top}),b&&b.insertBefore(f,b.firstChild||null),f.setAttribute("role","progressbar"),c.lines(f,c.opts),!j){var g,h=0,i=(d.lines-1)*(1-d.direction)/2,k=d.fps,l=k/d.speed,m=(1-d.opacity)/(l*d.trail/100),n=l/d.lines;!function o(){h++;for(var a=0;a<d.lines;a++)g=Math.max(1-(h+(d.lines-a)*n)%l*m,d.opacity),c.opacity(f,a*d.direction+i,g,d);c.timeout=c.el&&setTimeout(o,~~(1e3/k))}()}return c},stop:function(){var a=this.el;return a&&(clearTimeout(this.timeout),a.parentNode&&a.parentNode.removeChild(a),this.el=void 0),this},lines:function(d,f){function h(b,c){return e(a(),{position:"absolute",width:f.length+f.width+"px",height:f.width+"px",background:b,boxShadow:c,transformOrigin:"left",transform:"rotate("+~~(360/f.lines*k+f.rotate)+"deg) translate("+f.radius+"px,0)",borderRadius:(f.corners*f.width>>1)+"px"})}for(var i,k=0,l=(f.lines-1)*(1-f.direction)/2;k<f.lines;k++)i=e(a(),{position:"absolute",top:1+~(f.width/2)+"px",transform:f.hwaccel?"translate3d(0,0,0)":"",opacity:f.opacity,animation:j&&c(f.opacity,f.trail,l+k*f.direction,f.lines)+" "+1/f.speed+"s linear infinite"}),f.shadow&&b(i,e(h("#000","0 0 4px #000"),{top:"2px"})),b(d,b(i,h(g(f.color,k),"0 0 1px rgba(0,0,0,.1)")));return d},opacity:function(a,b,c){b<a.childNodes.length&&(a.childNodes[b].style.opacity=c)}});var o=e(a("group"),{behavior:"url(#default#VML)"});return!d(o,"transform")&&o.adj?i():j=d(o,"animation"),h}),function(a,b){"object"==typeof module&&"object"==typeof module.exports?module.exports=a.document?b(a,!0):function(a){if(!a.document)throw new Error("Viewer requires a window with a document");return b(a)}:b(a)}("undefined"!=typeof window?window:this,function(a,b){"use strict";function c(a){return Oa.call(a).slice(8,-1).toLowerCase()}function d(a){return"string"==typeof a}function e(a){return"number"==typeof a&&!isNaN(a)}function f(a){return"undefined"==typeof a}function g(a){return"object"==typeof a&&null!==a}function h(a){var b,c;if(!g(a))return!1;try{return b=a.constructor,c=b.prototype,b&&c&&Pa.call(c,"isPrototypeOf")}catch(d){return!1}}function i(a){return"function"===c(a)}function j(a){return Array.isArray?Array.isArray(a):"array"===c(a)}function k(a,b){return b=b>=0?b:0,Array.from?Array.from(a).slice(b):Qa.call(a,b)}function l(a,b){var c=-1;return b.indexOf?b.indexOf(a):(n(b,function(b,d){return b===a?(c=d,!1):void 0}),c)}function m(a){return d(a)&&(a=a.trim?a.trim():a.replace(Fa,"1")),a}function n(a,b){var c,d;if(a&&i(b))if(j(a)||e(a.length))for(d=0,c=a.length;c>d&&b.call(a,a[d],d,a)!==!1;d++);else if(g(a))for(d in a)if(a.hasOwnProperty(d)&&b.call(a,a[d],d,a)===!1)break;return a}function o(a){var b;if(arguments.length>1){if(b=k(arguments),Object.assign)return Object.assign.apply(Object,b);b.shift(),n(b,function(b){n(b,function(b,c){a[c]=b})})}return a}function p(a,b){var c=k(arguments,2);return function(){return a.apply(b,c.concat(k(arguments)))}}function q(a,b){var c=a.style;n(b,function(a,b){Da.test(b)&&e(a)&&(a+="px"),c[b]=a})}function r(b){return a.getComputedStyle?a.getComputedStyle(b,null):b.currentStyle}function s(a,b){return a.classList?a.classList.contains(b):a.className.indexOf(b)>-1}function t(a,b){var c;if(b){if(e(a.length))return n(a,function(a){t(a,b)});if(a.classList)return a.classList.add(b);c=m(a.className),c?c.indexOf(b)<0&&(a.className=c+" "+b):a.className=b}}function u(a,b){return b?e(a.length)?n(a,function(a){u(a,b)}):a.classList?a.classList.remove(b):void(a.className.indexOf(b)>=0&&(a.className=a.className.replace(b,""))):void 0}function v(a,b,c){return e(a.length)?n(a,function(a){v(a,b,c)}):void(c?t(a,b):u(a,b))}function w(a){return a.replace(Ea,"$1-$2").toLowerCase()}function x(a,b){return g(a[b])?a[b]:a.dataset?a.dataset[b]:a.getAttribute("data-"+w(b))}function y(a,b,c){g(c)?a[b]=c:a.dataset?a.dataset[b]=c:a.setAttribute("data-"+w(b),c)}function z(a,b){g(a[b])?delete a[b]:a.dataset?delete a.dataset[b]:a.removeAttribute("data-"+w(b))}function A(a,b,c,d){var e=m(b).split(Ga),f=c;return e.length>1?n(e,function(b){A(a,b,c)}):(d&&(c=function(){return B(a,b,c),f.apply(a,arguments)}),void(a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent&&a.attachEvent("on"+b,c)))}function B(a,b,c){var d=m(b).split(Ga);return d.length>1?n(d,function(b){B(a,b,c)}):void(a.removeEventListener?a.removeEventListener(b,c,!1):a.detachEvent&&a.detachEvent("on"+b,c))}function C(a,b,c){var d;return a.dispatchEvent?(i(U)&&i(CustomEvent)?d=f(c)?new U(b,{bubbles:!0,cancelable:!0}):new CustomEvent(b,{detail:c,bubbles:!0,cancelable:!0}):f(c)?(d=T.createEvent("Event"),d.initEvent(b,!0,!0)):(d=T.createEvent("CustomEvent"),d.initCustomEvent(b,!0,!0,c)),a.dispatchEvent(d)):a.fireEvent?a.fireEvent("on"+b):void 0}function D(a){a.preventDefault?a.preventDefault():a.returnValue=!1}function E(b){var c,d=b||a.event;return d.target||(d.target=d.srcElement||T),e(d.pageX)||(c=T.documentElement,d.pageX=d.clientX+(a.scrollX||c&&c.scrollLeft||0)-(c&&c.clientLeft||0),d.pageY=d.clientY+(a.scrollY||c&&c.scrollTop||0)-(c&&c.clientTop||0)),d}function F(b){var c=T.documentElement,d=b.getBoundingClientRect();return{left:d.left+(a.scrollX||c&&c.scrollLeft||0)-(c&&c.clientLeft||0),top:d.top+(a.scrollY||c&&c.scrollTop||0)-(c&&c.clientTop||0)}}function G(a){var b=a.length,c=0,d=0;return b&&(n(a,function(a){c+=a.pageX,d+=a.pageY}),c/=b,d/=b),{pageX:c,pageY:d}}function H(a,b){return a.getElementsByTagName(b)}function I(a,b){return a.getElementsByClassName?a.getElementsByClassName(b):a.querySelectorAll("."+b)}function J(a,b){return b.length?n(b,function(b){J(a,b)}):void a.appendChild(b)}function K(a){a.parentNode&&a.parentNode.removeChild(a)}function L(a){for(;a.firstChild;)a.removeChild(a.firstChild)}function M(a,b){f(a.textContent)?a.innerText=b:a.textContent=b}function N(a){return a.offsetWidth}function O(a){return d(a)?a.replace(/^.*\//,"").replace(/[\?&#].*$/,""):""}function P(a,b){var c;return a.naturalWidth?b(a.naturalWidth,a.naturalHeight):(c=T.createElement("img"),c.onload=function(){b(this.width,this.height)},void(c.src=a.src))}function Q(a){var b=[],c=a.rotate,d=a.scaleX,f=a.scaleY;return e(c)&&b.push("rotate("+c+"deg)"),e(d)&&b.push("scaleX("+d+")"),e(f)&&b.push("scaleY("+f+")"),b.length?b.join(" "):"none"}function R(a){switch(a){case 2:return aa;case 3:return ba;case 4:return ca}}function S(a,b){var c=this;c.element=a,c.options=o({},S.DEFAULTS,h(b)&&b),c.isImg=!1,c.isBuilt=!1,c.isShown=!1,c.isViewed=!1,c.isFulled=!1,c.isPlayed=!1,c.wheeling=!1,c.playing=!1,c.fading=!1,c.tooltiping=!1,c.transitioning=!1,c.action=!1,c.target=!1,c.timeout=!1,c.index=0,c.length=0,c.init()}var T=a.document,U=a.Event,V="viewer",W=V+"-fixed",X=V+"-open",Y=V+"-show",Z=V+"-hide",aa="viewer-hide-xs-down",ba="viewer-hide-sm-down",ca="viewer-hide-md-down",da=V+"-fade",ea=V+"-in",fa=V+"-move",ga=V+"-active",ha=V+"-invisible",ia=V+"-transition",ja=V+"-fullscreen",ka=V+"-fullscreen-exit",la=V+"-close",ma="mousedown touchstart pointerdown MSPointerDown",na="mousemove touchmove pointermove MSPointerMove",oa="mouseup touchend touchcancel pointerup pointercancel MSPointerUp MSPointerCancel",pa="wheel mousewheel DOMMouseScroll",qa="transitionend",ra="load",sa="keydown",ta="click",ua="resize",va="ready",wa="show",xa="shown",ya="hide",za="hidden",Aa="view",Ba="viewed",Ca="webkitfullscreenchange mozfullscreenchange fullscreenchange MSFullscreenChange",Da=/^(width|height|left|top|marginLeft|marginTop)$/,Ea=/([a-z\d])([A-Z])/g,Fa=/^\s+(.*)\s+$/,Ga=/\s+/,Ha="undefined"!=typeof T.createElement(V).style.transition,Ia=Math.min,Ja=Math.max,Ka=Math.abs,La=Math.sqrt,Ma=Math.round,Na=Object.prototype,Oa=Na.toString,Pa=Na.hasOwnProperty,Qa=Array.prototype.slice;S.prototype={constructor:S,init:function(){var b=this,c=b.options,d=b.element,e="img"===d.tagName.toLowerCase(),f=e?[d]:H(d,"img"),g=f.length,h=p(b.ready,b);S.TEMPLATE=Toast.ThemeLoader.getHTMLTemplates().ImageViewer,x(d,V)||(y(d,V,b),g&&(i(c.ready)&&A(d,va,c.ready,!0),Ha||(c.transition=!1),b.isImg=e,b.length=g,b.count=0,b.images=f,b.body=T.body,b.scrollbarWidth=a.innerWidth-T.body.clientWidth,c.inline?(A(d,va,function(){b.view()},!0),n(f,function(a){a.complete?h():A(a,ra,h,!0)})):A(d,ta,b._start=p(b.start,b)),A(T,Ca,b._changeFullScreen=p(b._changeFullScreen,b))))},ready:function(){var a=this;a.count++,a.count===a.length&&a.build()},build:function(){var a,b,c,d,e,f,g,h,i,j,k,l=this,m=l.options,n=l.element;if(!l.isBuilt){if(a=T.createElement("div"),a.innerHTML=S.TEMPLATE,l.parent=b=n.parentNode,l.viewer=c=I(a,"iviewer")[0],l.viewerWindow=d=I(a,"viewer-window")[0],l.canvas=I(c,"viewer-canvas")[0],l.footer=I(c,"viewer-footer")[0],l.title=h=I(c,"viewer-title")[0],l.description=i=I(c,"viewer-description")[0],l.number=j=I(c,"viewer-number")[0],l.toolbar=f=I(c,"viewer-toolbar")[0],l.navbar=g=I(c,"viewer-navbar")[0],l.button=e=I(c,"viewer-button")[0],l.tooltipBox=I(c,"viewer-tooltip")[0],l.player=I(c,"viewer-player")[0],l.list=I(c,"viewer-list")[0],l.preloader=I(c,"preloader")[0],l.sideNavigateButtons=k=I(c,"side-navigate-buttons")[0],t(h,m.title?R(m.title):Z),t(i,m.description?R(m.description):Z),t(j,m.number&&1!==l.images.length?R(m.number):Z),t(f,m.toolbar?R(m.toolbar):Z),t(g,m.navbar?R(m.navbar):Z),m.zoomable||$(l.toolbar).addClass("hide-zoom"),1===l.images.length){var o=I(c,"viewer-prev")[0],p=I(c,"viewer-play")[0],s=I(c,"viewer-next")[0];t(o,Z),t(p,Z),t(s,Z),t(k,Z),t(l.toolbar,"viewer-one-image"),t(l.viewer,"viewer-one-image")}else if(Toast._msieVersion&&Toast._msieVersion<11){var p=I(c,"viewer-play")[0];t(p,Z),t(l.toolbar,"viewer-play-hide")}v(e,Z,!m.button),v(f.querySelector(".viewer-one-to-one"),Z,!m.zoomable),v(f.querySelectorAll('li[class*="zoom"]'),Z,!m.zoomable),v(f.querySelectorAll(".viewer-reset"),Z,!m.zoomable),m.inline?(t(e,ja),q(c,{zIndex:m.zIndexInline}),"static"===r(b).position&&q(b,{position:"relative"})):(t(e,la),t(c,W),t(c,da),t(c,Z),q(c,{zIndex:m.zIndex})),_.isEmpty(m.backgroundColor)||q(c,{backgroundColor:m.backgroundColor}),_.isEmpty(m.toolbarColor)||q(l.footer,{backgroundColor:m.toolbarColor}),b.insertBefore(c,n.nextSibling),m.inline&&(l.render(),l.bind(),l.isShown=!0),$(l.title).html(m.title),$(l.description).html(m.description),l.isBuilt=!0,C(n,va)}},unbuild:function(){var a=this;a.isBuilt&&(a.isBuilt=!1,K(a.viewer))},bind:function(){var b=this,c=b.options,d=b.element,e=b.viewer;i(c.view)&&A(d,Aa,c.view),i(c.viewed)&&A(d,Ba,c.viewed),A(e,ta,b._click=p(b.click,b)),A(e,pa,b._wheel=p(b.wheel,b)),A(b.canvas,ma,b._mousedown=p(b.mousedown,b)),A(T,na,b._mousemove=p(b.mousemove,b)),A(T,oa,b._mouseup=p(b.mouseup,b)),A(T,sa,b._keydown=p(b.keydown,b)),A(a,ua,b._resize=p(b.resize,b))},unbind:function(){var b=this,c=b.options,d=b.element,e=b.viewer;i(c.view)&&B(d,Aa,c.view),i(c.viewed)&&B(d,Ba,c.viewed),B(e,ta,b._click),B(e,pa,b._wheel),B(b.canvas,ma,b._mousedown),B(T,na,b._mousemove),B(T,oa,b._mouseup),B(T,sa,b._keydown),B(a,ua,b._resize)},render:function(){var a=this;a.initContainer(),a.initViewer(),a.initList(),a.renderViewer()},initContainer:function(){var b=this;b.containerData={width:a.innerWidth,height:a.innerHeight}},initViewer:function(){var a,b=this,c=b.options,d=b.parent;c.inline&&(b.parentData=a={width:Ja(d.offsetWidth,c.minWidth),height:Ja(d.offsetHeight,c.minHeight)}),(b.isFulled||!a)&&(a=b.containerData),b.viewerData=o({},a)},renderViewer:function(){var a=this;a.options.inline&&!a.isFulled&&q(a.viewer,a.viewerData)},initCanvas:function(){var a=this;a.viewerCanvasData={width:$(a.viewerWindow).width(),height:$(a.viewerWindow).height()-a.footer.offsetHeight}},renderCanvas:function(){var a=this;q(a.canvas,a.viewerCanvasData)},initList:function(){var a=this,b=a.options,c=(a.element,a.list),e=[];n(a.images,function(a,c){var f=a.getAttribute("data-original-url"),g=a.alt||O(f),h=b.url;f&&(d(h)?h=a.getAttribute(h):i(h)&&(h=h.call(a,a)),e.push('<li><img src="'+f+'" data-action="view" data-index="'+c+'" data-original-url="'+(h||f)+'" alt="'+g+'"></li>'))}),c.innerHTML=e.join(""),q(c,{opacity:0}),n(H(c,"img"),function(b){y(b,"filled",!0),A(b,ra,p(a.loadImage,a),!0)}),a.items=H(c,"li")},renderList:function(a){var b=this,c=b.options,d=a||b.index,e=b.items[d].offsetWidth||30,f=e+1,g=b.list.style;0==g.opacity?g.opacity=1:c.transition&&!s(b.list,ia)&&t(b.list,ia),q(b.list,{width:f*b.length,marginLeft:($(b.viewerWindow).width()-e)/2-f*d})},resetList:function(){var a=this;L(a.list),u(a.list,ia),q({marginLeft:0})},initImage:function(a){var b=this,c=b.options,d=b.image;P(d,function(e,f){var g,h,j,k,l,m=(b.viewerData,b.number),n=b.imageData||{},p=({width:$(b.viewerWindow).width(),height:$(b.viewerWindow).height()},e/f);b.initCanvas(),b.renderCanvas(),b.renderList(),l=Math.min(b.viewerCanvasData.width/e,b.viewerCanvasData.height/f),g=parseInt(e*l),h=parseInt(f*l),c.extractFit!==!0&&(g=Math.min(g,e),h=Math.min(h,f)),$(m).text(b.index+1+"/"+b.images.length),j={naturalWidth:e,naturalHeight:f,aspectRatio:p,ratio:l,width:g,height:h,left:(b.viewerCanvasData.width-g)/2,top:(b.viewerCanvasData.height-h)/2},k=o({},j),c.rotatable&&(j.rotate=n.rotate||0,k.rotate=0),c.scalable&&(j.scaleX=n.scaleX||1,j.scaleY=n.scaleY||1,k.scaleX=1,k.scaleY=1),b.imageData=j,b.initialImageData=k,c.minZoomRatio=Math.min(b.viewerCanvasData.width/e,b.viewerCanvasData.height/f),c.minZoomRatio=Math.min(1,c.minZoomRatio),c.minZoomRatio>.95&&c.minZoomRatio<1.05&&(c.minZoomRatio=1),c.maxZoomRatio>.95&&c.maxZoomRatio<1.05&&(c.maxZoomRatio=1),c.minZoomRatio===c.maxZoomRatio?(u(d,fa),c.zoomable&&$(b.toolbar).addClass("hide-zoom")):(t(d,fa),c.zoomable&&$(b.toolbar).removeClass("hide-zoom")),i(a)&&a()})},renderImage:function(a){var b=this,c=b.image,d=b.imageData,e=Q(d);q(c,{width:d.width,height:d.height,marginLeft:d.left,marginTop:d.top,WebkitTransform:e,msTransform:e,transform:e}),i(a)&&(b.transitioning?A(c,qa,a,!0):a())},resetImage:function(){var a=this;a.image&&(K(a.image),a.image=null)},start:function(a){var b=this,c=E(a),d=c.target;"img"===d.tagName.toLowerCase()&&(b.target=d,b.show())},click:function(a){var b=this,c=E(a),d=c.target,e=x(d,"action"),f=b.imageData;switch(e){case"mix":b.isPlayed?b.isFulled?b.exitFullscreen():b.stop():b.options.inline?b.isFulled?b.exit():b.full():b.hide();break;case"view":b.view(x(d,"index"));break;case"zoom-in":b.zoom(.1,!0);break;case"zoom-out":b.zoom(-.1,!0);break;case"one-to-one":b.toggle();break;case"reset":b.reset();break;case"prev":b.prev();break;case"play":b.play();break;case"next":b.next();break;case"rotate-left":b.rotate(-90);break;case"rotate-right":b.rotate(90);break;case"flip-horizontal":b.scaleX(-f.scaleX||-1);break;case"flip-vertical":b.scaleY(-f.scaleY||-1);break;default:b.isPlayed}},load:function(){var a=this,b=a.options,c=a.image,d=a.index,e=a.viewerData;a.timeout&&(clearTimeout(a.timeout),a.timeout=!1),u(c,ha),c.style.cssText="width:0;height:0;margin-left:"+e.width/2+"px;margin-top:"+e.height/2+"px;max-width:none!important;visibility:visible;",a.initImage(function(){b.minZoomRatio===b.maxZoomRatio?u(c,fa):v(c,fa,b.movable),t(c,da),a.renderImage(function(){$(a.preloader).is(":visible")&&$(a.preloader).hide();var e,f;e=I(a.canvas,"btn-side-previous")[0],f=I(a.canvas,"btn-side-next")[0],d+1>=a.length?$(f).hide():$(f).show(),0>=d?$(e).hide():$(e).show(),q(a.footer,{opacity:1}),Toast.lazy(function(){v(c,ia,b.transition),t(c,ea)},0),a.isViewed=!0,C(a.element,Ba,{originalImage:a.images[d],index:d,image:c}),Toast.send(Toast.Events.IMAGEVIEWER_VIEWED,{originalImage:a.images[d],index:d,image:c})})})},loadImage:function(a){var b=E(a),c=b.target,d=c.parentNode,e=d.offsetWidth||30,f=d.offsetHeight||50,g=!!x(c,"filled");P(c,function(a,b){var d=a/b,h=e,i=f;f*d>e?g?h=f*d:i=e/d:g?i=e/d:h=f*d,q(c,{width:h,height:i,marginLeft:(e-h)/2,marginTop:(f-i)/2})})},resize:function(){var a=this;a.initContainer(),a.initViewer(),a.renderViewer(),q(a.canvas,{bottom:$(a.footer).height()+"px"}),a.isViewed&&a.initImage(function(){a.renderImage(),Toast.lazy(function(){Toast.send(Toast.Events.IMAGEVIEWER_RESIZED)},300)}),a.isPlayed&&n(H(a.player,"img"),function(b){A(b,ra,p(a.loadImage,a),!0),C(b,ra)})},wheel:function(a){var b=this,c=E(a),d=Number(b.options.zoomRatio)||.1,e=1;b.isViewed&&(D(c),b.wheeling||(b.wheeling=!0,setTimeout(function(){b.wheeling=!1},50),c.deltaY?e=c.deltaY>0?1:-1:c.wheelDelta?e=-c.wheelDelta/120:c.detail&&(e=c.detail>0?1:-1),b.zoom(-e*d,!0,c)))},keydown:function(a){var b=this,c=E(a),d=b.options,e=c.keyCode||c.which||c.charCode;if(b.isFulled&&d.keyboard)switch(e){case 27:b.isPlayed?b.stop():d.inline?b.isFulled&&b.exit():b.hide();break;case 32:b.isPlayed&&b.stop();break;case 37:b.prev();break;case 38:D(c),b.zoom(d.zoomRatio,!0);break;case 39:b.next();break;case 40:D(c),b.zoom(-d.zoomRatio,!0);break;case 48:case 49:(c.ctrlKey||c.shiftKey)&&(D(c),b.toggle())}},mousedown:function(a){var b,c,d=this,e=d.options,f=E(a),g=e.movable?"move":!1,h=f.touches;if(d.isViewed){if(h){if(b=h.length,b>1){if(!e.zoomable||2!==b)return;c=h[1],d.startX2=c.pageX,d.startY2=c.pageY,g="zoom"}else d.isSwitchable()&&(g="switch");c=h[0]}if(g){if(Toast.isMobileDevice&&!_.isUndefined(f.target)){var i=f.target,j=x(i,"action");_.isUndefined(j)&&D(f)}else D(f);d.action=g,d.startX=c?c.pageX:f.pageX,d.startY=c?c.pageY:f.pageY}}},mousemove:function(a){var b,c,d=this,e=d.options,f=E(a),g=d.action,h=d.image,i=f.touches;if(d.isViewed){if(i){if(b=i.length,b>1){if(!e.zoomable||2!==b)return;c=i[1],d.endX2=c.pageX,d.endY2=c.pageY}c=i[0]}g&&(D(f),"move"===g&&e.transition&&s(h,ia)&&u(h,ia),d.endX=c?c.pageX:f.pageX,d.endY=c?c.pageY:f.pageY,d.change(f))}},mouseup:function(a){var b=this,c=E(a),d=b.action;if(d){if(Toast.isMobileDevice&&!_.isUndefined(c.target)){var e=c.target,f=x(e,"action");_.isUndefined(f)&&D(c)}else D(c);"move"===d&&b.options.transition&&t(b.image,ia),b.action=!1}},_isFullScreen:function(){return"undefined"!=typeof external&&"undefined"!=typeof external.isFullscreen?external.isFullscreen():T.fullscreenElement?T.fullscreenElement:T.msFullscreenElement?T.msFullscreenElement:T.mozFullScreenElement?T.mozFullScreenElement:T.webkitFullscreenElement?T.webkitFullscreenElement:void 0},_changeFullScreen:function(a){var b=this,c=b.options;b._isFullScreen()||(b.isPlayed?b.stop():c.inline?b.isFulled&&b.exit():b.hide())},show:function(){var a,b=this,c=b.options,d=b.element;return c.inline||b.transitioning?b:(b.isBuilt||b.build(),a=b.viewer,i(c.show)&&A(d,wa,c.show,!0),C(d,wa)===!1?b:(b.open(),u(a,Z),Toast.send(Toast.Events.IMAGEVIEWER_SHOW),A(d,xa,function(){b.view(b.target?l(b.target,k(b.images)):b.index),b.target=!1},!0),c.transition?(b.transitioning=!0,t(a,ia),N(a),A(a,qa,p(b.shown,b),!0),t(a,ea)):(t(a,ea),b.shown()),b))},hide:function(){var a=this,b=a.options,c=a.element,d=a.viewer;return b.inline||a.transitioning||!a.isShown?a:(i(b.hide)&&A(c,ya,b.hide,!0),C(c,ya)===!1?a:(Toast.send(Toast.Events.IMAGEVIEWER_HIDE),a.isViewed&&b.transition?(a.transitioning=!0,A(a.image,qa,function(){A(d,qa,p(a.hidden,a),!0),u(d,ea)},!0),u(a.image,ea),v(a.image,ia,b.transition)):(u(d,ea),a.hidden()),a))},view:function(a){var b,c,d,e,f,g=this,h=g.element,i=(g.title,g.canvas),j=g.tooltipBox,k=g.sideNavigateButtons;return a=Number(a)||0,!g.isShown||g.isPlayed||0>a||a>=g.length||g.isViewed&&a===g.index?g:(c=g.items[a],d=H(c,"img")[0],e=x(d,"originalUrl"),f=d.getAttribute("alt"),b=T.createElement("img"),b.src=e,b.alt=f,C(h,Aa,{originalImage:g.images[a],index:a,image:b})===!1?g:(g.image=b,g.isViewed&&u(g.items[g.index],ga),t(c,ga),g.isViewed=!1,g.index=a,g.imageData=null,L(i),J(i,b),J(i,j),J(i,k),t(b,ha),A(h,Ba,function(){var a=g.imageData;a.naturalWidth,a.naturalHeight},!0),b.complete?g.load():(A(b,ra,p(g.load,g),!0),g.timeout&&(clearTimeout(g.timeout),g.timeout=!1)),g))},prev:function(){var a=this;return a.view(Ja(a.index-1,0)),a},next:function(){var a=this;return a.view(Ia(a.index+1,a.length-1)),a},move:function(a,b){var c=this,d=c.imageData;return c.moveTo(f(a)?a:d.left+Number(a),f(b)?b:d.top+Number(b)),c},limit:function(){var a,b,c=this,d=c.imageData,e={width:d.width,height:d.height},f={width:$(c.canvas).width(),height:$(c.canvas).height()};e.width>f.width?(a=e.width-Math.abs(d.left)<f.width?f.width-e.width:Math.min(0,d.left),d.left=a):d.left=(f.width-d.width)/2,e.height>f.height?(b=e.height-Math.abs(d.top)<f.height?f.height-e.height:Math.min(0,d.top),d.top=b):d.top=(f.height-d.height)/2},moveTo:function(a,b){var c=this,d=c.imageData,g=!1;return f(b)&&(b=a),a=Number(a),b=Number(b),c.isViewed&&!c.isPlayed&&c.options.movable&&(e(a)&&(d.left=a,g=!0),e(b)&&(d.top=b,g=!0),g&&c.limit(),g&&c.renderImage()),c},zoom:function(a,b,c){var d=this,e=d.imageData;return a=Number(a),a=0>a?1/(1-a):1+a,d.zoomTo(e.width*a/e.naturalWidth,b,c),d},zoomTo:function(a,b,c,d){var f,g,h,i,j,k=this,l=k.options,m=.01,n=100,o=k.imageData;k.canvas;if(a=Ja(0,a),e(a)&&k.isViewed&&!k.isPlayed&&(d||l.zoomable)){if(d||(m=Ja(m,l.minZoomRatio),n=Ia(n,l.maxZoomRatio),a=Ia(Ja(a,m),n)),m===n)return;a>.95&&1.05>a&&(a=1),a=Math.max(a,l.minZoomRatio),f=o.naturalWidth*a,g=o.naturalHeight*a,c?(h=F(k.viewer),i=c.touches?G(c.touches):{pageX:c.pageX,pageY:c.pageY},j=F(k.viewerWindow),o.left-=(f-o.width)*((i.pageX-(h.left+j.left)-o.left)/o.width),o.top-=(g-o.height)*((i.pageY-(h.top+j.top)-o.top)/o.height)):(o.left-=(f-o.width)/2,o.top-=(g-o.height)/2),o.width=f,o.height=g,o.ratio=a,k.limit(),k.renderImage(),b&&k.tooltip(),l.zoomTo&&l.zoomTo(a,m,n),Toast.send(Toast.Events.IMAGEVIEWER_ZOOM_TO,a,m,n)}return k},rotate:function(a){var b=this;return b.rotateTo((b.imageData.rotate||0)+Number(a)),b},rotateTo:function(a){var b=this,c=b.imageData;return a=Number(a),e(a)&&b.isViewed&&!b.isPlayed&&b.options.rotatable&&(c.rotate=a,b.renderImage()),b},scale:function(a,b){var c=this,d=c.imageData,g=!1;return f(b)&&(b=a),a=Number(a),b=Number(b),c.isViewed&&!c.isPlayed&&c.options.scalable&&(e(a)&&(d.scaleX=a,g=!0),e(b)&&(d.scaleY=b,g=!0),g&&c.renderImage()),c},scaleX:function(a){var b=this;return b.scale(a,b.imageData.scaleY),b},scaleY:function(a){var b=this;return b.scale(b.imageData.scaleX,a),b},play:function(){var a,b=this,c=b.options,d=b.player,f=p(b.loadImage,b),g=[],h=0,i=0;return!b.isShown||b.isPlayed?b:(c.fullscreen&&b.requestFullscreen(),b.isPlayed=!0,t(d,Y),n(b.items,function(a,b){var e=H(a,"img")[0],j=T.createElement("img");j.src=x(e,"originalUrl"),j.alt=e.getAttribute("alt"),h++,t(j,da),v(j,ia,c.transition),s(a,ga)&&(t(j,ea),i=b),g.push(j),A(j,ra,f,!0),J(d,j)}),e(c.interval)&&c.interval>0&&(a=function(){
b.playing=setTimeout(function(){u(g[i],ea),i++,i=h>i?i:0,t(g[i],ea),a()},c.interval)},h>1&&a()),b)},stop:function(){var a=this,b=a.player;return a.isPlayed?(a.options.fullscreen&&a.exitFullscreen(),a.isPlayed=!1,clearTimeout(a.playing),u(b,Y),L(b),a):a},full:function(){var a=this,b=a.options,c=a.viewer,d=a.image,e=a.list;return!a.isShown||a.isPlayed||a.isFulled||!b.inline?a:(a.isFulled=!0,a.open(),t(a.button,ka),b.transition&&(u(d,ia),u(e,ia)),t(c,W),c.setAttribute("style",""),q(c,{zIndex:b.zIndex}),a.initContainer(),a.viewerData=o({},a.containerData),a.initImage(function(){a.renderImage(function(){b.transition&&setTimeout(function(){t(d,ia),t(e,ia)},0)})}),a)},exit:function(){var a=this,b=a.options,c=a.viewer,d=a.image,e=a.list;return a.isFulled?(a.isFulled=!1,a.close(),u(a.button,ka),b.transition&&(u(d,ia),u(e,ia)),u(c,W),q(c,{zIndex:b.zIndexInline}),a.viewerData=o({},a.parentData),a.renderViewer(),a.initImage(function(){a.renderImage(function(){b.transition&&setTimeout(function(){t(d,ia),t(e,ia)},0)})}),a):a},tooltip:function(){var a=this,b=a.options,c=a.tooltipBox,d=a.imageData;return a.isViewed&&!a.isPlayed&&b.tooltip?(M(c,Ma(100*d.ratio)+"%"),a.tooltiping?clearTimeout(a.tooltiping):b.transition?(a.fading&&C(c,qa),t(c,Y),t(c,da),t(c,ia),N(c),t(c,ea)):t(c,Y),a.tooltiping=setTimeout(function(){b.transition?(A(c,qa,function(){u(c,Y),u(c,da),u(c,ia),a.fading=!1},!0),u(c,ea),a.fading=!0):u(c,Y),a.tooltiping=!1},1e3),a):a},toggle:function(){var a=this;return 1===a.imageData.ratio?a.zoomTo(a.initialImageData.ratio,!0):a.zoomTo(1,!0),a},reset:function(){var a=this;return a.isViewed&&!a.isPlayed&&(a.imageData=o({},a.initialImageData),a.renderImage(),Toast.send(Toast.Events.IMAGEVIEWER_RESET)),a},update:function(){var a,b=this,c=[];return b.isImg&&!b.element.parentNode?b.destroy():(b.length=b.images.length,b.isBuilt&&(n(b.items,function(a,d){var e=H(a,"img")[0],f=b.images[d];f?f.src!==e.src&&c.push(d):c.push(d)}),q(b.list,{width:"auto"}),b.initList(),b.isShown&&(b.length?b.isViewed&&(a=l(b.index,c),a>=0?(b.isViewed=!1,b.view(Ja(b.index-(a+1),0))):t(b.items[b.index],ga)):(b.image=null,b.isViewed=!1,b.index=0,b.imageData=null,L(b.canvas)))),b)},destroy:function(){var a=this,b=a.element;return a.options.inline?a.unbind():(a.isShown&&a.unbind(),B(b,ta,a._start)),B(T,Ca,a._changeFullScreen),a.unbuild(),z(b,V),a},open:function(){var a=this.body;t(a,X),a.style.paddingRight=this.scrollbarWidth+"px"},close:function(){var a=this.body;u(a,X),a.style.paddingRight=0},shown:function(){var a=this,b=a.options,c=a.element;a.transitioning=!1,a.isFulled=!0,a.isShown=!0,a.isVisible=!0,a.render(),a.bind(),i(b.shown)&&A(c,xa,b.shown,!0),C(c,xa),Toast.send(Toast.Events.IMAGEVIEWER_SHOWN)},hidden:function(){var a=this,b=a.options,c=a.element;a.transitioning=!1,a.isViewed=!1,a.isFulled=!1,a.isShown=!1,a.isVisible=!1,a.unbind(),a.close(),t(a.viewer,Z),a.resetList(),a.resetImage(),i(b.hidden)&&A(c,za,b.hidden,!0),C(c,za),Toast.send(Toast.Events.IMAGEVIEWER_HIDDEN),a.destroy()},requestFullscreen:function(){var a=this,b=T.documentElement;!a.isFulled||T.fullscreenElement||T.mozFullScreenElement||T.webkitFullscreenElement||T.msFullscreenElement||(b.requestFullscreen?b.requestFullscreen():b.msRequestFullscreen?b.msRequestFullscreen():b.mozRequestFullScreen?b.mozRequestFullScreen():b.webkitRequestFullscreen&&b.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT))},exitFullscreen:function(){var a=this;a.isFulled&&(T.exitFullscreen?T.exitFullscreen():T.msExitFullscreen?T.msExitFullscreen():T.mozCancelFullScreen?T.mozCancelFullScreen():T.webkitExitFullscreen&&T.webkitExitFullscreen())},change:function(a){var b=this,c=b.endX-b.startX,d=b.endY-b.startY;switch(b.action){case"move":b.move(c,d);break;case"zoom":b.zoom(function(a,b,c,d){var e=La(a*a+b*b),f=La(c*c+d*d);return(f-e)/e}(Ka(b.startX-b.startX2),Ka(b.startY-b.startY2),Ka(b.endX-b.endX2),Ka(b.endY-b.endY2)),!1,a),b.startX2=b.endX2,b.startY2=b.endY2;break;case"switch":b.action="switched",Ka(c)>Ka(d)&&(c>1?b.prev():-1>c&&b.next())}b.startX=b.endX,b.startY=b.endY},isSwitchable:function(){var a=this,b=a.imageData,c=a.viewerData;return b.left>=0&&b.top>=0&&b.width<=c.width&&b.height<=c.height}},S.DEFAULTS={inline:!1,button:!0,navbar:!0,title:!0,toolbar:!0,tooltip:!0,movable:!0,zoomable:!0,rotatable:!1,scalable:!0,transition:!0,fullscreen:!0,keyboard:!0,interval:5e3,minWidth:200,minHeight:100,zoomRatio:.3,minZoomRatio:.5,maxZoomRatio:1,zIndex:9998,zIndexInline:0,url:"src",backgroundColor:"transparent",toolbarColor:"transparent",number:!0,extractFit:!1,build:null,built:null,show:null,shown:null,hide:null,hidden:null,view:null,viewed:null,zoomTo:null};var Ra=a.ImageViewer;return S.noConflict=function(){return a.ImageViewer=Ra,S},S.setDefaults=function(a){o(S.DEFAULTS,a)},"function"==typeof define&&define.amd&&define("toast/libs/ImageViewer",[],function(){return S}),b||(a.ImageViewer=S),S}),function(a){"use strict";a(jQuery)}(function(a,b){"use strict";function c(b,c,d,e){for(var f=[],g=0;g<b.length;g++){var h=b[g];if(h){var i=tinycolor(h),j=i.toHsl().l<.5?"sp-thumb-el sp-thumb-dark":"sp-thumb-el sp-thumb-light";j+=tinycolor.equals(c,h)?" sp-thumb-active":"";var k=i.toString(e.preferredFormat||"rgb"),l=p?"background-color:"+i.toRgbString():"filter:"+i.toFilter();f.push('<span title="'+k+'" data-color="'+i.toRgbString()+'" class="'+j+'"><span class="sp-thumb-inner" style="'+l+';" /></span>')}else{var m="sp-clear-display";f.push(a("<div />").append(a('<span data-color="" style="background-color:transparent;" class="'+m+'"></span>').attr("title",e.noColorSelectedText)).html())}}return"<div class='sp-cf "+d+"'>"+f.join("")+"</div>"}function d(){for(var a=0;a<n.length;a++)n[a]&&n[a].hide()}function e(b,c){var d=a.extend({},m,b);return d.callbacks={move:j(d.move,c),change:j(d.change,c),show:j(d.show,c),hide:j(d.hide,c),beforeShow:j(d.beforeShow,c)},d}function f(f,h){function j(){if(T.showPaletteOnly&&(T.showPalette=!0),Ka.text(T.showPaletteOnly?T.togglePaletteMoreText:T.togglePaletteLessText),T.palette){la=T.palette.slice(0),ma=a.isArray(la[0])?la:[la],na={};for(var b=0;b<ma.length;b++)for(var c=0;c<ma[b].length;c++){var d=tinycolor(ma[b][c]).toRgbString();na[d]=!0}}va.toggleClass("sp-flat",U),va.toggleClass("sp-input-disabled",!T.showInput),va.toggleClass("sp-alpha-enabled",T.showAlpha),va.toggleClass("sp-clear-enabled",Xa),va.toggleClass("sp-buttons-disabled",!T.showButtons),va.toggleClass("sp-palette-buttons-disabled",!T.togglePaletteOnly),va.toggleClass("sp-palette-disabled",!T.showPalette),va.toggleClass("sp-palette-only",T.showPaletteOnly),va.toggleClass("sp-initial-disabled",!T.showInitial),va.addClass(T.className).addClass(T.containerClassName),N()}function m(){function b(b){return b.data&&b.data.ignore?(G(a(b.target).closest(".sp-thumb-el").data("color")),J()):(G(a(b.target).closest(".sp-thumb-el").data("color")),J(),M(!0),T.hideAfterPaletteSelect&&E()),!1}if(o&&va.find("*:not(input)").attr("unselectable","on"),j(),Na&&ta.after(Oa).hide(),Xa||Ia.hide(),U)ta.after(va).hide();else{var c="parent"===T.appendTo?ta.parent():a(T.appendTo);1!==c.length&&(c=a("body")),c.append(va)}t(),Pa.bind("click.spectrum touchstart.spectrum",function(b){ua||B(),b.stopPropagation(),a(b.target).is("input")||b.preventDefault()}),(ta.is(":disabled")||T.disabled===!0)&&R(),va.click(i),Ea.change(A),Ea.bind("paste",function(){setTimeout(A,1)}),Ea.keydown(function(a){13==a.keyCode&&A()}),Ha.text(T.cancelText),Ha.bind("click.spectrum",function(a){a.stopPropagation(),a.preventDefault(),F(),E()}),Ia.attr("title",T.clearText),Ia.bind("click.spectrum",function(a){a.stopPropagation(),a.preventDefault(),Wa=!0,J(),U&&M(!0)}),Ja.text(T.chooseText),Ja.bind("click.spectrum",function(a){a.stopPropagation(),a.preventDefault(),I()&&(M(!0),E())}),Ka.text(T.showPaletteOnly?T.togglePaletteMoreText:T.togglePaletteLessText),Ka.bind("click.spectrum",function(a){a.stopPropagation(),a.preventDefault(),T.showPaletteOnly=!T.showPaletteOnly,T.showPaletteOnly||U||va.css("left","-="+(wa.outerWidth(!0)+5)),j()}),k(Ca,function(a,b,c){ka=a/ea,Wa=!1,c.shiftKey&&(ka=Math.round(10*ka)/10),J()},y,z),k(za,function(a,b){ha=parseFloat(b/ca),Wa=!1,T.showAlpha||(ka=1),J()},y,z),k(xa,function(a,b,c){if(c.shiftKey){if(!ra){var d=ia*_,e=aa-ja*aa,f=Math.abs(a-d)>Math.abs(b-e);ra=f?"x":"y"}}else ra=null;var g=!ra||"x"===ra,h=!ra||"y"===ra;g&&(ia=parseFloat(a/_)),h&&(ja=parseFloat((aa-b)/aa)),Wa=!1,T.showAlpha||(ka=1),J()},y,z),Ra?(G(Ra),K(),Ua=Ta||tinycolor(Ra).format,u(Ra)):K(),U&&C();var d=o?"mousedown.spectrum":"click.spectrum touchstart.spectrum";Fa.delegate(".sp-thumb-el",d,b),Ga.delegate(".sp-thumb-el:nth-child(1)",d,{ignore:!0},b)}function t(){if(W&&window.localStorage){try{var b=window.localStorage[W].split(",#");b.length>1&&(delete window.localStorage[W],a.each(b,function(a,b){u(b)}))}catch(c){}try{oa=window.localStorage[W].split(";")}catch(c){}}}function u(b){if(V){var c=tinycolor(b).toRgbString();if(!na[c]&&-1===a.inArray(c,oa))for(oa.push(c);oa.length>pa;)oa.shift();if(W&&window.localStorage)try{window.localStorage[W]=oa.join(";")}catch(d){}}}function v(){var a=[];if(T.showPalette)for(var b=0;b<oa.length;b++){var c=tinycolor(oa[b]).toRgbString();na[c]||a.push(oa[b])}return a.reverse().slice(0,T.maxSelectionSize)}function w(){var b=H(),d=a.map(ma,function(a,d){return c(a,b,"sp-palette-row sp-palette-row-"+d,T)});t(),oa&&d.push(c(v(),b,"sp-palette-row sp-palette-row-selection",T)),Fa.html(d.join(""))}function x(){if(T.showInitial){var a=Sa,b=H();Ga.html(c([a,b],b,"sp-palette-row-initial",T))}}function y(){(0>=aa||0>=_||0>=ca)&&N(),va.addClass(qa),ra=null,ta.trigger("dragstart.spectrum",[H()])}function z(){va.removeClass(qa),ta.trigger("dragstop.spectrum",[H()])}function A(){var a=Ea.val();if(null!==a&&""!==a||!Xa){var b=tinycolor(a);b.isValid()?(G(b),M(!0)):Ea.addClass("sp-validation-error")}else G(null),M(!0)}function B(){$?E():C()}function C(){var b=a.Event("beforeShow.spectrum");return $?void N():(ta.trigger(b,[H()]),void(Y.beforeShow(H())===!1||b.isDefaultPrevented()||(d(),$=!0,a(sa).bind("click.spectrum",D),a(window).bind("resize.spectrum",Z),Oa.addClass("sp-active"),va.removeClass("sp-hidden"),N(),K(),Sa=H(),x(),Y.show(Sa),ta.trigger("show.spectrum",[Sa]))))}function D(a){2!=a.button&&(Va?M(!0):F(),E())}function E(){$&&!U&&($=!1,a(sa).unbind("click.spectrum",D),a(window).unbind("resize.spectrum",Z),Oa.removeClass("sp-active"),va.addClass("sp-hidden"),Y.hide(H()),ta.trigger("hide.spectrum",[H()]))}function F(){G(Sa,!0)}function G(a,b){if(tinycolor.equals(a,H()))return void K();var c,d;!a&&Xa?Wa=!0:(Wa=!1,c=tinycolor(a),d=c.toHsv(),ha=d.h%360/360,ia=d.s,ja=d.v,ka=d.a),K(),c&&c.isValid()&&!b&&(Ua=Ta||c.getFormat())}function H(a){return a=a||{},Xa&&Wa?null:tinycolor.fromRatio({h:ha,s:ia,v:ja,a:Math.round(100*ka)/100},{format:a.format||Ua})}function I(){return!Ea.hasClass("sp-validation-error")}function J(){K(),Y.move(H()),ta.trigger("move.spectrum",[H()])}function K(){Ea.removeClass("sp-validation-error"),L();var a=tinycolor.fromRatio({h:ha,s:1,v:1});xa.css("background-color",a.toHexString());var b=Ua;1>ka&&(0!==ka||"name"!==b)&&("hex"===b||"hex3"===b||"hex6"===b||"name"===b)&&(b="rgb");var c=H({format:b}),d="";if(Qa.removeClass("sp-clear-display"),Qa.css("background-color","transparent"),!c&&Xa)Qa.addClass("sp-clear-display");else{var e=c.toHexString(),f=c.toRgbString();if(p||1===c.alpha?Qa.css("background-color",f):(Qa.css("background-color","transparent"),Qa.css("filter",c.toFilter())),T.showAlpha){var g=c.toRgb();g.a=0;var h=tinycolor(g).toRgbString(),i="linear-gradient(left, "+h+", "+e+")";o?Ba.css("filter",tinycolor(h).toFilter({gradientType:1},e)):(Ba.css("background","-webkit-"+i),Ba.css("background","-moz-"+i),Ba.css("background","-ms-"+i),Ba.css("background","linear-gradient(to right, "+h+", "+e+")"))}d=c.toString(b)}T.showInput&&Ea.val(d),T.showPalette&&w(),x()}function L(){var a=ia,b=ja;if(Xa&&Wa)Da.hide(),Aa.hide(),ya.hide();else{Da.show(),Aa.show(),ya.show();var c=a*_,d=aa-b*aa;c=Math.max(-ba,Math.min(_-ba,c-ba)),d=Math.max(-ba,Math.min(aa-ba,d-ba)),ya.css({top:d+"px",left:c+"px"});var e=ka*ea;Da.css({left:e-fa/2+"px"});var f=ha*ca;Aa.css({top:f-ga+"px"})}}function M(a){var b=H(),c="",d=!tinycolor.equals(b,Sa);b&&(c=b.toString(Ua),u(b)),La&&ta.val(c),a&&d&&(Y.change(b),ta.trigger("change",[b]))}function N(){_=xa.width(),aa=xa.height(),ba=ya.height(),da=za.width(),ca=za.height(),ga=Aa.height(),ea=Ca.width(),fa=Da.width(),U||(va.css("position","absolute"),T.offset?va.offset(T.offset):va.offset(g(va,Pa))),L(),T.showPalette&&w(),ta.trigger("reflow.spectrum")}function O(){ta.show(),Pa.unbind("click.spectrum touchstart.spectrum"),va.remove(),Oa.remove(),n[Ya.id]=null}function P(c,d){return c===b?a.extend({},T):d===b?T[c]:(T[c]=d,void j())}function Q(){ua=!1,ta.attr("disabled",!1),Pa.removeClass("sp-disabled")}function R(){E(),ua=!0,ta.attr("disabled",!0),Pa.addClass("sp-disabled")}function S(a){T.offset=a,N()}var T=e(h,f),U=T.flat,V=T.showSelectionPalette,W=T.localStorageKey===!1?"spectrum-"+f.id:T.localStorageKey,X=T.theme,Y=T.callbacks,Z=l(N,10),$=!1,_=0,aa=0,ba=0,ca=0,da=0,ea=0,fa=0,ga=0,ha=0,ia=0,ja=0,ka=1,la=[],ma=[],na={},oa=T.selectionPalette.slice(0),pa=T.maxSelectionSize,qa="sp-dragging",ra=null,sa=f.ownerDocument,ta=(sa.body,a(f)),ua=!1,va=a(s,sa).addClass(X),wa=va.find(".sp-picker-container"),xa=va.find(".sp-color"),ya=va.find(".sp-dragger"),za=va.find(".sp-hue"),Aa=va.find(".sp-slider"),Ba=va.find(".sp-alpha-inner"),Ca=va.find(".sp-alpha"),Da=va.find(".sp-alpha-handle"),Ea=va.find(".sp-input"),Fa=va.find(".sp-palette"),Ga=va.find(".sp-initial"),Ha=va.find(".sp-cancel"),Ia=va.find(".sp-clear"),Ja=va.find(".sp-choose"),Ka=va.find(".sp-palette-toggle"),La=ta.is("input"),Ma=La&&q&&"color"===ta.attr("type"),Na=La&&!U,Oa=Na?a(r).addClass(X).addClass(T.className).addClass(T.replacerClassName):a([]),Pa=Na?Oa:ta,Qa=Oa.find(".sp-preview-inner"),Ra=T.color||La&&ta.val(),Sa=!1,Ta=T.preferredFormat,Ua=Ta,Va=!T.showButtons||T.clickoutFiresChange,Wa=!Ra,Xa=T.allowEmpty&&!Ma;m();var Ya={show:C,hide:E,toggle:B,reflow:N,option:P,enable:Q,disable:R,offset:S,set:function(a){G(a),M()},get:H,destroy:O,container:va};return Ya.id=n.push(Ya)-1,Ya}function g(b,c){var d=0,e=b.outerWidth(),f=b.outerHeight(),g=c.outerHeight(),h=b[0].ownerDocument,i=h.documentElement,j=i.clientWidth+a(h).scrollLeft(),k=i.clientHeight+a(h).scrollTop(),l=c.offset();return l.top+=g,l.left-=Math.min(l.left,l.left+e>j&&j>e?Math.abs(l.left+e-j):0),l.top-=Math.min(l.top,l.top+f>k&&k>f?Math.abs(f+g-d):d),l}function h(){}function i(a){a.stopPropagation()}function j(a,b){var c=Array.prototype.slice,d=c.call(arguments,2);return function(){return a.apply(b,d.concat(c.call(arguments)))}}function k(b,c,d,e){function f(a){a.stopPropagation&&a.stopPropagation(),a.preventDefault&&a.preventDefault(),a.returnValue=!1}function g(a){if(k){if(o&&j.documentMode<9&&!a.button)return i();var d=a.originalEvent&&a.originalEvent.touches,e=d?d[0].pageX:a.pageX,g=d?d[0].pageY:a.pageY,h=Math.max(0,Math.min(e-l.left,n)),q=Math.max(0,Math.min(g-l.top,m));p&&f(a),c.apply(b,[h,q,a])}}function h(c){var e=c.which?3==c.which:2==c.button;e||k||d.apply(b,arguments)!==!1&&(k=!0,m=a(b).height(),n=a(b).width(),l=a(b).offset(),a(j).bind(q),a(j.body).addClass("sp-dragging"),p||g(c),f(c))}function i(){k&&(a(j).unbind(q),a(j.body).removeClass("sp-dragging"),e.apply(b,arguments)),k=!1}c=c||function(){},d=d||function(){},e=e||function(){};var j=document,k=!1,l={},m=0,n=0,p="ontouchstart"in window,q={};q.selectstart=f,q.dragstart=f,q["touchmove mousemove"]=g,q["touchend mouseup"]=i,a(b).bind("touchstart mousedown",h)}function l(a,b,c){var d;return function(){var e=this,f=arguments,g=function(){d=null,a.apply(e,f)};c&&clearTimeout(d),(c||!d)&&(d=setTimeout(g,b))}}var m={beforeShow:h,move:h,change:h,show:h,hide:h,color:!1,flat:!1,showInput:!0,allowEmpty:!1,showButtons:!1,clickoutFiresChange:!1,showInitial:!0,showPalette:!0,showPaletteOnly:!1,hideAfterPaletteSelect:!1,togglePaletteOnly:!1,showSelectionPalette:!0,localStorageKey:!1,appendTo:"body",maxSelectionSize:7,cancelText:"cancel",chooseText:"choose",togglePaletteMoreText:"more",togglePaletteLessText:"less",clearText:"Clear Color Selection",noColorSelectedText:"No Color Selected",preferredFormat:"hex",className:"",containerClassName:"",replacerClassName:"",showAlpha:!0,theme:"sp-light",palette:[["rgb(0, 0, 0)","rgb(67, 67, 67)","rgb(102, 102, 102)","rgb(204, 204, 204)","rgb(217, 217, 217)","rgb(255, 255, 255)"],["rgb(152, 0, 0)","rgb(255, 0, 0)","rgb(255, 153, 0)","rgb(255, 255, 0)","rgb(0, 255, 0)","rgb(0, 255, 255)","rgb(74, 134, 232)","rgb(0, 0, 255)","rgb(153, 0, 255)","rgb(255, 0, 255)"],["rgb(230, 184, 175)","rgb(244, 204, 204)","rgb(252, 229, 205)","rgb(255, 242, 204)","rgb(217, 234, 211)","rgb(208, 224, 227)","rgb(201, 218, 248)","rgb(207, 226, 243)","rgb(217, 210, 233)","rgb(234, 209, 220)","rgb(221, 126, 107)","rgb(234, 153, 153)","rgb(249, 203, 156)","rgb(255, 229, 153)","rgb(182, 215, 168)","rgb(162, 196, 201)","rgb(164, 194, 244)","rgb(159, 197, 232)","rgb(180, 167, 214)","rgb(213, 166, 189)","rgb(204, 65, 37)","rgb(224, 102, 102)","rgb(246, 178, 107)","rgb(255, 217, 102)","rgb(147, 196, 125)","rgb(118, 165, 175)","rgb(109, 158, 235)","rgb(111, 168, 220)","rgb(142, 124, 195)","rgb(194, 123, 160)","rgb(166, 28, 0)","rgb(204, 0, 0)","rgb(230, 145, 56)","rgb(241, 194, 50)","rgb(106, 168, 79)","rgb(69, 129, 142)","rgb(60, 120, 216)","rgb(61, 133, 198)","rgb(103, 78, 167)","rgb(166, 77, 121)","rgb(91, 15, 0)","rgb(102, 0, 0)","rgb(120, 63, 4)","rgb(127, 96, 0)","rgb(39, 78, 19)","rgb(12, 52, 61)","rgb(28, 69, 135)","rgb(7, 55, 99)","rgb(32, 18, 77)","rgb(76, 17, 48)"]],selectionPalette:[],disabled:!1,offset:null},n=[],o=!!/msie/i.exec(window.navigator.userAgent),p=function(){function a(a,b){return!!~(""+a).indexOf(b)}var b=document.createElement("div"),c=b.style;return c.cssText="background-color:rgba(0,0,0,.5)",a(c.backgroundColor,"rgba")||a(c.backgroundColor,"hsla")}(),q=function(){var b=a("<input type='color' value='!' />")[0];return"color"===b.type&&"!"!==b.value}(),r=["<div class='sp-replacer'>","<div class='sp-preview'><div class='sp-preview-inner'></div></div>","<span class='caret'></span>","</div>"].join(""),s=function(){var a="";if(o)for(var b=1;6>=b;b++)a+="<div class='sp-"+b+"'></div>";return["<div class='sp-container sp-hidden'>","<div class='sp-palette-container'>","<div class='sp-palette sp-thumb sp-cf'></div>","<div class='sp-palette-button-container sp-cf'>","<button type='button' class='sp-palette-toggle'></button>","</div>","</div>","<div class='sp-picker-container'>","<div class='sp-top sp-cf'>","<div class='sp-fill'></div>","<div class='sp-top-inner'>","<div class='sp-color'>","<div class='sp-sat'>","<div class='sp-val'>","<div class='sp-dragger'></div>","</div>","</div>","</div>","<div class='sp-clear sp-clear-display'>","</div>","<div class='sp-hue'>","<div class='sp-slider'></div>",a,"</div>","</div>","<div class='sp-alpha'><div class='sp-alpha-inner'><div class='sp-alpha-handle'></div></div></div>","</div>","<div class='sp-input-container sp-cf'>","<input class='sp-input' type='text' spellcheck='false'  />","</div>","<div class='sp-initial sp-thumb sp-cf'></div>","<div class='sp-button-container sp-cf'>","<a class='sp-cancel' href='#'></a>","<button type='button' class='sp-choose'></button>","</div>","</div>","</div>"].join("")}(),t="spectrum.id";a.fn.spectrum=function(b,c){if("string"==typeof b){var d=this,e=Array.prototype.slice.call(arguments,1);return this.each(function(){var c=n[a(this).data(t)];if(c){var f=c[b];if(!f)throw new Error("Spectrum: no such method: '"+b+"'");"get"==b?d=c.get():"container"==b?d=c.container:"option"==b?d=c.option.apply(c,e):"destroy"==b?(c.destroy(),a(this).removeData(t)):f.apply(c,e)}}),d}return this.spectrum("destroy").each(function(){var c=a.extend({},b,a(this).data()),d=f(this,c);a(this).data(t,d.id)})},a.fn.spectrum.load=!0,a.fn.spectrum.loadOpts={},a.fn.spectrum.draggable=k,a.fn.spectrum.defaults=m,a.spectrum={},a.spectrum.localization={},a.spectrum.palettes={},a.fn.spectrum.processNativeColorInputs=function(){q||a("input[type=color]").spectrum({preferredFormat:"hex6"})},function(){function a(a){var c={r:0,g:0,b:0},e=1,g=!1,h=!1;return"string"==typeof a&&(a=G(a)),"object"==typeof a&&(a.hasOwnProperty("r")&&a.hasOwnProperty("g")&&a.hasOwnProperty("b")?(c=b(a.r,a.g,a.b),g=!0,h="%"===String(a.r).substr(-1)?"prgb":"rgb"):a.hasOwnProperty("h")&&a.hasOwnProperty("s")&&a.hasOwnProperty("v")?(a.s=D(a.s),a.v=D(a.v),c=f(a.h,a.s,a.v),g=!0,h="hsv"):a.hasOwnProperty("h")&&a.hasOwnProperty("s")&&a.hasOwnProperty("l")&&(a.s=D(a.s),a.l=D(a.l),c=d(a.h,a.s,a.l),g=!0,h="hsl"),a.hasOwnProperty("a")&&(e=a.a)),e=w(e),{ok:g,format:a.format||h,r:M(255,N(c.r,0)),g:M(255,N(c.g,0)),b:M(255,N(c.b,0)),a:e}}function b(a,b,c){return{r:255*x(a,255),g:255*x(b,255),b:255*x(c,255)}}function c(a,b,c){a=x(a,255),b=x(b,255),c=x(c,255);var d,e,f=N(a,b,c),g=M(a,b,c),h=(f+g)/2;if(f==g)d=e=0;else{var i=f-g;switch(e=h>.5?i/(2-f-g):i/(f+g),f){case a:d=(b-c)/i+(c>b?6:0);break;case b:d=(c-a)/i+2;break;case c:d=(a-b)/i+4}d/=6}return{h:d,s:e,l:h}}function d(a,b,c){function d(a,b,c){return 0>c&&(c+=1),c>1&&(c-=1),1/6>c?a+6*(b-a)*c:.5>c?b:2/3>c?a+(b-a)*(2/3-c)*6:a}var e,f,g;if(a=x(a,360),b=x(b,100),c=x(c,100),0===b)e=f=g=c;else{var h=.5>c?c*(1+b):c+b-c*b,i=2*c-h;e=d(i,h,a+1/3),f=d(i,h,a),g=d(i,h,a-1/3)}return{r:255*e,g:255*f,b:255*g}}function e(a,b,c){a=x(a,255),b=x(b,255),c=x(c,255);var d,e,f=N(a,b,c),g=M(a,b,c),h=f,i=f-g;if(e=0===f?0:i/f,f==g)d=0;else{switch(f){case a:d=(b-c)/i+(c>b?6:0);break;case b:d=(c-a)/i+2;break;case c:d=(a-b)/i+4}d/=6}return{h:d,s:e,v:h}}function f(a,b,c){a=6*x(a,360),b=x(b,100),c=x(c,100);var d=K.floor(a),e=a-d,f=c*(1-b),g=c*(1-e*b),h=c*(1-(1-e)*b),i=d%6,j=[c,g,f,f,h,c][i],k=[h,c,c,g,f,f][i],l=[f,f,h,c,c,g][i];return{r:255*j,g:255*k,b:255*l}}function g(a,b,c,d){var e=[C(L(a).toString(16)),C(L(b).toString(16)),C(L(c).toString(16))];return d&&e[0].charAt(0)==e[0].charAt(1)&&e[1].charAt(0)==e[1].charAt(1)&&e[2].charAt(0)==e[2].charAt(1)?e[0].charAt(0)+e[1].charAt(0)+e[2].charAt(0):e.join("")}function h(a,b,c,d){var e=[C(E(d)),C(L(a).toString(16)),C(L(b).toString(16)),C(L(c).toString(16))];return e.join("")}function i(a,b){b=0===b?0:b||10;var c=P(a).toHsl();return c.s-=b/100,c.s=y(c.s),P(c)}function j(a,b){b=0===b?0:b||10;var c=P(a).toHsl();return c.s+=b/100,c.s=y(c.s),P(c)}function k(a){return P(a).desaturate(100)}function l(a,b){b=0===b?0:b||10;var c=P(a).toHsl();return c.l+=b/100,c.l=y(c.l),P(c)}function m(a,b){b=0===b?0:b||10;var c=P(a).toRgb();return c.r=N(0,M(255,c.r-L(255*-(b/100)))),c.g=N(0,M(255,c.g-L(255*-(b/100)))),c.b=N(0,M(255,c.b-L(255*-(b/100)))),P(c)}function n(a,b){b=0===b?0:b||10;var c=P(a).toHsl();return c.l-=b/100,c.l=y(c.l),P(c)}function o(a,b){var c=P(a).toHsl(),d=(L(c.h)+b)%360;return c.h=0>d?360+d:d,P(c)}function p(a){var b=P(a).toHsl();return b.h=(b.h+180)%360,P(b)}function q(a){var b=P(a).toHsl(),c=b.h;return[P(a),P({h:(c+120)%360,s:b.s,l:b.l}),P({h:(c+240)%360,s:b.s,l:b.l})]}function r(a){var b=P(a).toHsl(),c=b.h;return[P(a),P({h:(c+90)%360,s:b.s,l:b.l}),P({h:(c+180)%360,s:b.s,l:b.l}),P({h:(c+270)%360,s:b.s,l:b.l})]}function s(a){var b=P(a).toHsl(),c=b.h;return[P(a),P({h:(c+72)%360,s:b.s,l:b.l}),P({h:(c+216)%360,s:b.s,l:b.l})]}function t(a,b,c){b=b||6,c=c||30;var d=P(a).toHsl(),e=360/c,f=[P(a)];for(d.h=(d.h-(e*b>>1)+720)%360;--b;)d.h=(d.h+e)%360,f.push(P(d));return f}function u(a,b){b=b||6;for(var c=P(a).toHsv(),d=c.h,e=c.s,f=c.v,g=[],h=1/b;b--;)g.push(P({h:d,s:e,v:f})),f=(f+h)%1;return g}function v(a){var b={};for(var c in a)a.hasOwnProperty(c)&&(b[a[c]]=c);return b}function w(a){return a=parseFloat(a),(isNaN(a)||0>a||a>1)&&(a=1),a}function x(a,b){A(a)&&(a="100%");var c=B(a);return a=M(b,N(0,parseFloat(a))),c&&(a=parseInt(a*b,10)/100),K.abs(a-b)<1e-6?1:a%b/parseFloat(b)}function y(a){return M(1,N(0,a))}function z(a){return parseInt(a,16)}function A(a){return"string"==typeof a&&-1!=a.indexOf(".")&&1===parseFloat(a)}function B(a){return"string"==typeof a&&-1!=a.indexOf("%")}function C(a){return 1==a.length?"0"+a:""+a}function D(a){return 1>=a&&(a=100*a+"%"),a}function E(a){return Math.round(255*parseFloat(a)).toString(16)}function F(a){return z(a)/255}function G(a){a=a.replace(H,"").replace(I,"").toLowerCase();var b=!1;if(Q[a])a=Q[a],b=!0;else if("transparent"==a)return{r:0,g:0,b:0,a:0,format:"name"};var c;return(c=S.rgb.exec(a))?{r:c[1],g:c[2],b:c[3]}:(c=S.rgba.exec(a))?{r:c[1],g:c[2],b:c[3],a:c[4]}:(c=S.hsl.exec(a))?{h:c[1],s:c[2],l:c[3]}:(c=S.hsla.exec(a))?{h:c[1],s:c[2],l:c[3],a:c[4]}:(c=S.hsv.exec(a))?{h:c[1],s:c[2],v:c[3]}:(c=S.hsva.exec(a))?{h:c[1],s:c[2],v:c[3],a:c[4]}:(c=S.hex8.exec(a))?{a:F(c[1]),r:z(c[2]),g:z(c[3]),b:z(c[4]),format:b?"name":"hex8"}:(c=S.hex6.exec(a))?{r:z(c[1]),g:z(c[2]),b:z(c[3]),format:b?"name":"hex"}:(c=S.hex3.exec(a))?{r:z(c[1]+""+c[1]),g:z(c[2]+""+c[2]),b:z(c[3]+""+c[3]),format:b?"name":"hex"}:!1}var H=/^[\s,#]+/,I=/\s+$/,J=0,K=Math,L=K.round,M=K.min,N=K.max,O=K.random,P=function T(b,c){if(b=b?b:"",c=c||{},b instanceof T)return b;if(!(this instanceof T))return new T(b,c);var d=a(b);this._originalInput=b,this._r=d.r,this._g=d.g,this._b=d.b,this._a=d.a,this._roundA=L(100*this._a)/100,this._format=c.format||d.format,this._gradientType=c.gradientType,this._r<1&&(this._r=L(this._r)),this._g<1&&(this._g=L(this._g)),this._b<1&&(this._b=L(this._b)),this._ok=d.ok,this._tc_id=J++};P.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var a=this.toRgb();return(299*a.r+587*a.g+114*a.b)/1e3},setAlpha:function(a){return this._a=w(a),this._roundA=L(100*this._a)/100,this},toHsv:function(){var a=e(this._r,this._g,this._b);return{h:360*a.h,s:a.s,v:a.v,a:this._a}},toHsvString:function(){var a=e(this._r,this._g,this._b),b=L(360*a.h),c=L(100*a.s),d=L(100*a.v);return 1==this._a?"hsv("+b+", "+c+"%, "+d+"%)":"hsva("+b+", "+c+"%, "+d+"%, "+this._roundA+")"},toHsl:function(){var a=c(this._r,this._g,this._b);return{h:360*a.h,s:a.s,l:a.l,a:this._a}},toHslString:function(){var a=c(this._r,this._g,this._b),b=L(360*a.h),d=L(100*a.s),e=L(100*a.l);return 1==this._a?"hsl("+b+", "+d+"%, "+e+"%)":"hsla("+b+", "+d+"%, "+e+"%, "+this._roundA+")"},toHex:function(a){return g(this._r,this._g,this._b,a)},toHexString:function(a){return"#"+this.toHex(a)},toHex8:function(){return h(this._r,this._g,this._b,this._a)},toHex8String:function(){return"#"+this.toHex8()},toRgb:function(){return{r:L(this._r),g:L(this._g),b:L(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+L(this._r)+", "+L(this._g)+", "+L(this._b)+")":"rgba("+L(this._r)+", "+L(this._g)+", "+L(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:L(100*x(this._r,255))+"%",g:L(100*x(this._g,255))+"%",b:L(100*x(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+L(100*x(this._r,255))+"%, "+L(100*x(this._g,255))+"%, "+L(100*x(this._b,255))+"%)":"rgba("+L(100*x(this._r,255))+"%, "+L(100*x(this._g,255))+"%, "+L(100*x(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":this._a<1?!1:R[g(this._r,this._g,this._b,!0)]||!1},toFilter:function(a){var b="#"+h(this._r,this._g,this._b,this._a),c=b,d=this._gradientType?"GradientType = 1, ":"";if(a){var e=P(a);c=e.toHex8String()}return"progid:DXImageTransform.Microsoft.gradient("+d+"startColorstr="+b+",endColorstr="+c+")"},toString:function(a){var b=!!a;a=a||this._format;var c=!1,d=this._a<1&&this._a>=0,e=!b&&d&&("hex"===a||"hex6"===a||"hex3"===a||"name"===a);return e?"name"===a&&0===this._a?this.toName():this.toRgbString():("rgb"===a&&(c=this.toRgbString()),"prgb"===a&&(c=this.toPercentageRgbString()),("hex"===a||"hex6"===a)&&(c=this.toHexString()),"hex3"===a&&(c=this.toHexString(!0)),"hex8"===a&&(c=this.toHex8String()),"name"===a&&(c=this.toName()),"hsl"===a&&(c=this.toHslString()),"hsv"===a&&(c=this.toHsvString()),c||this.toHexString())},_applyModification:function(a,b){var c=a.apply(null,[this].concat([].slice.call(b)));return this._r=c._r,this._g=c._g,this._b=c._b,this.setAlpha(c._a),this},lighten:function(){return this._applyModification(l,arguments)},brighten:function(){return this._applyModification(m,arguments)},darken:function(){return this._applyModification(n,arguments)},desaturate:function(){return this._applyModification(i,arguments)},saturate:function(){return this._applyModification(j,arguments)},greyscale:function(){return this._applyModification(k,arguments)},spin:function(){return this._applyModification(o,arguments)},_applyCombination:function(a,b){return a.apply(null,[this].concat([].slice.call(b)))},analogous:function(){return this._applyCombination(t,arguments)},complement:function(){return this._applyCombination(p,arguments)},monochromatic:function(){return this._applyCombination(u,arguments)},splitcomplement:function(){return this._applyCombination(s,arguments)},triad:function(){return this._applyCombination(q,arguments)},tetrad:function(){return this._applyCombination(r,arguments)}},P.fromRatio=function(a,b){if("object"==typeof a){var c={};for(var d in a)a.hasOwnProperty(d)&&("a"===d?c[d]=a[d]:c[d]=D(a[d]));a=c}return P(a,b)},P.equals=function(a,b){return a&&b?P(a).toRgbString()==P(b).toRgbString():!1},P.random=function(){return P.fromRatio({r:O(),g:O(),b:O()})},P.mix=function(a,b,c){c=0===c?0:c||50;var d,e=P(a).toRgb(),f=P(b).toRgb(),g=c/100,h=2*g-1,i=f.a-e.a;d=h*i==-1?h:(h+i)/(1+h*i),d=(d+1)/2;var j=1-d,k={r:f.r*d+e.r*j,g:f.g*d+e.g*j,b:f.b*d+e.b*j,a:f.a*g+e.a*(1-g)};return P(k)},P.readability=function(a,b){var c=P(a),d=P(b),e=c.toRgb(),f=d.toRgb(),g=c.getBrightness(),h=d.getBrightness(),i=Math.max(e.r,f.r)-Math.min(e.r,f.r)+Math.max(e.g,f.g)-Math.min(e.g,f.g)+Math.max(e.b,f.b)-Math.min(e.b,f.b);return{brightness:Math.abs(g-h),color:i}},P.isReadable=function(a,b){var c=P.readability(a,b);return c.brightness>125&&c.color>500},P.mostReadable=function(a,b){for(var c=null,d=0,e=!1,f=0;f<b.length;f++){var g=P.readability(a,b[f]),h=g.brightness>125&&g.color>500,i=3*(g.brightness/125)+g.color/500;(h&&!e||h&&e&&i>d||!h&&!e&&i>d)&&(e=h,d=i,c=P(b[f]))}return c};var Q=P.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",
mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},R=P.hexNames=v(Q),S=function(){var a="[-\\+]?\\d+%?",b="[-\\+]?\\d*\\.\\d+%?",c="(?:"+b+")|(?:"+a+")",d="[\\s|\\(]+("+c+")[,|\\s]+("+c+")[,|\\s]+("+c+")\\s*\\)?",e="[\\s|\\(]+("+c+")[,|\\s]+("+c+")[,|\\s]+("+c+")[,|\\s]+("+c+")\\s*\\)?";return{rgb:new RegExp("rgb"+d),rgba:new RegExp("rgba"+e),hsl:new RegExp("hsl"+d),hsla:new RegExp("hsla"+e),hsv:new RegExp("hsv"+d),hsva:new RegExp("hsva"+e),hex3:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex8:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();window.tinycolor=P}(),a(function(){a.fn.spectrum.load&&a.fn.spectrum.processNativeColorInputs()})}),define("toast/libs/spectrum",function(){}),function(a){"function"==typeof define&&define.amd?define("toast/libs/Drager",a):a(jQuery)}(function(){"use strict";$.fn.drag=function(a,b,c){var d="string"==typeof a?a:"",e=$.isFunction(a)?a:$.isFunction(b)?b:null;return 0!==d.indexOf("drag")&&(d="drag"+d),c=(a==e?b:c)||{},e?this.bind(d,c,e):this.trigger(d)};var a=$.event,b=a.special,c=b.drag={defaults:{which:1,distance:0,not:":input",handle:null,relative:!1,drop:!1,click:!1},datakey:"dragdata",noBubble:!0,add:function(a){var b=$.data(this,c.datakey),d=a.data||{};b.related+=1,$.each(c.defaults,function(a,c){void 0!==d[a]&&(b[a]=d[a])})},remove:function(){$.data(this,c.datakey).related-=1},setup:function(){if(!$.data(this,c.datakey)){var b=$.extend({related:0},c.defaults);$.data(this,c.datakey,b),a.add(this,"touchstart mousedown",c.init,b),this.attachEvent&&this.attachEvent("ondragstart",c.dontstart)}},teardown:function(){var b=$.data(this,c.datakey)||{};b.related||($.removeData(this,c.datakey),a.remove(this,"touchstart mousedown",c.init),c.textselect(!0),this.detachEvent&&this.detachEvent("ondragstart",c.dontstart))},init:function(d){if(!c.touched){var e,f=d.data;if(!(0!=d.which&&f.which>0&&d.which!=f.which)&&!$(d.target).is(f.not)&&(!f.handle||$(d.target).closest(f.handle,d.currentTarget).length)&&(c.touched="touchstart"==d.type?this:null,f.propagates=1,f.mousedown=this,f.interactions=[c.interaction(this,f)],f.target=d.target,f.pageX=d.pageX,f.pageY=d.pageY,f.dragging=null,e=c.hijack(d,"draginit",f),f.propagates))return e=c.flatten(e),e&&e.length&&(f.interactions=[],$.each(e,function(){f.interactions.push(c.interaction(this,f))})),f.propagates=f.interactions.length,f.drop!==!1&&b.drop&&b.drop.handler(d,f),c.textselect(!1),c.touched?a.add(c.touched,"touchmove touchend",c.handler,f):a.add(document,"mousemove mouseup",c.handler,f),!c.touched||f.live?!1:void 0}},interaction:function(a,b){var d=$(a)[b.relative?"position":"offset"]()||{top:0,left:0};return{drag:a,callback:new c.callback,droppable:[],offset:d}},handler:function(d){var e=d.data;switch(d.type){case!e.dragging&&"touchmove":d.preventDefault();case!e.dragging&&"mousemove":if(Math.pow(d.pageX-e.pageX,2)+Math.pow(d.pageY-e.pageY,2)<Math.pow(e.distance,2))break;d.target=e.target,c.hijack(d,"dragstart",e),e.propagates&&(e.dragging=!0);case"touchmove":d.preventDefault();case"mousemove":if(e.dragging){if(c.hijack(d,"drag",e),e.propagates){e.drop!==!1&&b.drop&&b.drop.handler(d,e);break}d.type="mouseup"}case"touchend":case"mouseup":default:c.touched?a.remove(c.touched,"touchmove touchend",c.handler):a.remove(document,"mousemove mouseup",c.handler),e.dragging&&(e.drop!==!1&&b.drop&&b.drop.handler(d,e),c.hijack(d,"dragend",e)),c.textselect(!0),e.click===!1&&e.dragging&&$.data(e.mousedown,"suppress.click",(new Date).getTime()+5),e.dragging=c.touched=!1}},hijack:function(b,d,e,f,g){if(e){var h,i,j,k={event:b.originalEvent,type:b.type},l=d.indexOf("drop")?"drag":"drop",m=f||0,n=isNaN(f)?e.interactions.length:f;b.type=d,b.originalEvent=null,e.results=[];do if(i=e.interactions[m]){if("dragend"!==d&&i.cancelled)continue;j=c.properties(b,e,i),i.results=[],$(g||i[l]||e.droppable).each(function(f,g){return j.target=g,b.isPropagationStopped=function(){return!1},h=g?a.dispatch.call(g,b,j):null,h===!1?("drag"==l&&(i.cancelled=!0,e.propagates-=1),"drop"==d&&(i[l][f]=null)):"dropinit"==d&&i.droppable.push(c.element(h)||g),"dragstart"==d&&(i.proxy=$(c.element(h)||i.drag)[0]),i.results.push(h),delete b.result,"dropinit"!==d?h:void 0}),e.results[m]=c.flatten(i.results),"dropinit"==d&&(i.droppable=c.flatten(i.droppable)),"dragstart"!=d||i.cancelled||j.update()}while(++m<n);return b.type=k.type,b.originalEvent=k.event,c.flatten(e.results)}},properties:function(a,b,d){var e=d.callback;return e.drag=d.drag,e.proxy=d.proxy||d.drag,e.startX=b.pageX,e.startY=b.pageY,e.deltaX=a.pageX-b.pageX,e.deltaY=a.pageY-b.pageY,e.originalX=d.offset.left,e.originalY=d.offset.top,e.offsetX=e.originalX+e.deltaX,e.offsetY=e.originalY+e.deltaY,e.drop=c.flatten((d.drop||[]).slice()),e.available=c.flatten((d.droppable||[]).slice()),e},element:function(a){return a&&(a.jquery||1==a.nodeType)?a:void 0},flatten:function(a){return $.map(a,function(a){return a&&a.jquery?$.makeArray(a):a&&a.length?c.flatten(a):a})},textselect:function(a){$(document)[a?"unbind":"bind"]("selectstart",c.dontstart).css("MozUserSelect",a?"":"none"),document.unselectable=a?"off":"on"},dontstart:function(){return!1},callback:function(){}};c.callback.prototype={update:function(){b.drop&&this.available.length&&$.each(this.available,function(a){b.drop.locate(this,a)})}};var d=a.dispatch;a.dispatch=function(a){return $.data(this,"suppress."+a.type)-(new Date).getTime()>0?void $.removeData(this,"suppress."+a.type):d.apply(this,arguments)};var e=a.fixHooks.touchstart=a.fixHooks.touchmove=a.fixHooks.touchend=a.fixHooks.touchcancel={props:"clientX clientY pageX pageY screenX screenY".split(" "),filter:function(a,b){if(b){var c=b.touches&&b.touches[0]||b.changedTouches&&b.changedTouches[0]||null;c&&$.each(e.props,function(b,d){a[d]=c[d]})}return a}};b.draginit=b.dragstart=b.dragend=c}),function(a){"function"==typeof define&&define.amd?define("toast/libs/Drop",a):a(jQuery)}(function(){"use strict";$.fn.drop=function(a,b,c){var d="string"==typeof a?a:"",e=$.isFunction(a)?a:$.isFunction(b)?b:null;return 0!==d.indexOf("drop")&&(d="drop"+d),c=(a==e?b:c)||{},e?this.bind(d,c,e):this.trigger(d)},$.drop=function(a){a=a||{},c.multi=a.multi===!0?1/0:a.multi===!1?1:isNaN(a.multi)?c.multi:a.multi,c.delay=a.delay||c.delay,c.tolerance=$.isFunction(a.tolerance)?a.tolerance:null===a.tolerance?null:c.tolerance,c.mode=a.mode||c.mode||"intersect",a.page&&(c.page=a.page)};var a=$.event,b=a.special,c=$.event.special.drop={page:null,multi:1,delay:20,mode:"overlap",targets:[],datakey:"dropdata",noBubble:!0,add:function(a){var b=$.data(this,c.datakey);b.related+=1},remove:function(){$.data(this,c.datakey).related-=1},setup:function(){if(!$.data(this,c.datakey)){var a={related:0,active:[],anyactive:0,winner:0,location:{}};$.data(this,c.datakey,a),c.targets.push(this)}},teardown:function(){var a=$.data(this,c.datakey)||{};if(!a.related){$.removeData(this,c.datakey);var b=this;c.targets=$.grep(c.targets,function(a){return a!==b})}},handler:function(a,d){var e;if(d)switch(a.type){case"mousedown":case"touchstart":e=$(c.targets),"string"==typeof d.drop&&(e=e.filter(d.drop)),e.each(function(){var a=$.data(this,c.datakey);a.active=[],a.anyactive=0,a.winner=0}),d.droppable=e,b.drag.hijack(a,"dropinit",d);break;case"mousemove":case"touchmove":c.event=a,c.timer||c.tolerate(d);break;case"mouseup":case"touchend":c.timer=clearTimeout(c.timer),d.propagates&&(b.drag.hijack(a,"drop",d),b.drag.hijack(a,"dropend",d))}},locate:function(a,b){var d=$.data(a,c.datakey),e=$(a),f=e.offset()||{},g=e.outerHeight(),h=e.outerWidth(),i={elem:a,width:h,height:g,top:f.top,left:f.left,right:f.left+h,bottom:f.top+g};return d&&(d.location=i,d.index=b,d.elem=a),i},contains:function(a,b){return(b[0]||b.left)>=a.left&&(b[0]||b.right)<=a.right&&(b[1]||b.top)>=a.top&&(b[1]||b.bottom)<=a.bottom},modes:{intersect:function(a,b,c){return this.contains(c,[a.pageX,a.pageY])?1e9:this.modes.overlap.apply(this,arguments)},overlap:function(a,b,c){var b=$(b.elem)[0].getBoundingClientRect(),c=$(c.elem)[0].getBoundingClientRect();return!(b.top+b.height<c.top||b.top>c.top+c.height||b.left+b.width<c.left||b.left>c.left+c.width)},fit:function(a,b,c){return this.contains(c,b)?1:0},middle:function(a,b,c){return this.contains(c,[b.left+.5*b.width,b.top+.5*b.height])?1:0}},sort:function(a,b){return b.winner-a.winner||a.index-b.index},tolerate:function(a){var d,e,f,g,h,i,j,k,l=0,m=a.interactions.length,n=[c.event.pageX,c.event.pageY],o=c.tolerance||c.modes[c.mode];do if(k=a.interactions[l]){if(!k)return;k.drop=[],h=[],i=k.droppable.length,o&&(f=c.locate(k.proxy)),d=0;do if(j=k.droppable[d]){if(g=$.data(j,c.datakey),e=g.location,!e)continue;g.winner=o?o.call(c,c.event,f,e):c.contains(e,n)?1:0,h.push(g)}while(++d<i);h.sort(c.sort),d=0;do(g=h[d])&&(g.winner&&k.drop.length<c.multi?(g.active[l]||g.anyactive||(b.drag.hijack(c.event,"dropstart",a,l,g.elem)[0]!==!1?(g.active[l]=1,g.anyactive+=1):g.winner=0),g.winner&&k.drop.push(g.elem)):g.active[l]&&1==g.anyactive&&(b.drag.hijack(c.event,"dropend",a,l,g.elem),g.active[l]=0,g.anyactive-=1));while(++d<i)}while(++l<m);c.last&&n[0]==c.last.pageX&&n[1]==c.last.pageY?delete c.timer:c.timer=setTimeout(function(){c.tolerate(a)},c.delay),c.last=c.event}};b.dropinit=b.dropstart=b.dropend=c}),"undefined"==typeof gj&&(gj={}),gj.widget=function(){var a=this;a.xhr=null,a.generateGUID=function(){function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()},a.mouseX=function(a){if(a){if(tt.isMobile&&(a=a.originalEvent.touches[0]),a.pageX)return a.pageX;if(a.clientX)return a.clientX+(document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft)}return null},a.mouseY=function(a){if(a){if(tt.isMobile&&(a=a.originalEvent.touches[0]),a.pageY)return a.pageY;if(a.clientY)return a.clientY+(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop)}return null}},gj.widget.prototype.init=function(a,b){var c,d,e;d=$.extend(!0,{},this.getHTMLConfig()||{}),$.extend(!0,d,a||{}),e=this.getConfig(d,b),this.attr("data-guid",e.guid),this.data(e);for(c in e)gj[b].events.hasOwnProperty(c)&&(this.on(c,e[c]),delete e[c]);for(plugin in gj[b].plugins)gj[b].plugins.hasOwnProperty(plugin)&&gj[b].plugins[plugin].configure(this,e,d);return this},gj.widget.prototype.getConfig=function(a,b){var c,d,e;c=$.extend(!0,{},gj[b].config.base),d=a.uiLibrary||c.uiLibrary,gj[b].config[d]&&$.extend(!0,c,gj[b].config[d]);for(e in gj[b].plugins)gj[b].plugins.hasOwnProperty(e)&&($.extend(!0,c,gj[b].plugins[e].config.base),gj[b].plugins[e].config[d]&&$.extend(!0,c,gj[b].plugins[e].config[d]));return $.extend(!0,c,a),c.guid||(c.guid=this.generateGUID()),c},gj.widget.prototype.getHTMLConfig=function(){var a=this.data(),b=this[0].attributes;return b.width&&(a.width=b.width.nodeValue),b.height&&(a.height=b.height.nodeValue),b.align&&(a.align=b.align.nodeValue),a&&a.source&&(a.dataSource=a.source,delete a.source),a},gj.widget.prototype.createDoneHandler=function(){var a=this;return function(b){"string"==typeof b&&JSON&&(b=JSON.parse(b)),gj[a.data("type")].methods.render(a,b)}},gj.widget.prototype.createErrorHandler=function(){return function(a){a&&a.statusText&&"abort"!==a.statusText&&alert(a)}},gj.widget.prototype.reload=function(a){var b,c,d=this.data();return void 0===d.dataSource&&gj[this.data("type")].methods.useHtmlDataSource(this,d),$.extend(d.params,a),$.isArray(d.dataSource)?(c=gj[this.data("type")].methods.filter(this),gj[this.data("type")].methods.render(this,c)):"string"==typeof d.dataSource?(b={url:d.dataSource,data:d.params},this.xhr&&this.xhr.abort(),this.xhr=$.ajax(b).done(this.createDoneHandler()).fail(this.createErrorHandler())):"object"==typeof d.dataSource&&(d.dataSource.data||(d.dataSource.data={}),$.extend(d.dataSource.data,d.params),b=$.extend(!0,{},d.dataSource),"json"===b.dataType&&"object"==typeof b.data&&(b.data=JSON.stringify(b.data)),b.success||(b.success=this.createDoneHandler()),b.error||(b.error=this.createErrorHandler()),this.xhr&&this.xhr.abort(),this.xhr=$.ajax(b)),this},gj.documentManager={events:{},subscribeForEvent:function(a,b,c){if(gj.documentManager.events[a]&&0!==gj.documentManager.events[a].length){if(gj.documentManager.events[a][b])throw"Event "+a+" for widget with guid='"+b+"' is already attached.";gj.documentManager.events[a].push({widgetId:b,callback:c})}else gj.documentManager.events[a]=[{widgetId:b,callback:c}],$(document).on(a,gj.documentManager.executeCallbacks)},executeCallbacks:function(a){var b=gj.documentManager.events[a.type];if(b)for(var c=0;c<b.length;c++)b[c].callback(a)},unsubscribeForEvent:function(a,b){var c=!1,d=gj.documentManager.events[a];if(d){for(var e=0;e<d.length;e++)d[e].widgetId===b&&($(document).off(a,d[e].callback),d.splice(e,1),c=!0);0===d.length&&delete gj.documentManager.events[a]}if(!c)throw'The "'+a+'" for widget with guid="'+b+"\" can't be removed."}},"undefined"==typeof gj.dialog&&(gj.dialog={plugins:{},messages:[]}),gj.dialog.messages["en-us"]={Close:"Close",DefaultTitle:"Dialog"},gj.dialog.config={base:{autoOpen:!0,closeOnEscape:!0,closeButtonInHeader:!0,draggable:!0,height:"auto",locale:"en-us",minHeight:void 0,maxHeight:void 0,width:300,minWidth:void 0,maxWidth:void 0,modal:!1,resizable:!1,title:void 0,uiLibrary:void 0,style:{modal:"gj-modal",content:"gj-content",header:"gj-header",headerTitle:"gj-title gj-unselectable",headerCloseButton:"gj-close",body:"gj-body",footer:"gj-dialog-footer gj-footer"}},bootstrap:{style:{modal:"modal",content:"modal-content",header:"modal-header",headerTitle:"modal-title",headerCloseButton:"close",body:"modal-body",footer:"gj-dialog-footer modal-footer"}},jqueryui:{style:{modal:"gj-modal",content:"ui-widget ui-widget-content gj-dialog-content",header:"gj-dialog-ui-header ui-widget-header",headerTitle:"gj-dialog-ui-title",headerCloseButton:"gj-dialog-ui-close ui-button ui-widget ui-state-default ui-corner-all",body:"gj-dialog-ui-body",footer:"gj-dialog-footer"}},foundation:{style:{modal:"reveal-modal-bg",content:"reveal-modal gj-dialog-fd-content",header:"",headerTitle:"gj-dialog-fd-title gj-unselectable",headerCloseButton:"close-reveal-modal right gj-dialog-fd-close",body:"gj-dialog-fd-body",footer:"gj-dialog-footer gj-dialog-fd-footer"}},materialdesign:{style:{modal:"gj-modal",content:"mdl-dialog gj-dialog-mdl-content",header:"",headerTitle:"mdl-dialog__title gj-unselectable",headerCloseButton:"gj-dialog-mdl-close",body:"mdl-dialog__content",footer:"gj-dialog-footer"}}},gj.dialog.events={initialized:function(a){a.trigger("initialized")},opening:function(a){a.trigger("opening")},opened:function(a){a.trigger("opened")},closing:function(a){a.trigger("closing")},closed:function(a){a.trigger("closed")},drag:function(a){a.trigger("drag")},dragStart:function(a){a.trigger("dragStart")},dragStop:function(a){a.trigger("dragStop")},resize:function(a){a.trigger("resize")},resizeStart:function(a){a.trigger("resizeStart")},resizeStop:function(a){a.trigger("resizeStop")}},gj.dialog.methods={init:function(a){return this.attr("data-type","dialog"),gj.widget.prototype.init.call(this,a,"dialog"),gj.dialog.methods.localization(this),gj.dialog.methods.initialize(this),gj.dialog.events.initialized(this),this},localization:function(a){var b=a.data();"undefined"==typeof b.title&&(b.title=gj.dialog.messages[b.locale].DefaultTitle)},getHTMLConfig:function(){var a=gj.widget.prototype.getHTMLConfig.call(this),b=this[0].attributes;return b.title&&(a.title=b.title.nodeValue),a},initialize:function(a){var b,c,d=a.data();a.addClass(d.style.content),gj.dialog.methods.setSize(a),d.closeOnEscape&&$(document).keyup(function(b){27===b.keyCode&&a.close()}),c=a.children('div[data-role="body"]'),0===c.length?(c=$('<div data-role="body"/>').addClass(d.style.body),a.wrapInner(c)):c.addClass(d.style.body),b=gj.dialog.methods.renderHeader(a),a.children('div[data-role="footer"]').addClass(d.style.footer),a.find('[data-role="close"]').on("click",function(){a.close()}),d.draggable&&$.fn.draggable&&gj.dialog.methods.draggable(a,b),d.resizable&&$.fn.draggable&&gj.dialog.methods.resizable(a),gj.dialog.methods.setPosition(a),d.modal&&a.wrapAll('<div data-role="modal" class="'+d.style.modal+'"/>'),d.autoOpen&&a.open()},setSize:function(a){var b=a.data();b.width&&a.css("width",b.width),b.height&&a.css("height",b.height)},renderHeader:function(a){var b,c,d,e=a.data();return b=a.children('div[data-role="header"]'),0===b.length&&(b=$('<div data-role="header" />'),a.prepend(b)),b.addClass(e.style.header),c=b.find('[data-role="title"]'),0===c.length&&(c=$('<h4 data-role="title">'+e.title+"</h4>"),b.append(c)),c.addClass(e.style.headerTitle),d=b.find('[data-role="close"]'),0===d.length&&e.closeButtonInHeader?(d=$('<button type="button" data-role="close" title="'+gj.dialog.messages[e.locale].Close+'"><span>×</span></button>'),d.addClass(e.style.headerCloseButton),b.prepend(d)):d.length>0&&e.closeButtonInHeader===!1&&d.hide(),b},setPosition:function(a){var b=$(window).width()/2-a.width()/2,c=$(window).height()/2-a.height()/2;a.css("position","absolute"),a.css("left",b>0?b:0),a.css("top",c>0?c:0)},draggable:function(a,b){a.appendTo("body"),b.addClass("gj-draggable"),a.draggable({handle:b,start:function(){a.addClass("gj-unselectable"),gj.dialog.events.dragStart(a)},stop:function(){a.removeClass("gj-unselectable"),gj.dialog.events.dragStop(a)}})},resizable:function(a){var b={drag:gj.dialog.methods.resize,start:function(){a.addClass("gj-unselectable"),gj.dialog.events.resizeStart(a)},stop:function(){this.removeAttribute("style"),a.removeClass("gj-unselectable"),gj.dialog.events.resizeStop(a)}};a.append($('<div class="gj-resizable-handle gj-resizable-n"></div>').draggable($.extend(!0,{horizontal:!1},b))),a.append($('<div class="gj-resizable-handle gj-resizable-e"></div>').draggable($.extend(!0,{vertical:!1},b))),a.append($('<div class="gj-resizable-handle gj-resizable-s"></div>').draggable($.extend(!0,{horizontal:!1},b))),a.append($('<div class="gj-resizable-handle gj-resizable-w"></div>').draggable($.extend(!0,{vertical:!1},b))),a.append($('<div class="gj-resizable-handle gj-resizable-ne"></div>').draggable($.extend(!0,{},b))),a.append($('<div class="gj-resizable-handle gj-resizable-nw"></div>').draggable($.extend(!0,{},b))),a.append($('<div class="gj-resizable-handle gj-resizable-sw"></div>').draggable($.extend(!0,{},b))),a.append($('<div class="gj-resizable-handle gj-resizable-se"></div>').draggable($.extend(!0,{},b)))},resize:function(a,b){var c,d,e,f,g,h,i,j=!1;return c=$(this),d=c.parent(),e=d.data(),c.hasClass("gj-resizable-n")?(f=d.height()-b.top,h=d.offset().top+b.top):c.hasClass("gj-resizable-e")?g=d.width()+b.left:c.hasClass("gj-resizable-s")?f=d.height()+b.top:c.hasClass("gj-resizable-w")?(g=d.width()-b.left,i=d.offset().left+b.left):c.hasClass("gj-resizable-ne")?(f=d.height()-b.top,h=d.offset().top+b.top,g=d.width()+b.left):c.hasClass("gj-resizable-nw")?(f=d.height()-b.top,h=d.offset().top+b.top,g=d.width()-b.left,i=d.offset().left+b.left):c.hasClass("gj-resizable-se")?(f=d.height()+b.top,g=d.width()+b.left):c.hasClass("gj-resizable-sw")&&(f=d.height()+b.top,g=d.width()-b.left,i=d.offset().left+b.left),f&&(!e.minHeight||f>=e.minHeight)&&(!e.maxHeight||f<=e.maxHeight)&&(d.height(f),h&&d.css("top",h),j=!0),g&&(!e.minWidth||g>=e.minWidth)&&(!e.maxWidth||g<=e.maxWidth)&&(d.width(g),i&&d.css("left",i),j=!0),j&&gj.dialog.events.resize(d),!1},open:function(a){var b;return gj.dialog.events.opening(a),a.css("display","block"),a.closest('div[data-role="modal"]').css("display","block"),b=a.children('div[data-role="footer"]'),b.length&&b.outerHeight()&&a.children('div[data-role="body"]').css("margin-bottom",b.outerHeight()),gj.dialog.events.opened(a),a},close:function(a){return a.is(":visible")&&(gj.dialog.events.closing(a),a.css("display","none"),a.closest('div[data-role="modal"]').css("display","none"),gj.dialog.events.closed(a)),a},isOpen:function(a){return a.is(":visible")}},gj.dialog.widget=function(a,b){var c=this,d=gj.dialog.methods;return c.open=function(){return d.open(this)},c.close=function(){return d.close(this)},c.isOpen=function(){return d.isOpen(this)},$.extend(a,c),"dialog"!==a.attr("data-type")&&d.init.apply(a,b),a},gj.dialog.widget.prototype=new gj.widget,gj.dialog.widget.constructor=gj.dialog.widget,gj.dialog.widget.prototype.getHTMLConfig=gj.dialog.methods.getHTMLConfig,function(a){a.fn.dialog=function(a){var b;if(this&&this.length){if("object"!=typeof a&&a){if(b=new gj.dialog.widget(this,null),b[a])return b[a].apply(this,Array.prototype.slice.call(arguments,1));throw"Method "+a+" does not exist."}return new gj.dialog.widget(this,arguments)}}}(jQuery),define("toast/libs/dialog",function(){}),"undefined"==typeof gj&&(gj={}),gj.widget=function(){var a=this;a.xhr=null,a.generateGUID=function(){function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()},a.mouseX=function(a){if(a){if(tt.isMobile&&(a=a.originalEvent.touches[0]),a.pageX)return a.pageX;if(a.clientX)return a.clientX+(document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft)}return null},a.mouseY=function(a){if(a){if(tt.isMobile&&(a=a.originalEvent.touches[0]),a.pageY)return a.pageY;if(a.clientY)return a.clientY+(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop)}return null}},gj.widget.prototype.init=function(a,b){var c,d,e;d=$.extend(!0,{},this.getHTMLConfig()||{}),$.extend(!0,d,a||{}),e=this.getConfig(d,b),this.attr("data-guid",e.guid),this.data(e);for(c in e)gj[b].events.hasOwnProperty(c)&&(this.on(c,e[c]),delete e[c]);for(plugin in gj[b].plugins)gj[b].plugins.hasOwnProperty(plugin)&&gj[b].plugins[plugin].configure(this,e,d);return this},gj.widget.prototype.getConfig=function(a,b){var c,d,e;c=$.extend(!0,{},gj[b].config.base),d=a.uiLibrary||c.uiLibrary,gj[b].config[d]&&$.extend(!0,c,gj[b].config[d]);for(e in gj[b].plugins)gj[b].plugins.hasOwnProperty(e)&&($.extend(!0,c,gj[b].plugins[e].config.base),gj[b].plugins[e].config[d]&&$.extend(!0,c,gj[b].plugins[e].config[d]));return $.extend(!0,c,a),c.guid||(c.guid=this.generateGUID()),c},gj.widget.prototype.getHTMLConfig=function(){var a=this.data(),b=this[0].attributes;return b.width&&(a.width=b.width.nodeValue),b.height&&(a.height=b.height.nodeValue),b.align&&(a.align=b.align.nodeValue),a&&a.source&&(a.dataSource=a.source,delete a.source),a},gj.widget.prototype.createDoneHandler=function(){var a=this;return function(b){"string"==typeof b&&JSON&&(b=JSON.parse(b)),gj[a.data("type")].methods.render(a,b)}},gj.widget.prototype.createErrorHandler=function(){return function(a){a&&a.statusText&&"abort"!==a.statusText&&alert(a)}},gj.widget.prototype.reload=function(a){var b,c,d=this.data();return void 0===d.dataSource&&gj[this.data("type")].methods.useHtmlDataSource(this,d),$.extend(d.params,a),$.isArray(d.dataSource)?(c=gj[this.data("type")].methods.filter(this),gj[this.data("type")].methods.render(this,c)):"string"==typeof d.dataSource?(b={url:d.dataSource,data:d.params},this.xhr&&this.xhr.abort(),this.xhr=$.ajax(b).done(this.createDoneHandler()).fail(this.createErrorHandler())):"object"==typeof d.dataSource&&(d.dataSource.data||(d.dataSource.data={}),$.extend(d.dataSource.data,d.params),b=$.extend(!0,{},d.dataSource),"json"===b.dataType&&"object"==typeof b.data&&(b.data=JSON.stringify(b.data)),b.success||(b.success=this.createDoneHandler()),b.error||(b.error=this.createErrorHandler()),this.xhr&&this.xhr.abort(),this.xhr=$.ajax(b)),this},gj.documentManager={events:{},subscribeForEvent:function(a,b,c){if(gj.documentManager.events[a]&&0!==gj.documentManager.events[a].length){if(gj.documentManager.events[a][b])throw"Event "+a+" for widget with guid='"+b+"' is already attached.";gj.documentManager.events[a].push({widgetId:b,callback:c})}else gj.documentManager.events[a]=[{widgetId:b,callback:c}],$(document).on(a,gj.documentManager.executeCallbacks)},executeCallbacks:function(a){var b=gj.documentManager.events[a.type];if(b)for(var c=0;c<b.length;c++)b[c].callback(a)},unsubscribeForEvent:function(a,b){var c=!1,d=gj.documentManager.events[a];if(d){for(var e=0;e<d.length;e++)d[e].widgetId===b&&($(document).off(a,d[e].callback),d.splice(e,1),c=!0);0===d.length&&delete gj.documentManager.events[a]}if(!c)throw'The "'+a+'" for widget with guid="'+b+"\" can't be removed."}},"undefined"==typeof gj.draggable&&(gj.draggable={}),gj.draggable.config={base:{handle:void 0,vertical:!0,horizontal:!0}},gj.draggable.methods={init:function(a){var b,c=this;return gj.widget.prototype.init.call(this,a,"draggable"),c.attr("data-draggable","true"),b=gj.draggable.methods.getHandleElement(c),b.on(gj.draggable.events.types.start,function(a){$(a.target).hasClass(".close")||0!==$(a.target).parents(".close").length||(a.originalEvent.preventDefault(),c.attr("data-draggable-dragging",!0),c.removeAttr("data-draggable-x"),c.removeAttr("data-draggable-y"),c.css("position","absolute"))}),gj.documentManager.subscribeForEvent(gj.draggable.events.types.move,c.data("guid"),gj.draggable.methods.createMouseMoveHandler(c)),gj.documentManager.subscribeForEvent(gj.draggable.events.types.end,c.data("guid"),gj.draggable.methods.createMouseUpHandler(c)),c},getHandleElement:function(a){var b=a.data("handle");return b&&b.length?b:a},createMouseUpHandler:function(a){return function(b){"true"===a.attr("data-draggable-dragging")&&(a.attr("data-draggable-dragging",!1),gj.draggable.events.stop(a,{left:a.mouseX(b),top:a.mouseY(b)}))}},createMouseMoveHandler:function(a){return function(b){var c,d,e,f,g,h;"true"===a.attr("data-draggable-dragging")&&(c=a.mouseX(b),d=a.mouseY(b),g=a.attr("data-draggable-x"),h=a.attr("data-draggable-y"),g&&h?(e=a.data("horizontal")?c-parseInt(g,10):0,f=a.data("vertical")?d-parseInt(h,10):0,!1!==gj.draggable.events.drag(a,e,f,c,d)&&gj.draggable.methods.move(a,e,f)):gj.draggable.events.start(a),a.attr("data-draggable-x",c),a.attr("data-draggable-y",d))}},move:function(a,b,c){var d=a.get(0),e=d.style.top?parseInt(d.style.top):a.position().top,f=d.style.left?parseInt(d.style.left):a.position().left;d.style.top=e+c+"px",d.style.left=f+b+"px"},destroy:function(a){return"true"===a.attr("data-draggable")&&(gj.documentManager.unsubscribeForEvent(gj.draggable.events.types.end,a.data("guid")),gj.documentManager.unsubscribeForEvent(gj.draggable.events.types.move,a.data("guid")),a.removeData(),a.removeAttr("data-guid"),a.removeAttr("data-draggable"),a.off("drag").off("start").off("stop"),gj.draggable.methods.getHandleElement(a).off(gj.draggable.events.types.start)),a}},gj.draggable.events={types:"ontouchstart"in window?{start:"touchstart",move:"touchmove",end:"touchend"}:{start:"mousedown",move:"mousemove",end:"mouseup"},drag:function(a,b,c,d,e){return a.triggerHandler("drag",[{top:c,left:b},{top:e,left:d}])},start:function(a){a.triggerHandler("start")},stop:function(a,b){a.triggerHandler("stop",[b])}},gj.draggable.widget=function(a,b){var c=this,d=gj.draggable.methods;return c.destroy=function(){return d.destroy(this)},$.extend(a,c),"true"!==a.attr("data-draggable")&&d.init.apply(a,b),a},gj.draggable.widget.prototype=new gj.widget,gj.draggable.widget.constructor=gj.draggable.widget,function(a){a.fn.draggable=function(a){var b;if(this&&this.length){if("object"!=typeof a&&a){if(b=new gj.draggable.widget(this,null),b[a])return b[a].apply(this,Array.prototype.slice.call(arguments,1));throw"Method "+a+" does not exist."}return new gj.draggable.widget(this,arguments)}}}(jQuery),define("toast/libs/draggable",function(){}),function(a,b){"object"==typeof exports?module.exports=b():"function"==typeof define&&define.amd?define("toast/libs/Sketchpad",b):a.Spinner=b()}(this,function(){function a(a){for(var b in this.constructor.prototype)this[b]=this[b].bind(this);a.hasOwnProperty("element")&&("string"==typeof a.element?this.element=$(a.element):this.element=a.element,this.penModes={draw:0,eraser:1},this._width=a.width||this.element.attr("data-width")||0,this._height=a.height||this.element.attr("data-height")||0,this.color=a.color||this.element.attr("data-color")||"#000000",this.penSize=a.penSize||this.element.attr("data-penSize")||5,this.penMode=a.penMode||this.element.attr("data-penMode")||this.penModes.draw,this.scale=1,this.readOnly=a.readOnly||this.element.attr("data-readOnly")||!1,this.readOnly||this.element.css({cursor:"crosshair"}),this.strokes=a.strokes||[],this._currentStroke={color:null,size:null,lines:[]},this.undoHistory=a.undoHistory||[],this.animateIds=[],this._sketching=!1,this.reset())}return a.prototype._cursorPosition=function(a){return{x:(a.pageX-$(this.canvas).offset().left)/this.scale,y:(a.pageY-$(this.canvas).offset().top)/this.scale}},a.prototype._draw=function(a,b,c,d){this._stroke(a,b,c,d,"source-over")},a.prototype._erase=function(a,b,c,d){this._stroke(a,b,c,d,"destination-out")},a.prototype._stroke=function(a,b,c,d,e){this.context.save(),this.context.lineJoin="round",this.context.lineCap="round",this.context.strokeStyle=c,this.context.lineWidth=d,this.context.globalCompositeOperation=e,this.context.beginPath(),this.context.moveTo(a.x,a.y),this.context.lineTo(b.x,b.y),this.context.closePath(),this.context.stroke(),this.context.restore()},a.prototype._mouseDown=function(a){this._lastPosition=this._cursorPosition(a),this._currentStroke.color=this.color,this._currentStroke.size=this.penSize,this._currentStroke.lines=[],this._sketching=!0,document.addEventListener("mousemove",this._mouseMove)},a.prototype._mouseUp=function(a){this._sketching&&(this.strokes.push($.extend(!0,{},this._currentStroke)),this._sketching=!1),document.removeEventListener("mousemove",this._mouseMove)},a.prototype._mouseMove=function(a){var b=this._cursorPosition(a);this.penMode===this.penModes.draw?this._draw(this._lastPosition,b,this.color,this.penSize):this._erase(this._lastPosition,b,this.color,this.penSize),this._currentStroke.lines.push({start:$.extend(!0,{},this._lastPosition),end:$.extend(!0,{},b)}),this._lastPosition=b},a.prototype._touchStart=function(a){this._sketching||(a.preventDefault(),this._lastPosition=this._cursorPosition(a.changedTouches[0]),this._currentStroke.color=this.color,this._currentStroke.size=this.penSize,this._currentStroke.lines=[],this._sketching=!0,document.addEventListener("touchmove",this._touchMove,!1),TT.$el.addClass("drawing"))},a.prototype._touchEnd=function(a){this._sketching&&(a.preventDefault(),this.strokes.push($.extend(!0,{},this._currentStroke)),this._sketching=!1),document.removeEventListener("touchmove",this._touchMove),TT.$el.removeClass("drawing")},a.prototype._touchCancel=function(a){this._sketching&&(a.preventDefault(),this.strokes.push($.extend(!0,{},this._currentStroke)),this._sketching=!1),document.removeEventListener("touchmove",this._touchMove),TT.$el.removeClass("drawing")},a.prototype._touchLeave=function(a){a.preventDefault(),this._sketching&&(this.strokes.push($.extend(!0,{},this._currentStroke)),
this._sketching=!1),document.removeEventListener("touchmove",this._touchMove),TT.$el.removeClass("drawing")},a.prototype._touchMove=function(a){a.preventDefault();var b=this._cursorPosition(a.changedTouches[0]);this.penMode===this.penModes.draw?this._draw(this._lastPosition,b,this.color,this.penSize):this._erase(this._lastPosition,b,this.color,this.penSize),this._currentStroke.lines.push({start:$.extend(!0,{},this._lastPosition),end:$.extend(!0,{},b)}),this._lastPosition=b},a.prototype.reset=function(){this.canvas=this.element[0],this.canvas.width=this._width,this.canvas.height=this._height,this.context=this.canvas.getContext("2d"),this.redraw(this.strokes),this.readOnly||(this.canvas.addEventListener("mousedown",this._mouseDown),document.addEventListener("mouseup",this._mouseUp),this.canvas.addEventListener("touchstart",this._touchStart),document.addEventListener("touchend",this._touchEnd))},a.prototype.drawStroke=function(a){for(var b=0;b<a.lines.length;b++){var c=a.lines[b];this._draw(c.start,c.end,a.color,a.size)}},a.prototype.redraw=function(a){for(var b=0;b<a.length;b++)this.drawStroke(a[b])},a.prototype.toObject=function(){return{width:this.canvas.width,height:this.canvas.height,strokes:this.strokes,undoHistory:this.undoHistory}},a.prototype.toJSON=function(){return JSON.stringify(this.toObject())},a.prototype.animate=function(a,b,c){this.clear();for(var d=a,e=null,f=0;f<this.strokes.length;f++)for(var g=this.strokes[f],h=0;h<g.lines.length;h++){var i=g.lines[h];e=this._draw.bind(this,i.start,i.end,g.color,g.size),this.animateIds.push(setTimeout(e,d)),d+=a}b&&(c=c||0,e=this.animate.bind(this,a,b,c),this.animateIds.push(setTimeout(e,d+c)))},a.prototype.cancelAnimation=function(){for(var a=0;a<this.animateIds.length;a++)clearTimeout(this.animateIds[a])},a.prototype.clear=function(){this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},a.prototype.undo=function(){this.clear();var a=this.strokes.pop();a&&(this.undoHistory.push(a),this.redraw(this.strokes))},a.prototype.redo=function(){var a=this.undoHistory.pop();a&&(this.strokes.push(a),this.drawStroke(a))},a}),define("toast/libs",["./core","./libs/hammer","./libs/Spinner","./libs/ImageViewer","./libs/spectrum","./libs/Drager","./libs/Drop","./libs/dialog","./libs/draggable","./libs/Sketchpad"],function(a,b,c,d){a.Hammer=b,a.Spinner=c,a.ImageViewer=d}),define("toast/events/KeyEvent",{DOM_VK_CANCEL:3,DOM_VK_HELP:6,DOM_VK_BACK_SPACE:8,DOM_VK_TAB:9,DOM_VK_CLEAR:12,DOM_VK_RETURN:13,DOM_VK_ENTER:14,DOM_VK_SHIFT:16,DOM_VK_CONTROL:17,DOM_VK_ALT:18,DOM_VK_PAUSE:19,DOM_VK_CAPS_LOCK:20,DOM_VK_ESCAPE:27,DOM_VK_SPACE:32,DOM_VK_PAGE_UP:33,DOM_VK_PAGE_DOWN:34,DOM_VK_END:35,DOM_VK_HOME:36,DOM_VK_LEFT:37,DOM_VK_UP:38,DOM_VK_RIGHT:39,DOM_VK_DOWN:40,DOM_VK_PRINTSCREEN:44,DOM_VK_INSERT:45,DOM_VK_DELETE:46,DOM_VK_0:48,DOM_VK_1:49,DOM_VK_2:50,DOM_VK_3:51,DOM_VK_4:52,DOM_VK_5:53,DOM_VK_6:54,DOM_VK_7:55,DOM_VK_8:56,DOM_VK_9:57,DOM_VK_A:65,DOM_VK_B:66,DOM_VK_C:67,DOM_VK_D:68,DOM_VK_E:69,DOM_VK_F:70,DOM_VK_G:71,DOM_VK_H:72,DOM_VK_I:73,DOM_VK_J:74,DOM_VK_K:75,DOM_VK_L:76,DOM_VK_M:77,DOM_VK_N:78,DOM_VK_O:79,DOM_VK_P:80,DOM_VK_Q:81,DOM_VK_R:82,DOM_VK_S:83,DOM_VK_T:84,DOM_VK_U:85,DOM_VK_V:86,DOM_VK_W:87,DOM_VK_X:88,DOM_VK_Y:89,DOM_VK_Z:90,DOM_VK_CONTEXT_MENU:93,DOM_VK_NUMPAD0:96,DOM_VK_NUMPAD1:97,DOM_VK_NUMPAD2:98,DOM_VK_NUMPAD3:99,DOM_VK_NUMPAD4:100,DOM_VK_NUMPAD5:101,DOM_VK_NUMPAD6:102,DOM_VK_NUMPAD7:103,DOM_VK_NUMPAD8:104,DOM_VK_NUMPAD9:105,DOM_VK_MULTIPLY:106,DOM_VK_ADD:107,DOM_VK_SEPARATOR:108,DOM_VK_SUBTRACT:109,DOM_VK_DECIMAL:110,DOM_VK_DIVIDE:111,DOM_VK_F1:112,DOM_VK_F2:113,DOM_VK_F3:114,DOM_VK_F4:115,DOM_VK_F5:116,DOM_VK_F6:117,DOM_VK_F7:118,DOM_VK_F8:119,DOM_VK_F9:120,DOM_VK_F10:121,DOM_VK_F11:122,DOM_VK_F12:123,DOM_VK_F13:124,DOM_VK_F14:125,DOM_VK_F15:126,DOM_VK_F16:127,DOM_VK_F17:128,DOM_VK_F18:129,DOM_VK_F19:130,DOM_VK_F20:131,DOM_VK_F21:132,DOM_VK_F22:133,DOM_VK_F23:134,DOM_VK_F24:135,DOM_VK_NUM_LOCK:144,DOM_VK_SCROLL_LOCK:145,DOM_VK_SEMICOLON:186,DOM_VK_EQUALS:187,DOM_VK_COMMA:188,DOM_VK_DASH:189,DOM_VK_PERIOD:190,DOM_VK_SLASH:191,DOM_VK_BACK_QUOTE:192,DOM_VK_OPEN_BRACKET:219,DOM_VK_BACK_SLASH:220,DOM_VK_CLOSE_BRACKET:221,DOM_VK_QUOTE:222,DOM_VK_META:224}),define("toast/events/Events",["exports","../core"],function(a,b){"use strict";a.PROJECT_DID_LOAD="tt_projectDidLoad",a.READY_BOOK="tt_bookReady",a.BOOK_READY="tt_bookReady",a.BOOK_HTML_READY="tt_bookHtmlReady",a.LOAD_PAGE="tt_loadPage",a.PAGE_DID_LOAD="tt_pageDidLoad",a.UNLOAD_PAGE="tt_unloadPage",a.PAGE_DID_UNLOAD="tt_pageDidUnLoad",a.WILL_MOVE_PAGE="tt_willMovePage",a.PAGE_DID_CHANGE="tt_pageDidChange",a.BEFORE_SHOW_DROPDOWN_MENU="tt_beforeShowDropdownMenu",a.MEMO_DID_CHANGE="tt_memoDidChange",a.SLIDE_DID_LOAD_COMPLETE="tt_slideDidLoadComplete",a.BOOKMARK_DID_CHANGE="tt_bookmarkDidChanged",a.ZOOM_MODE_DID_CHANGE="tt_zoomModeDidChanged",a.ZOOM_SCALE_DID_CHANGE="tt_zoomScaleDidChanged",a.PARTIAL_ZOOM_SCALE_DID_CHANGE="tt_partialZoomScaleDidChanged",a.THEME_DID_LOAD="tt_themeDidLoad",a.THEME_DID_UNLOAD="tt_themeDidUnload",a.BEGIN_SEARCH_MODE="tt_beginSearchMode",a.END_SEARCH_MODE="tt_endSearchMode",a.AUTOSLIDE_DID_RESUME="tt_autoSlideDidResume",a.AUTOSLIDE_DID_PAUSE="tt_autoSlideDidPause",a.ORIENTATION_DID_CHANGE="tt_orientationDidChange",a.START_MENU_DID_LOAD="tt_startmenuDidLoad",a.READY_AUTOPLAY_FOR_MOBILE="tt_readyAutoplayForMobile",a.DOUBLEPAGE_DID_CHANGE="tt_doublePageDidChange",a.START_PAGE_TRANSITIONS="tt_startPageTransitions",a.STOP_ALL_SOUND="tt_stopAllSound",a.CONTENT_SCALE_DID_CHANGE="tt_contentScaleDidChange",a.IMAGEVIEWER_SHOW="tt_imageViewerShow",a.IMAGEVIEWER_SHOWN="tt_imageViewerShown",a.IMAGEVIEWER_VIEWED="tt_imageViewerViewed",a.IMAGEVIEWER_RESET="tt_imageViewerReset",a.IMAGEVIEWER_RESIZED="tt_imageViewerResized",a.IMAGEVIEWER_HIDE="tt_imageViewerHide",a.IMAGEVIEWER_HIDDEN="tt_imageViewerHidden",a.IMAGEVIEWER_ZOOM_TO="tt_imageViewerZoomTo",b.Events=_.extend({},b.Events,a)}),define("toast/events/EventDispatcher",["exports","../core"],function(a,b){"use strict";function c(a){var b=a.indexOf(".");return-1===b?{eventName:a}:{eventName:a.substring(0,b),ns:a.substring(b)}}function d(a){$.extend(a,{on:h,off:i,one:j,trigger:k,_EventDispatcher:!0})}function e(a,b,c){var d=[b].concat(c);a.trigger.apply(a,d)}function f(a,b,c){h.call(a,b,c)}function g(a,b,c){a._deprecatedEvents||(a._deprecatedEvents={}),a._deprecatedEvents[b]=c||!0}var h=function(a,b){var d,e=a.split(/\s+/).map(c);if(this._deprecatedEvents)for(d=0;d<e.length;d++){var f=this._deprecatedEvents[e[d].eventName];if(f){var g="Registering for deprecated event '"+e[d].eventName+"'.";"string"==typeof f&&(g+=" Instead, use "+f+".")}}for(d=0;d<e.length;d++){var h=e[d].eventName;this._eventHandlers||(this._eventHandlers={}),this._eventHandlers[h]||(this._eventHandlers[h]=[]),e[d].handler=b,this._eventHandlers[h].push(e[d])}return this},i=function(a,b){if(!this._eventHandlers)return this;var d,e=a.split(/\s+/).map(c),f=function(a,c){var d,e=this._eventHandlers[c];if(e){for(d=e.length-1;d>=0;d--)if(!a.ns||a.ns===e[d].ns){var f=e[d].handler;b&&b!==f&&b._eventOnceWrapper!==f||e.splice(d,1)}e.length||delete this._eventHandlers[c]}}.bind(this),g=function(a){a.eventName?f(a,a.eventName):_.forEach(this._eventHandlers,function(b,c){f(a,c)})}.bind(this);for(d=0;d<e.length;d++)g(e[d]);return this},j=function(a,b){return b._eventOnceWrapper||(b._eventOnceWrapper=function(a){a.target.off(a.type,b._eventOnceWrapper),b.apply(this,arguments)}),this.on(a,b._eventOnceWrapper)},k=function(a){var b,c={type:a,target:this},d=this._eventHandlers&&this._eventHandlers[a];if(d){d=d.slice();var e=Array.prototype.slice.call(arguments,1);for(e.unshift(c),b=0;b<d.length;b++)try{d[b].handler.apply(null,e)}catch(f){}}};a.makeEventDispatcher=d,a.triggerWithArray=e,a.on_duringInit=f,a.markDeprecated=g,b.EventDispatcher=a}),define("toast/events/Commands",["exports","../core"],function(a,b){"use strict";a.TOC="toc",a.THUMBNAIL="thumbnail",a.TOGGLE_ZOOM="toggleZoom",a.SEARCH="search",a.TOGGLE_BOOKMARK="toggleBookmark",a.ADD_MEMO="addmemo",a.MY_LIBRARY="mylibrary",a.MY_STORAGE="mystorage",a.FIRST_PAGE="firstPage",a.PREVIOUS_PAGE="previousPage",a.NEXT_PAGE="nextPage",a.LAST_PAGE="lastPage",a.FULLSCREEN="fullscreen",a.TOGGLE_AUTO_SLIDE="toggleAutoSlide",a.START_AUTO_SLIDE="startAutoSlide",a.STOP_AUTO_SLIDE="stopAutoSlide",a.DOUBLE_PAGE="doublepage",a.TOGGLE_DOUBLEPAGE="toggleDoublePage",a.PRINT="print",a.SHOW_HELP="showhelp",a.CONFIG="config",a.TOGGLE_BGSOUND="toggleBgSound",a.PLAY_BGSOUND="playBgSound",a.PAUSE_BGSOUND="pauseBgSound",a.MOVE_PAGE="movePage",b.Commands=a}),define("toast/events/CommandManager",["exports","../core","./EventDispatcher"],function(a,b,c){"use strict";function d(a,b,c){this._name=a,this._id=b,this._commandFn=c,this._checked=void 0,this._enabled=!0}function e(b,c,e,f){if(k[c])return null;if(!b||!c||!e)return null;var g=new d(b,c,e);return f&&(g.userKeyBinding=!0),k[c]=g,a.trigger("commandRegistered",g),g}function f(b,c,e){if(k[b])return null;if(!b||!c)return null;var f=new d(null,b,c);return e&&(f.userKeyBinding=!0),k[b]=f,a.trigger("commandRegistered",f),f}function g(a){var b=k[a];b&&(delete k[a],k[a]=null)}function h(a){return k[a]}function i(){return Object.keys(k)}function j(b){var c=k[b];if(c){try{a.trigger("beforeExecuteCommand",b)}catch(d){}return c.execute.apply(c,Array.prototype.slice.call(arguments,1))}return(new $.Deferred).reject().promise()}var k={};c.makeEventDispatcher(d.prototype),d.prototype.getID=function(){return this._id},d.prototype.execute=function(){if(!this._enabled)return(new $.Deferred).reject().promise();var a=this._commandFn.apply(this,arguments);return a?a:(new $.Deferred).resolve().promise()},d.prototype.getEnabled=function(){return this._enabled},d.prototype.setEnabled=function(a){var b=this._enabled!==a;this._enabled=a,b&&this.trigger("enabledStateChange")},d.prototype.setChecked=function(a){var b=this._checked!==a;this._checked=a,b&&this.trigger("checkedStateChange")},d.prototype.getChecked=function(){return this._checked},d.prototype.setName=function(a){var b=this._name!==a;this._name=a,b&&this.trigger("nameChange")},d.prototype.getName=function(){return this._name},c.makeEventDispatcher(a),a.register=e,a.registerInternal=f,a.remove=g,a.execute=j,a.get=h,a.getAll=i,b.CommandManager=a}),define("toast/events",["./core","./events/KeyEvent","./events/Events","./events/EventDispatcher","./events/Commands","./events/CommandManager"],function(a,b){a.KeyEvent=b}),define("toast/core/book/BookZoom",["exports","../../core","./BookCommon","../../libs","../../events"],function(a,b,c){"use strict";function d(a){if(!ba&&!l()){if(a||(a={}),S=!0,oa={width:N.width(),height:N.height()},TT.$el.addClass("bookzoom-activate"),ba=!0,ja=!0,sa={},aa=X,i(),f(),a.pinch!==!0&&pa===!0){var c=b.LocalStorage.getItem(qa);_.isUndefined(c)||_.isNull(c)||(ca=c,ca=Math.max(ea,ca),ca=Math.min(da,ca))}else a.pinch===!0&&(ca=ea);if(ga={x:0,y:0},a.pinch!==!0){var d={x:0,y:0};if(a.tapPoint){a.tapPoint.x=(a.tapPoint.x-K.$getBook().offset().left)*ca,a.tapPoint.y=(a.tapPoint.y-K.$getBook().offset().top)*ca;var j=L.width()*ca,n=L.height()*ca,p=j/2,q=n/2;d.x=p-a.tapPoint.x,d.y=q-a.tapPoint.y,ga=d,t(),d=ga}o(ca,d),b.lazy(function(){e(),S=!1},200)}else h(),S=!1;K.$getBook().hide(),m(!0),b.Book.enableAction(!1),document.addEventListener("keyup",v),$(window).on("resize",w),N.height()!==oa.height&&g(),b.send(b.Events.ZOOM_MODE_DID_CHANGE,ba),b.send(b.Events.ZOOM_SCALE_DID_CHANGE,ca),b.on(b.Events.PAGE_DID_CHANGE,k)}}function e(){L.removeClass("animate");var a=parseFloat(L.css("marginLeft"))*ca,b=parseFloat(L.css("marginTop"))*ca;ha.left=ga.x+a,ha.top=ga.y+b,L.bookTransform(""),h()}function f(){ea=Math.min(oa.width/ra.fit.width,oa.height/ra.fit.height),b.isMobileDevice||(ea=.5*ea);var a,c;a=ra.page.width*(fa._default/100),c=ra.page.height*(fa._default/100),a+=a%2,a+=a/2%2*2,c+=c%2,b.Book.isDoublePage()&&!b.Book.isCoverPage()&&(a*=2),T=a,U=c,ca=Number(Math.max(a/b.Book.$getBook().width(),c/b.Book.$getBook().height()));var d=fa.max;_.isEmpty(sa.url)||(d=300);var e,f;e=ra.page.width*(d/100),f=ra.page.height*(d/100),e+=e%2,e+=e/2%2*2,f+=f%2,b.Book.isDoublePage()&&!b.Book.isCoverPage()&&(e*=2),V=e,W=f,da=Number(Math.max(e/b.Book.$getBook().width(),f/b.Book.$getBook().height()))}function g(){oa={width:N.width(),height:N.height()},ea=Math.min(oa.width/ra.fit.width,oa.height/ra.fit.height),b.isMobileDevice||(ea=.5*ea)}function h(a){a=_.extend({smooth:!1,fitPage:!0},a),a.smooth?L.addClass("animate"):L.removeClass("animate");var b=parseInt(ra.fit.width*ca),c=parseInt(ra.fit.height*ca);b+=b%2,b+=b/2%2*2,c+=c%2,Math.abs(T-b)<=5&&Math.abs(U-c)<=5?(b=T,c=U):Math.abs(V-b)<=5&&Math.abs(W-c)<=5&&(b=V,c=W),L.css({width:b+"px",height:c+"px",marginLeft:ha.left+"px",marginTop:ha.top+"px"}),a.fitPage&&_.each(Q,function(a){K.fitPage(a)})}function i(){L=$("<div />",{"class":"bookzoom"}),N.append(L),ra=b.Book.getBookSize(),Q=b.Book.getCurrentPageNumber(),_.each(Q,function(a){var c=TT.project.viewControllers[a-1],d=c.collection.attributes;if(sa=d._doc,ta.width<c.collection.background.width&&(ta.width=c.collection.background.width,ta.height=c.collection.background.height),b.isMobileDevice&&!_.isUndefined(d.config.mobile)&&!_.isEmpty(d.config.mobile.url))if("html"===sa.type)c.__asyncLoadHtmlPageDocument__();else{var e=_tt.StringUtils.replaceTemplate(d.background.url,"ASSETS_DIR",__app__.paths.assets);c.__asyncLoadBackgroundImage__(e)}}),!K.isCoverPage()&&K.$getBook().hasClass("doublepage")&&L.addClass("doublepage");var a=K.getCurrentPage();_.each(a,function(a){var b=$("<section />");b.attr("data-element-index",a.index()),"SECTION"!==a[0].tagName&&(a=a.find("section")),b.append(a.children()),L.append(b),ka.push(b)}),ha.left=-(ra.fit.width/2),ha.top=-(ra.fit.height/2),L.css({left:"50%",top:"50%",width:ra.fit.width+"px",height:ra.fit.height+"px",marginLeft:ha.left+"px",marginTop:ha.top+"px"}),L.tt_deselect(),P=$('<div class="bookzoom-overlay" />'),P.css({position:"absolute",left:0,top:0,width:"100%",height:"100%"}).appendTo(L)}function j(){b.isMobileDevice&&_.each(Q,function(a){var c=TT.project.viewControllers[a-1],d=c.collection.attributes;if(!_.isUndefined(d.config.mobile)&&!_.isEmpty(d.config.mobile.url))if("html"===c.collection._doc.type)c.__removeHtmlPageDocument__();else{var e=_tt.StringUtils.replaceTemplate(d.config.mobile.url,"MOBILE_PAGE_DIR",b.StringUtils.templateStrings.MOBILE_PAGE_DIR);c.__asyncLoadBackground__(e)}}),_.each(ka,function(a){var b=Number(a.attr("data-element-index")),c=K.$getBook().children().eq(b);"SECTION"===c[0].tagName?c.prepend(a.children()):c.find("section").prepend(a.children())}),K.$getBook().show(),_.each(Q,function(a){K.fitPage(a)}),L.remove(),ka=[]}function k(a){ba&&(a||(a={animate:!0}),S=!0,B(),pa===!0&&b.LocalStorage.setItem(qa,ca),$(".toast").removeClass("bookzoom-activate"),m(!1),N.tt_deselect(),$(window).off("resize",w),b.off(b.Events.PAGE_DID_CHANGE,k),document.removeEventListener("keyup",v),ba=!1,ja=!1,j(),A(),a.callback&&"function"==typeof a.callback&&a.callback(),P.remove(),b.Book.enableAction(!0),b.send(b.Events.ZOOM_MODE_DID_CHANGE,ba),b.lazy(function(){S=!1},50))}function l(){var a=!0,c=b.Book.getCurrentPageNumber();return _.any(c,function(b){var c=TT.project.viewControllers[b-1];c.isLoaded!==!0&&(a=!1)}),a!==!0?!0:!1}function m(a){b.isMobileDevice&&(N.unbind("touchstart",n),N.unbind("touchmove",n),a&&(N.bind("touchstart",n),N.bind("touchmove",n)))}function n(a){return a.preventDefault(),!1}function o(a,b){L.addClass("animate"),b||(b={x:0,y:0});var c=["translate("+b.x+"px, "+b.y+"px)","scale("+a+")"];c=c.join(" "),L[0].style.webkitTransform=c,L[0].style.mozTransform=c,L[0].style.msTransform=c,L[0].style.transform=c}function p(a){ba&&ja&&ba&&!la&&($(document).tt_deselect(),ia={x:parseFloat(L.css("marginLeft")),y:parseFloat(L.css("marginTop"))},P.addClass("grabbing"))}function q(a){ba&&ja&&ba&&!la&&(ha={left:ia.x+a.deltaX,top:ia.y+a.deltaY},aa==Y&&(ha.left=ia.x),h())}function r(a){ba&&ja&&ba&&!la&&(u(),h({smooth:!0}),P.removeClass("grabbing"))}function s(a){if(!l())if("pinchstart"==a.type)la=!0,ba||d({tapPoint:a.center,pinch:!0}),R=ca,na={x:ha.left,y:ha.top},ma={x:a.center.x-(N.offset().left+N.width()/2),y:a.center.y-(N.offset().top+N.height()/2)};else if("pinchend"==a.type)u()&&h({smooth:!0}),la=!1;else if("pinchmove"==a.type){var c=R*a.scale;if(c>=ea&&da>=c){ca=c;var e=ma.x*(c/R),f=ma.y*(c/R),g=a.center.x-$(window).width()/2,i=a.center.y-$(window).height()/2,j=na.x*(c/R),k=na.y*(c/R),m=j-e+g,n=k-f+i;ha.left=m,ha.top=n,h(),b.send(b.Events.ZOOM_SCALE_DID_CHANGE,ca)}}}function t(){var a={width:L.width()*ca,height:L.height()*ca},b=a.width/2>x().width/2?a.width/2-x().width/2:0;ga.x>b?ga.x=b:ga.x<0&&Math.abs(ga.x)>b&&(ga.x=-b);var c=a.height/2>x().height/2?a.height/2-x().height/2:0;c<ga.y?ga.y=c:Math.abs(ga.y)>c&&(ga.y=-c)}function u(){var a,b,c=!1,d={width:L.width(),height:L.height()},e=x();return d.width>e.width?(a=e.width/2,c=!0):(a=d.width/2,c=!0),d.height>e.height?(b=e.height/2,c=!0):(b=d.height/2,c=!0),Math.abs(ha.left)<a?(ha.left=-a,c=!0):d.width+ha.left<a&&(d.width<e.width?ha.left=-a:ha.left=e.width/2-d.width,c=!0),Math.abs(ha.top)<b?(ha.top=-b,c=!0):Math.abs(d.height+ha.top)<b&&(d.height<e.height?ha.top=-b:ha.top=e.height/2-d.height,c=!0),c}function v(a){a.keyCode===b.KeyEvent.DOM_VK_ESCAPE&&k()}function w(){k({animate:!1}),b.Book.layout()}function x(){return{width:window.innerWidth-(window.innerWidth-M.parent().width()),height:window.innerHeight-(window.innerHeight-M.parent().height())}}function y(){S!==!0&&(ba?k():d())}function z(a){S!==!0&&($(a.target).hasClass("gradient")||(ba?k():d({tapPoint:a.center})))}function A(){O.on("doubletap",z),O.on("pinchstart pinchmove pinchend",s),O.on("panstart",p),O.on("panmove",q),O.on("panend",r)}function B(){O.off("doubletap",z),O.off("pinchstart pinchmove pinchend",s),O.off("panstart",p),O.off("panmove",q),O.off("panend",r)}function C(a){K=b.Book,M=K.$getBook(),N=M.parent(),O=new TT.Hammer.Manager(N.get(0),{inputClass:b.isMobileDevice?TT.Hammer.TouchInput:TT.Hammer.MouseInput,cssProps:{userSelect:"inherit"}}),O.add(new TT.Hammer.Pan({threshold:0,pointers:0})),O.add(new TT.Hammer.Tap({event:"doubletap",taps:2,threshold:15,posThreshold:15})).recognizeWith([O.get("pan")]),O.add(new TT.Hammer.Pinch({threshold:0})).recognizeWith([O.get("pan")]),A(),ba=!1,ja=!0}function D(){return ba}function E(a){pa=a}function F(){return{min:ea,zoom:ca,max:da}}function G(a){var b={_default:150,max:200};a||(a={}),fa=_.extend(b,a)}function H(a){ja=a,1==ja?(P.show(),L.tt_deselect(),L.find(".toast-ctrl").css(c.vendor+"user-select","none"),O.on("pinchstart pinchmove pinchend",s),O.on("panstart",p),O.on("panmove",q),O.on("panend",r)):(P.hide(),L.find(".toast-ctrl").css(c.vendor+"user-select","text"),O.off("pinchstart pinchmove pinchend",s),O.off("panstart",p),O.off("panmove",q),O.off("panend",r)),m(ja)}function I(a){aa=a,aa==Y?ca=(x().width/ra.fit.width).toFixed(2):aa==Z&&(ca=(x().height/ra.fit.height).toFixed(2)),ea=Math.max(ea,ca),ha.left=-(ra.fit.width*ca)/2,ha.top=-(ra.fit.height*ca)/2,h(),b.send(b.Events.ZOOM_SCALE_DID_CHANGE,ca)}function J(a){var c=ra.fit.width*ca,d=ra.fit.height*ca,e=ra.fit.width*a,f=ra.fit.height*a;ca=a,h({fitPage:!1}),ha.left-=(e-c)/2,ha.top-=(f-d)/2,u(),L.css({marginLeft:ha.left+"px",marginTop:ha.top+"px"}),_.each(Q,function(a){K.fitPage(a)}),b.send(b.Events.ZOOM_SCALE_DID_CHANGE,ca)}var K,L,M,N,O,P,Q,R,S,T,U,V,W,X=0,Y=1,Z=2,aa=X,ba=!1,ca=1.5,da=2,ea=.5,fa={_default:150,max:200},ga={x:0,y:0},ha={left:0,top:0},ia={left:0,top:0},ja=!0,ka=[],la=!1,ma={},na={},oa={},pa=!1,qa="Toast.BookZoom.ZoomScale",ra={},sa={},ta={};b.CommandManager.registerInternal(b.Commands.TOGGLE_ZOOM,y),a._initialize=C,a.isActivate=D,a.activate=d,a.deactivate=k,a.getCurrentScales=F,a.setKeepZoomScale=E,a.setZoomPercents=G,a.setDragMode=H,a.setScaleMode=I,a.setZoomScale=J,a._on=A,a._off=B,b.BookZoom=a}),define("toast/extensions/defaults/Memo",["exports","toast/core/book/BookZoom"],function(a,b){"use strict";function c(){x=Toast.LocalStorage.getItem(y),_.isUndefined(x)||_.isEmpty(x)?x=[]:(x=JSON.parse(x),x=_.sortBy(x,"page"))}function d(a){var b=[];_.each(x,function(c){c.page===a&&b.push(c)});var c=0;_.each(b,function(a){var b=n().find('.toast-ctrl[data-index="'+(a.page-1)+'"]'),d=$('<div class="memo-icon" />');d.attr("id",a.id),d.css({position:"absolute",left:a.offset.left+"px",top:a.offset.top+"px",width:"60px",height:"60px",zIndex:999+c}),b.children(".contents").append(d),l(d),c++})}function e(a){var b=[];if(a){_.findWhere(x,{page:a});_.each(x,function(c){c.page===a&&b.push(c)})}else b=x;_.each(b,function(a){var b=n().find('.toast-ctrl[data-index="'+(a.page-1)+'"]'),c=b.find(".memo-icon");c.off("draginit drag dragstart dragend click dblclick"),c.remove()})}function f(a,b){var c=n().find('.toast-ctrl[data-index="'+(a-1)+'"]'),d={left:c.width()/2-30,top:c.height()/2-30},e={id:Toast.UUID8(),page:a,text:b,offset:d},f=$('<div class="memo-icon" />'),g=c.children(".memo-icon").length>0?Number(c.children(".memo-icon").last().css("zIndex"))+1:999;f.attr("id",e.id),f.css({position:"absolute",left:d.left,top:d.top,width:"60px",height:"60px",zIndex:g}),c.children(".contents").append(f),l(f),x.push(e),x=_.sortBy(x,"page"),Toast.LocalStorage.setItem(y,JSON.stringify(x)),TT.send(Toast.Events.MEMO_DID_CHANGE,x)}function g(a,b){var c=_.findWhere(x,{id:b});_.isUndefined(c)||(c.text=a,Toast.LocalStorage.setItem(y,JSON.stringify(x)))}function h(a){var b=_.findWhere(x,{id:a.attr("id")});_.isUndefined(b)||(b.offset={left:parseInt(a.css("left"),10),top:parseInt(a.css("top"),10)},Toast.LocalStorage.setItem(y,JSON.stringify(x)))}function i(a){var b=_.findWhere(x,{id:a});_.isUndefined(b)||(x.splice(x.indexOf(b),1),Toast.LocalStorage.setItem(y,JSON.stringify(x)),n().find("#"+a).remove(),TT.send(Toast.Events.MEMO_DID_CHANGE,x))}function j(){return x}function k(){e(),x=[],Toast.LocalStorage.setItem(y,JSON.stringify(x)),TT.send(Toast.Events.MEMO_DID_CHANGE,x)}function l(a){m(a),a.on("click",o),a.on("dblclick",p),a.drag("init",q),a.drag("start",r,{distance:1}),a.drag("drag",s),a.drag("end",t)}function m(a){a.off("draginit drag dragstart dragend click dblclick")}function n(){return b.isActivate()?$(".bookzoom"):$(".book")}function o(a){var b=$(a.currentTarget),c=_.findWhere(x,{id:b.attr("id")});_.isUndefined(c)||u(c.text,c.id)}function p(a){}function q(a,b){}function r(a,b){var c=$(b.drag);c.closest("section");b.__startLeft__=parseInt(c.css("left"),10),b.__startTop__=parseInt(c.css("top"),10),b.__bookScale__=n().tt_scale(),b.__pageScale__=c.parent().tt_scale()}function s(a,b){var c=$(b.drag),d={};d.left=b.__startLeft__+b.deltaX/b.__bookScale__/b.__pageScale__,d.top=b.__startTop__+b.deltaY/b.__bookScale__/b.__pageScale__,c.css(d)}function t(a,b){var c=$(b.drag);b.translate&&delete b.translate,h(c)}function u(a,b){var c=Toast.Book.getCurrentPageNumber(),d=1!=c.length?!0:!1;c=c[0];var e,h=$('<textarea class="form-control" placeholder="'+w.ENTER_TEXT+'"></textarea>');h.val(a);var j=[];0!=arguments.length&&j.push({cssClass:"btn-danger pull-left",icon:"glyphicon glyphicon-trash",label:w.DELETE,action:function(){i(b),e.close()}}),j.push({label:w.CANCEL,action:function(){e.close()}}),j.push({label:w.OK,cssClass:"btn-primary",action:function(){if(_.isUndefined(b))f(c,e.$modalBody.find("textarea").val());else{var a=e.$modalBody.find("textarea").val();g(a,b)}e.close()}}),e=BootstrapDialog.show({draggable:!0,title:_.isUndefined(a)?w.ADD_MEMO_TITILE:w.MODIFY_MEMO_TITILE,message:function(a){if(d&&_.isUndefined(b)){var e=$('<form class="form-horizontal"><div class="form-group"><label class="col-sm-3 control-label">'+w.SELECT_PAGE_TITLE+'</label><div class="col-sm-8"><div class="input-group"><span class="input-group-addon"><input id="left-page" type="radio" checked>'+w.LEFT_PAGE_TITLE+'</input></span><span class="input-group-addon"><input id="right-page" type="radio">'+w.RIGHT_PAGE_TITLE+"</input></span></div></div></div></div><hr>");return e.append(h),e.find("input").click(function(a){"left-page"==$(this).attr("id")?(c=Toast.Book.getCurrentPageNumber()[0],e.find("#right-page").removeAttr("checked")):(c=Toast.Book.getCurrentPageNumber()[1],e.find("#left-page").removeAttr("checked"))}),e}return h},buttons:j})}function v(){Toast.CommandManager.execute(Toast.Commands.STOP_AUTO_SLIDE),u()}var w=Toast.Strings,x=[],y=Toast.project.config.publishUniqueId+"-memos";Toast.Book;Toast.on(Toast.Events.BOOK_READY,function(){c()}),Toast.on(Toast.Events.PAGE_DID_LOAD,function(a){d(a)}),Toast.on(Toast.Events.PAGE_DID_UNLOAD,function(a){e(a)}),Toast.on(Toast.Events.ZOOM_MODE_DID_CHANGE,function(a){var b=Toast.Book.getCurrentPageNumber();e(b),d(b),Toast.Book.isDoublePage()&&Toast.Book.getTotalPageNumber()>=b+1&&(e(b+1),d(b+1))}),Toast.CommandManager.registerInternal(Toast.Commands.ADD_MEMO,v),a.getMemos=j,a.removeAll=k}),define("toast/extensions/defaults/Draw",["exports"],function(a){"use strict"}),define("toast/extensions/defaults/MyLibrary",["require","exports","module","./Bookmark","./Memo","./Draw"],function(a,b,c,d,e,f){"use strict";function g(){return p=$(Mustache.render(o)),q=p.find(".container"),TT.$el.append(p),i(),p.animate({left:0},250),TT.on(Toast.Events.BOOKMARK_DID_CHANGE,i),TT.on(Toast.Events.MEMO_DID_CHANGE,i),Toast.Book.enableAction(!1),p.children(".panel-heading").find(".close").on("click",j),p.children(".panel-heading").find(".trash").on("click",k),p}function h(){q.css("height",$(window).height()-q.offset().top+"px")}function i(){var a=_.clone(d.getBookmarks());_.each(a,function(a){var b,c=Toast.project.models[a.page-1].get("thumbnail");b=c.url?Toast.StringUtils.replaceTemplate(c.url):c.src,a.displayPageNumber=Toast.Book.toLogicalPageNumber(a.page),a.thumbUrl=b,a.thumbWidth=c.width,a.thumbHeight=c.height});var b=_.clone(e.getMemos());_.each(b,function(a){var b,c=Toast.project.models[a.page-1].get("thumbnail");b=c.url?Toast.StringUtils.replaceTemplate(c.url):c.src,a.displayPageNumber=Toast.Book.toLogicalPageNumber(a.page),a.thumbUrl=b,a.thumbWidth=c.width,a.thumbHeight=c.height});var c={bookmarks:a,memos:b},f=$(Mustache.render(o,c)),g=f.find("#mylibrary-bookmarks > .container").children();p.find("#mylibrary-bookmarks > .container").children().remove(),p.find("#mylibrary-bookmarks > .container").append(g),p.find("#mylibrary-bookmarks > .container > .row").on("click",l);var h=f.find("#mylibrary-memos > .container").children();p.find("#mylibrary-memos > .container").children().remove(),p.find("#mylibrary-memos > .container").append(h),p.find("#mylibrary-memos > .container > .row").on("click",m),_.isEmpty(a)&&_.isEmpty(b)?p.children(".panel-heading").find(".trash").tt_disable():p.children(".panel-heading").find(".trash").tt_enable()}function j(){p.animate({left:-500},250,function(){$(window).off("resize",h),p.remove(),p=null}),TT.off(Toast.Events.BOOKMARK_DID_CHANGE,i),TT.off(Toast.Events.MEMO_DID_CHANGE,i),Toast.Book.enableAction(!0)}function k(a){BootstrapDialog.show({type:BootstrapDialog.TYPE_DANGER,title:r.ALERT_TITLE,message:function(a){var b=$("<div />");b.text(r.REMOVE_ALL_MY_LIBRARY),b.append($("<hr>"));var c=$('<div class="btn-group pull-right" />'),f=$('<button class="btn btn-default" />');f.text(r.CANCEL),f.on("click",{dialogRef:a},function(a){a.data.dialogRef.close()}),c.append(f);var g=$('<button class="btn btn-danger">');return g.css("marginLeft","5px"),g.text(r.DELETE),g.prepend($('<span class="glyphicon glyphicon-trash"></span>')),g.on("click",{dialogRef:a},function(a){d.removeAll(),e.removeAll(),a.data.dialogRef.close()}),c.append(g),b.append(c),b}})}function l(a){var b=$(a.currentTarget).closest(".row");Toast.Book.move(b.attr("data-page"))}function m(a){var b=$(a.currentTarget).closest(".row");Toast.Book.move(b.attr("data-page"))}function n(){_.isUndefined(o)&&(o=Toast.ThemeLoader.getHTMLTemplates().MyLibrary),p||g()}var o,p,q,r=Toast.Strings;Toast.CommandManager.registerInternal(Toast.Commands.MY_LIBRARY,n)}),define("toast/extensions/defaults/AutoSlide",["exports"],function(a){"use strict";function b(a,b){this.requestAnimationFrameMethod=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame,this.diameter=50,this.thickness=2,this.playing=!1,this.progress=0,this.progressOffset=1,this.progressCheck=b,null!==a&&(this.canvas=a,this.canvas.width=this.diameter,this.canvas.height=this.diameter,this.context=this.canvas.getContext("2d"),this.thickness=Number(a.getAttribute("data-thickness")||2),this.backgroundColor=a.getAttribute("data-background-color")||"rgba( 255, 255, 255, 0.4 )",this.strokeColor=a.getAttribute("data-stroke-color")||"#ddd",this.fillStrokeColor=a.getAttribute("data-fill-stroke-color")||"#3f3f3f",this.canvas.style.display="block"),this.render()}function c(){f();var a=s,b=Toast.Book.getCurrentPage();_.each(b,function(a){var b=a.find("video, audio");b.length>0&&_.each(b,function(a){a.hasAttribute("data-autoplay")&&s&&1e3*a.duration>s&&(s=1e3*a.duration+1e3)})}),!s||r||!Toast.Book.availablePageNavigation().next&&t!==!0?Toast.Book.availablePageNavigation().next||(f(),h()):(p=setTimeout(Toast.Book.availablePageNavigation().next?Toast.Book.next:Toast.Book.moveToFirst,s),q=Date.now()),o&&o.setPlaying(-1!==p),s=a}function d(){s&&!r&&(r=!0,Toast.send(Toast.Events.AUTOSLIDE_DID_PAUSE),clearTimeout(p),o&&o.setPlaying(!1))}function e(){s&&r&&(r=!1,Toast.send(Toast.Events.AUTOSLIDE_DID_RESUME),c())}function f(){clearTimeout(p),p=-1}function g(){return p>0}function h(){o&&(o.destroy(),o=null)}function i(){Toast.Book.getTotalPageNumber()<1||(g()?k():j())}function j(){Toast.Book.getTotalPageNumber()<1||g()||((!Toast._msieVersion||Toast._msieVersion&&Toast._msieVersion>9)&&(h(),o=new b(document.querySelector(".toast").querySelector("canvas"),function(){return Math.min(Math.max((Date.now()-q)/s,0),1)}),o.on("click",l)),r=!1,c())}function k(){Toast.Book.getTotalPageNumber()<1||g()&&(f(),h())}function l(a){Toast.Book.isLastPage()&&t===!1?(Toast.Book.moveToFirst(),e()):r?e():d()}function m(a){g()?a.find('[command="toggleAutoSlide"]').children("a").html('<span class="glyphicon glyphicon-stop" />'+n.STOP_SLIDESHOW):a.find('[command="toggleAutoSlide"]').children("a").html('<span class="glyphicon glyphicon-play" />'+n.START_SLIDESHOW)}var n=Toast.Strings;b.prototype.setPlaying=function(a){var b=this.playing;this.playing=a,!b&&this.playing?this.animate():this.render()},b.prototype.animate=function(){var a=this.progress;this.progress=this.progressCheck(),a>.8&&this.progress<.2&&(this.progressOffset=this.progress),this.render(),this.playing&&this.requestAnimationFrameMethod.call(window,this.animate.bind(this))},b.prototype.render=function(){if(this.context){var a=this.playing?this.progress:0,b=this.diameter/2-this.thickness,c=this.diameter/2,d=this.diameter/2,e=14;this.progressOffset+=.1*(1-this.progressOffset);var f=-Math.PI/2+a*(2*Math.PI),g=-Math.PI/2+this.progressOffset*(2*Math.PI);this.context.save(),this.context.clearRect(0,0,this.diameter,this.diameter),this.context.beginPath(),this.context.arc(c,d,b+2,0,2*Math.PI,!1),this.context.fillStyle=this.backgroundColor,this.context.fill(),this.context.beginPath(),this.context.arc(c,d,b,0,2*Math.PI,!1),this.context.lineWidth=this.thickness,this.context.strokeStyle=this.strokeColor,this.context.stroke(),this.playing&&(this.context.beginPath(),this.context.arc(c,d,b,g,f,!1),this.context.lineWidth=this.thickness+2,this.context.strokeStyle=this.fillStrokeColor,this.context.stroke()),this.context.translate(c-e/2,d-e/2),this.playing?(this.context.fillStyle="#3f3f3f",this.context.fillRect(0,0,e/2-2,e),this.context.fillRect(e/2+2,0,e/2-2,e)):(this.context.beginPath(),this.context.translate(2,0),this.context.moveTo(0,0),this.context.lineTo(e-2,e/2),this.context.lineTo(0,e),this.context.fillStyle="#3f3f3f",this.context.fill()),this.context.restore()}},b.prototype.on=function(a,b){this.canvas&&this.canvas.addEventListener(a,b,!1)},b.prototype.off=function(a,b){this.canvas&&this.canvas.removeEventListener(a,b,!1)},b.prototype.destroy=function(){this.playing=!1,this.canvas&&(this.canvas.style.display="none");
};var o=null,p=0,q=-1,r=!1,s=3e3,t=!0;Toast.on(Toast.Events.PAGE_DID_CHANGE,function(a,b){g()&&c()}),Toast.on(Toast.Events.THEME_DID_UNLOAD,function(){g()&&k()}),Toast.on(Toast.Events.ZOOM_MODE_DID_CHANGE,function(a){g()&&k()}),Toast.appReady(function(){Toast.on(Toast.Events.BEFORE_SHOW_DROPDOWN_MENU,m)}),Toast.CommandManager.registerInternal(Toast.Commands.TOGGLE_AUTO_SLIDE,i),Toast.CommandManager.registerInternal(Toast.Commands.START_AUTO_SLIDE,j),Toast.CommandManager.registerInternal(Toast.Commands.STOP_AUTO_SLIDE,k),a.isAutoSliding=g}),define("toast/extensions/defaults/Print",["require","exports"],function(a,b){"use strict";function c(){var a=p.find("#print-document-container");q=$("<iframe />",{id:"print-document",frameBorder:0}),q.attr("src","toast/html-templates/print-document-template.html"),a.append(q),q.on("load",d)}function d(){f(),g(),j();var a=p.find("#orientation-menu");a.children("li").on("click",e)}function e(a){var b=$(a.currentTarget),c=b.attr("data-orientation"),d=p.find("#orientation-menu");d.attr("data-orientation",c),d.children("li").find("a > span").removeClass("fa fa-check-square-o"),b.find("a > span").addClass("fa fa-check-square-o");var e=p.find(".btn-orientation");e.html(b.children("a").text()+' <span class="caret">'),p.find("#print-document-container .preloader").show(),j()}function f(){var a=q.contents().find("head");window.location.origin||(window.location.origin=location.protocol+"//"+location.host);var b=window.location.pathname,c=b.substring(0,b.lastIndexOf("/")),d=window.location.origin+c+"/",e=$("<base />",{href:d});a.append(e);var f={type:"text/css",rel:"stylesheet",href:Toast.debug===!0?"styles/toast.css":"styles/toast.min.css"},g=$("<link/>").attr(f);a.append(g),_.each(Toast.project.config.userStylesheets,function(b){_.isEmpty(a.children("#"+b.id))&&(f={id:b.id,type:"text/css",rel:"stylesheet",href:Toast.paths.assets+b.src},g=$('<link class="userStylesheet" />').attr(f),g.appendTo(a))})}function g(){var a="portrait",b=Toast.Book.getCurrentPageNumber()[0],c=TT.project.viewControllers[b-1];c.collection.width>c.collection.height&&(a="landscape");var d=p.find("#orientation-menu"),e=d.find('li[data-orientation="'+a+'"]');d.attr("data-orientation",a),d.children("li").find("a > span").removeClass("fa fa-check-square-o"),e.find("a > span").addClass("fa fa-check-square-o");var f=p.find(".btn-orientation");f.html(e.children("a").text()+' <span class="caret">')}function h(){var a=new $.Deferred,b=p.find("#orientation-menu"),c=b.attr("data-orientation"),d=q.contents().find("head"),e=d.find("#page-orientation");return 0===e.length&&(e=$("<style />",{id:"page-orientation"}),d.append(e)),"landscape"===c?e.html("@page { size: landscape; }"):e.html("@page { size: portrait; }"),Toast.lazy(function(){a.resolve(c)},5),a.promise()}function i(){var a=new $.Deferred;return h().then(function(b){var c=q.contents().find("body"),d=$("<page />");c.attr("data-orientation",b),c.addClass(b),c.append(d);var e={width:d.width(),height:d.height()};d.remove(),a.resolve(e)}),a.promise()}function j(){i().then(function(a){var b=q.contents().find("body");b.addClass("preview"),b.children("page").remove();var c=Toast.Book.getCurrentPageNumber(),d="";_.each(c,function(e,f){d+=f+1==c.length?"<b>"+Toast.Book.toLogicalPageNumber(e)+"</b>":"<b>"+Toast.Book.toLogicalPageNumber(e)+", </b>";var g=TT.project.viewControllers[e-1],h=g.collection.attributes,i=$("<page />",{"data-page-no":e});b.append(i);var j=$("<section />"),l=g.$el.clone();if(j.css("width",a.width+"px"),j.css("height",a.height+"px"),j.append(l),!_.isEmpty(h._doc.url)&&"svg"===h._doc.type){l.children(".svg-background").remove();var m=_tt.StringUtils.replaceTemplate(h._doc.url,"ASSETS_DIR",__app__.paths.assets),n=$("<img />",{src:m,width:"100%",height:"100%"});n.css({position:"absolute",width:"100%",height:"100%"}),l.prepend(n)}var o=l.css("backgroundImage");if(!_.isEmpty(h.background.url)&&!_.isEmpty(o)&&"none"!=o){var p=_tt.StringUtils.replaceTemplate(h.background.url,"ASSETS_DIR",__app__.paths.assets),n=$("<img />",{src:p,width:"100%",height:"100%"});n.css({position:"absolute",width:"100%",height:"100%"}),l.css("backgroundImage",""),l.css("backgroundSize",""),l.css("backgroundRepeat",""),l.css("backgroundPosition",""),l.prepend(n)}k(l,{width:g.collection.width,height:g.collection.height}),i.append(j)}),p.find("header .current-page").html(d),p.find("#print-document-container .preloader").hide()})}function k(a,b){var c=Math.min(a.parent().width()/b.width,a.parent().height()/b.height),d=Math.round(b.width*c),e=Math.round(b.height*c);a.css({left:(a.parent().width()-d)/2+"px",top:(a.parent().height()-e)/2+"px",width:d+"px",height:e+"px"});var f=a.children(".contents");if(f.css({width:b.width+"px",height:b.height+"px"}),c=Math.max(d/b.width,e/b.height),1!==c){var g=(d-b.width)/2/c,h=(e-b.height)/2/c;f.tt_transform("scale("+c+") translate("+g+"px, "+h+"px)")}return c}function l(){p.hide(),Toast.SpinDialog.show(Toast.Strings.PREPARE_PRINTING).always(function(){var a=q.contents().find("body");a.removeClass("preview"),q[0].contentWindow.document.execCommand("print",!1,null),Toast.lazy(function(){Toast.SpinDialog.hide().always(function(){m()})},100)})}function m(){p.remove(),p=null,Toast.Book.enableAction(!0)}function n(){_.isUndefined(o)&&(o=Toast.ThemeLoader.getHTMLTemplates().PrintModal),p=$(Mustache.render(o)),$(document.body).append(p),p.on("mousemove",function(a){a.stopPropagation()}),p.find(".btn-print").on("click",l),p.find(".btn-cancel").on("click",m),c(),Toast.Book.enableAction(!1)}var o,p,q;Toast.Strings,TT.Dialog;Toast.CommandManager.registerInternal(Toast.Commands.PRINT,n)}),define("toast/extensions/defaults/ZoomBar",["exports"],function(a){"use strict";function b(){n=Toast.ThemeLoader.getHTMLTemplates().Zoombar,o=$(n).clone(),$(document.body).append(o),o.find("[data-drag-mode]").on("click",e),o.find("[data-scale-mode]").on("click",f),o.find("[zoom-bar-plus]").on("click",k,this),o.find("[zoom-bar-minus]").on("click",l,this),o.find("[zoom-bar-fullscreen]").on("click",j),g()&&o.find("[zoom-bar-fullscreen]").addClass("active");var a=Toast.BookZoom.getCurrentScales(),b=1-(a.zoom-a.min)/(a.max-a.min);p=new Dragdealer("zoom-slider",{horizontal:!1,vertical:!0,y:b,dragStartCallback:function(a,b){},dragStopCallback:function(a,b){},animationCallback:function(a,b){d(a,b)}}),t=!0}function c(){o.remove(),o=null,t=!1}function d(a,b){if(t){r!==q&&(r=q,o.find("[data-scale-mode]").removeClass("active"));var c=Toast.BookZoom.getCurrentScales(),d=c.max-c.min,e=Number(c.max+c.min-(b*d+c.min));Toast.BookZoom.setZoomScale(e)}}function e(a){s=!s,s?$(a.currentTarget).addClass("active"):$(a.currentTarget).removeClass("active"),Toast.BookZoom.setDragMode(s)}function f(a){o.find("[data-scale-mode]").not($(a.currentTarget)).removeClass("active"),$(a.currentTarget).hasClass("active")?($(a.currentTarget).removeClass("active"),r=q):($(a.currentTarget).addClass("active"),r=$(a.currentTarget).attr("data-scale-mode")),Toast.BookZoom.setScaleMode(r)}function g(){return document.fullScreenElement&&null!==document.fullScreenElement||document.mozFullScreen||document.webkitIsFullScreen}function h(a){a.requestFullscreen?a.requestFullscreen():a.msRequestFullscreen?a.msRequestFullscreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.webkitRequestFullscreen&&a.webkitRequestFullscreen()}function i(){document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen()}function j(a){g()?($(a.currentTarget).removeClass("active"),i()):($(a.currentTarget).addClass("active"),h(document.documentElement))}function k(){r!==q&&(r=q,o.find("[data-scale-mode]").removeClass("active"));var a=Toast.BookZoom.getCurrentScales(),b=Math.min(a.max,Number(parseFloat(a.zoom+a.max/10).toFixed(2)));a.zoom!==b&&Toast.BookZoom.setZoomScale(b)}function l(){r!==q&&(r=q,o.find("[data-scale-mode]").removeClass("active"));var a=Toast.BookZoom.getCurrentScales(),b=Math.max(a.min,Number(parseFloat(a.zoom-a.max/10).toFixed(2)));a.zoom!==b&&Toast.BookZoom.setZoomScale(b)}function m(){var a=o.find(".vertical-bar"),b=o.find(".handle-drag"),c=Toast.BookZoom.getCurrentScales(),d=parseFloat(c.zoom/c.max*100),e=parseFloat(100-c.min/c.max*100),f=parseFloat(c.min/c.max*100);d=parseFloat((d-f)/e);var g=a.height()-b.height()/2,h=g-g*d;b.css("transform","translateY("+h+"px)")}var n,o,p,q=0,r=q,s=!0,t=!1;Toast.on(Toast.Events.ZOOM_MODE_DID_CHANGE,function(a){a?b():c()}),Toast.on(Toast.Events.ZOOM_SCALE_DID_CHANGE,function(a){m()})}),define("toast/extensions",["./extensions/defaults/Thumbnail","./extensions/defaults/TOC","./extensions/defaults/Bookmark","./extensions/defaults/Search","./extensions/defaults/Memo","./extensions/defaults/Draw","./extensions/defaults/MyLibrary","./extensions/defaults/AutoSlide","./extensions/defaults/Print","./extensions/defaults/ZoomBar"],function(){});